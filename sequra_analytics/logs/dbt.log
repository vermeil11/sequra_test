[0m17:13:59.867014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074154f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074152b0>]}


============================== 17:13:59.870682 | e218b52a-bec3-40db-a284-8e69b66ce787 ==============================
[0m17:13:59.870682 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:13:59.871042 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics/logs', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'use_colors': 'True', 'debug': 'False', 'printer_width': '80', 'version_check': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics', 'invocation_command': 'dbt deps', 'introspect': 'True'}
[0m17:13:59.959424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e218b52a-bec3-40db-a284-8e69b66ce787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ff4a0>]}
[0m17:13:59.987940 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:13:59.988453 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:13:59.990171 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1776645, "process_in_blocks": "0", "process_kernel_time": 0.166591, "process_mem_max_rss": "108691456", "process_out_blocks": "0", "process_user_time": 0.806054}
[0m17:13:59.990460 [debug] [MainThread]: Command `dbt deps` succeeded at 17:13:59.990404 after 0.18 seconds
[0m17:13:59.990658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107684f80>]}
[0m17:13:59.990837 [debug] [MainThread]: Flushing usage events
[0m17:14:00.423865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:46.611232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5c1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b019550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b019220>]}


============================== 17:15:46.615062 | a067753a-6d21-4e11-b3cd-2a0d1bad81db ==============================
[0m17:15:46.615062 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:15:46.615443 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics/logs', 'version_check': 'True', 'static_parser': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'no_print': 'None', 'partial_parse': 'True', 'profiles_dir': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None'}
[0m17:15:46.705923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a067753a-6d21-4e11-b3cd-2a0d1bad81db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a426b40>]}
[0m17:15:46.728569 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:15:46.729375 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:15:46.731111 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.17697875, "process_in_blocks": "0", "process_kernel_time": 0.162391, "process_mem_max_rss": "107462656", "process_out_blocks": "0", "process_user_time": 0.79135}
[0m17:15:46.731468 [debug] [MainThread]: Command `dbt deps` succeeded at 17:15:46.731381 after 0.18 seconds
[0m17:15:46.731703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afa2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0194f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0194c0>]}
[0m17:15:46.731901 [debug] [MainThread]: Flushing usage events
[0m17:15:47.172688 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:51.396021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107149520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b154f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b151f0>]}


============================== 17:15:51.399371 | caf94bb0-86df-4e7b-94a3-a57251350858 ==============================
[0m17:15:51.399371 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:15:51.399745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt debug', 'introspect': 'True', 'fail_fast': 'False', 'empty': 'None', 'version_check': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'warn_error': 'None', 'no_print': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics/logs', 'target_path': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics', 'use_colors': 'True'}
[0m17:15:51.418105 [info ] [MainThread]: dbt version: 1.10.9
[0m17:15:51.418495 [info ] [MainThread]: python version: 3.12.7
[0m17:15:51.418688 [info ] [MainThread]: python path: /Users/maximerosa/Downloads/sequra_test/env/bin/python
[0m17:15:51.418835 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m17:15:51.765371 [info ] [MainThread]: Using profiles dir at /Users/maximerosa/Downloads/sequra_test/sequra_analytics
[0m17:15:51.765660 [info ] [MainThread]: Using profiles.yml file at /Users/maximerosa/Downloads/sequra_test/sequra_analytics/profiles.yml
[0m17:15:51.765809 [info ] [MainThread]: Using dbt_project.yml file at /Users/maximerosa/Downloads/sequra_test/sequra_analytics/dbt_project.yml
[0m17:15:51.766594 [info ] [MainThread]: adapter type: snowflake
[0m17:15:51.766781 [info ] [MainThread]: adapter version: 1.10.0
[0m17:15:51.818866 [info ] [MainThread]: Configuration:
[0m17:15:51.819148 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:15:51.819293 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:15:51.819427 [info ] [MainThread]: Required dependencies:
[0m17:15:51.820197 [debug] [MainThread]: Executing "git --help"
[0m17:15:51.837233 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:15:51.837844 [debug] [MainThread]: STDERR: "b''"
[0m17:15:51.838131 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:15:51.838363 [info ] [MainThread]: Connection:
[0m17:15:51.838548 [info ] [MainThread]:   account: lqgtqud-rv87386
[0m17:15:51.838678 [info ] [MainThread]:   user: maximerosa
[0m17:15:51.838799 [info ] [MainThread]:   database: SEQURA_DEV
[0m17:15:51.838914 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m17:15:51.839026 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m17:15:51.839147 [info ] [MainThread]:   schema: dbt_maximerosa
[0m17:15:51.839263 [info ] [MainThread]:   authenticator: None
[0m17:15:51.839374 [info ] [MainThread]:   oauth_client_id: None
[0m17:15:51.839482 [info ] [MainThread]:   query_tag: None
[0m17:15:51.839592 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:15:51.839703 [info ] [MainThread]:   host: None
[0m17:15:51.839882 [info ] [MainThread]:   port: None
[0m17:15:51.840018 [info ] [MainThread]:   proxy_host: None
[0m17:15:51.840145 [info ] [MainThread]:   proxy_port: None
[0m17:15:51.840259 [info ] [MainThread]:   protocol: None
[0m17:15:51.840374 [info ] [MainThread]:   connect_retries: 1
[0m17:15:51.840484 [info ] [MainThread]:   connect_timeout: None
[0m17:15:51.840590 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:15:51.840720 [info ] [MainThread]:   retry_all: False
[0m17:15:51.840950 [info ] [MainThread]:   insecure_mode: False
[0m17:15:51.841093 [info ] [MainThread]:   reuse_connections: True
[0m17:15:51.841218 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m17:15:51.841610 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:15:51.955640 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:15:52.046663 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:15:52.046942 [debug] [MainThread]: On debug: select 1 as id
[0m17:15:52.047098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:54.938906 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.892 seconds
[0m17:15:54.941371 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:15:54.941618 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:15:54.943308 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.6063762, "process_in_blocks": "0", "process_kernel_time": 0.267279, "process_mem_max_rss": "155172864", "process_out_blocks": "0", "process_user_time": 1.167876}
[0m17:15:54.943559 [debug] [MainThread]: Command `dbt debug` succeeded at 17:15:54.943508 after 3.61 seconds
[0m17:15:54.943726 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:15:54.943895 [debug] [MainThread]: On debug: Close
[0m17:15:55.069616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110496360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11035e2a0>]}
[0m17:15:55.069954 [debug] [MainThread]: Flushing usage events
[0m17:15:55.425241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:07.322028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133d3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11380d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11380d580>]}


============================== 17:16:07.329561 | a2d88670-cd5a-47bb-93e3-2951fe636ff1 ==============================
[0m17:16:07.329561 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:16:07.329903 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'log_format': 'default', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'debug': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'printer_width': '80', 'static_parser': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics', 'no_print': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'log_path': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics/logs'}
[0m17:16:07.803918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2d88670-cd5a-47bb-93e3-2951fe636ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106613f20>]}
[0m17:16:07.836381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2d88670-cd5a-47bb-93e3-2951fe636ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11470d070>]}
[0m17:16:07.841667 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:16:07.917416 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:16:07.965844 [debug] [MainThread]: Failed to load parsed file from disk at /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/partial_parse.msgpack: Field "flat_graph" of type Dict[str, Any] in Manifest has invalid value None
[0m17:16:07.966462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a2d88670-cd5a-47bb-93e3-2951fe636ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f7cb30>]}
[0m17:16:08.768867 [error] [MainThread]: Encountered an error:
Compilation Error
  Analysis 'analysis.sequra_analytics.sequra_test' (analyses/sequra_test.sql) depends on a node named 'orders_merchant_STG' which was not found
[0m17:16:08.771375 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.499626, "process_in_blocks": "0", "process_kernel_time": 0.239026, "process_mem_max_rss": "143114240", "process_out_blocks": "0", "process_user_time": 1.720424}
[0m17:16:08.771787 [debug] [MainThread]: Command `dbt seed` failed at 17:16:08.771732 after 1.50 seconds
[0m17:16:08.771991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11352c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147f21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11380fc80>]}
[0m17:16:08.772180 [debug] [MainThread]: Flushing usage events
[0m17:16:09.133774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:17:07.476316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e26750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0d580>]}


============================== 17:17:07.479751 | d847c181-a0aa-4d10-ab0d-e7cb14188173 ==============================
[0m17:17:07.479751 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:17:07.480107 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics', 'target_path': 'None', 'use_colors': 'True', 'log_path': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics/logs', 'debug': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None'}
[0m17:17:07.917466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd847c181-a0aa-4d10-ab0d-e7cb14188173', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d01f70>]}
[0m17:17:07.948945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd847c181-a0aa-4d10-ab0d-e7cb14188173', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110236bd0>]}
[0m17:17:07.950146 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:17:08.030727 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:17:08.078374 [debug] [MainThread]: Failed to load parsed file from disk at /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/partial_parse.msgpack: Field "flat_graph" of type Dict[str, Any] in Manifest has invalid value None
[0m17:17:08.079162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd847c181-a0aa-4d10-ab0d-e7cb14188173', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11090c2c0>]}
[0m17:17:08.859585 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.sequra_analytics.orders_merchant.column_types
[0m17:17:08.862679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd847c181-a0aa-4d10-ab0d-e7cb14188173', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110affb60>]}
[0m17:17:08.908066 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/manifest.json
[0m17:17:08.910113 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/semantic_manifest.json
[0m17:17:08.931825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd847c181-a0aa-4d10-ab0d-e7cb14188173', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d1a570>]}
[0m17:17:08.932152 [info ] [MainThread]: Found 7 models, 2 seeds, 11 data tests, 479 macros
[0m17:17:08.932327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd847c181-a0aa-4d10-ab0d-e7cb14188173', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116b84d0>]}
[0m17:17:08.933402 [info ] [MainThread]: 
[0m17:17:08.933610 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:17:08.933755 [info ] [MainThread]: 
[0m17:17:08.934000 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:17:08.936261 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m17:17:09.059949 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m17:17:09.060204 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m17:17:09.060345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:11.682735 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.622 seconds
[0m17:17:11.683878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now create_SEQURA_DEV_dbt_maximerosa_raw_data)
[0m17:17:11.684126 [debug] [ThreadPool]: Creating schema "database: "SEQURA_DEV"
schema: "dbt_maximerosa_raw_data"
"
[0m17:17:11.686861 [debug] [ThreadPool]: Using snowflake connection "create_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m17:17:11.687056 [debug] [ThreadPool]: On create_SEQURA_DEV_dbt_maximerosa_raw_data: create schema if not exists SEQURA_DEV.dbt_maximerosa_raw_data
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "create_SEQURA_DEV_dbt_maximerosa_raw_data"} */
[0m17:17:11.795706 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.108 seconds
[0m17:17:11.799032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_SEQURA_DEV_dbt_maximerosa_raw_data, now list_SEQURA_DEV_dbt_maximerosa_marts)
[0m17:17:11.799377 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_raw_data'
[0m17:17:11.805943 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate'
[0m17:17:11.806332 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m17:17:11.806586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_staging'
[0m17:17:11.807708 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m17:17:11.808754 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m17:17:11.808914 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m17:17:11.809894 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m17:17:11.810042 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m17:17:11.810252 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m17:17:11.810739 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m17:17:11.811889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:11.812047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:11.812219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:11.915387 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be7f95-0001-66a6-0000-000167de373d
[0m17:17:11.915650 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:17:11.915851 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:17:11.915979 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:17:14.184710 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.373 seconds
[0m17:17:14.188467 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be7f95-0001-66a6-0000-000167de3745
[0m17:17:14.188714 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:17:14.188990 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:17:14.189135 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:17:14.189924 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be7f95-0001-66a6-0000-000167de3749
[0m17:17:14.190113 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:17:14.190298 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:17:14.190431 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:17:14.190779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd847c181-a0aa-4d10-ab0d-e7cb14188173', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f7f20>]}
[0m17:17:14.197861 [debug] [Thread-1 (]: Began running node seed.sequra_analytics.merchants
[0m17:17:14.198126 [debug] [Thread-2 (]: Began running node seed.sequra_analytics.orders_merchant
[0m17:17:14.198432 [info ] [Thread-1 (]: 1 of 2 START seed file dbt_maximerosa_raw_data.merchants ....................... [RUN]
[0m17:17:14.198694 [info ] [Thread-2 (]: 2 of 2 START seed file dbt_maximerosa_raw_data.orders_merchant ................. [RUN]
[0m17:17:14.198959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now seed.sequra_analytics.merchants)
[0m17:17:14.199148 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_raw_data, now seed.sequra_analytics.orders_merchant)
[0m17:17:14.199341 [debug] [Thread-1 (]: Began compiling node seed.sequra_analytics.merchants
[0m17:17:14.199543 [debug] [Thread-2 (]: Began compiling node seed.sequra_analytics.orders_merchant
[0m17:17:14.199720 [debug] [Thread-1 (]: Began executing node seed.sequra_analytics.merchants
[0m17:17:14.199890 [debug] [Thread-2 (]: Began executing node seed.sequra_analytics.orders_merchant
[0m17:17:14.229142 [debug] [Thread-1 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m17:17:14.229570 [debug] [Thread-1 (]: On seed.sequra_analytics.merchants: create table SEQURA_DEV.dbt_maximerosa_raw_data.merchants (merchant_id integer,merchant_name text)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m17:17:14.230117 [debug] [Thread-2 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m17:17:14.230358 [debug] [Thread-2 (]: On seed.sequra_analytics.orders_merchant: create table SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant (order_id
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */;
[0m17:17:14.325998 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01be7f95-0001-66a6-0000-000167de3751
[0m17:17:14.326261 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 2 at position 155 unexpected ';'.
[0m17:17:14.332525 [debug] [Thread-2 (]: Database Error in seed orders_merchant (seeds/orders_merchant.csv)
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 155 unexpected ';'.
[0m17:17:14.333769 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd847c181-a0aa-4d10-ab0d-e7cb14188173', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11173e600>]}
[0m17:17:14.334090 [error] [Thread-2 (]: 2 of 2 ERROR loading seed file dbt_maximerosa_raw_data.orders_merchant ......... [[31mERROR[0m in 0.13s]
[0m17:17:14.334382 [debug] [Thread-2 (]: Finished running node seed.sequra_analytics.orders_merchant
[0m17:17:14.334659 [debug] [Thread-7 (]: Marking all children of 'seed.sequra_analytics.orders_merchant' to be skipped because of status 'error'.  Reason: Database Error in seed orders_merchant (seeds/orders_merchant.csv)
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 155 unexpected ';'..
[0m17:17:14.443624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.213 seconds
[0m17:17:14.452809 [debug] [Thread-1 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m17:17:14.453075 [debug] [Thread-1 (]: On seed.sequra_analytics.merchants: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m17:17:14.541820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m17:17:14.542226 [debug] [Thread-1 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m17:17:14.542387 [debug] [Thread-1 (]: On seed.sequra_analytics.merchants: insert into SEQURA_DEV.dbt_maximerosa_raw_data.merchants (merchant_id, merchant_name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */...
[0m17:17:15.317352 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.775 seconds
[0m17:17:15.318442 [debug] [Thread-1 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m17:17:15.319047 [debug] [Thread-1 (]: On seed.sequra_analytics.merchants: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m17:17:15.545384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m17:17:15.551115 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sequra_analytics.merchants"
[0m17:17:15.564857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd847c181-a0aa-4d10-ab0d-e7cb14188173', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dde3c0>]}
[0m17:17:15.565191 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file dbt_maximerosa_raw_data.merchants ................... [[32mINSERT 7[0m in 1.37s]
[0m17:17:15.565471 [debug] [Thread-1 (]: Finished running node seed.sequra_analytics.merchants
[0m17:17:15.566231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:15.566402 [debug] [MainThread]: Connection 'seed.sequra_analytics.merchants' was left open.
[0m17:17:15.566548 [debug] [MainThread]: On seed.sequra_analytics.merchants: Close
[0m17:17:15.663781 [debug] [MainThread]: Connection 'seed.sequra_analytics.orders_merchant' was left open.
[0m17:17:15.664038 [debug] [MainThread]: On seed.sequra_analytics.orders_merchant: Close
[0m17:17:15.746471 [debug] [MainThread]: Connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate' was left open.
[0m17:17:15.746731 [debug] [MainThread]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m17:17:15.842156 [debug] [MainThread]: Connection 'list_SEQURA_DEV_dbt_maximerosa_staging' was left open.
[0m17:17:15.842352 [debug] [MainThread]: On list_SEQURA_DEV_dbt_maximerosa_staging: Close
[0m17:17:15.936349 [info ] [MainThread]: 
[0m17:17:15.936579 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m17:17:15.936985 [debug] [MainThread]: Command end result
[0m17:17:15.950855 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/manifest.json
[0m17:17:15.952533 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/semantic_manifest.json
[0m17:17:15.955638 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/run_results.json
[0m17:17:15.955825 [info ] [MainThread]: 
[0m17:17:15.956020 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:17:15.956173 [info ] [MainThread]: 
[0m17:17:15.956359 [error] [MainThread]: [31mFailure in seed orders_merchant (seeds/orders_merchant.csv)[0m
[0m17:17:15.956528 [error] [MainThread]:   Database Error in seed orders_merchant (seeds/orders_merchant.csv)
  001003 (42000): SQL compilation error:
  syntax error line 2 at position 155 unexpected ';'.
[0m17:17:15.956655 [info ] [MainThread]: 
[0m17:17:15.956855 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m17:17:15.959708 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 8.538124, "process_in_blocks": "0", "process_kernel_time": 0.357956, "process_mem_max_rss": "172883968", "process_out_blocks": "0", "process_user_time": 2.18201}
[0m17:17:15.959960 [debug] [MainThread]: Command `dbt seed` failed at 17:17:15.959916 after 8.54 seconds
[0m17:17:15.960144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e26750>]}
[0m17:17:15.960346 [debug] [MainThread]: Flushing usage events
[0m17:17:16.350099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:19:38.414196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c90b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109711820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097114f0>]}


============================== 17:19:38.417701 | c2a016a5-f20d-461e-883a-99d85e9f975d ==============================
[0m17:19:38.417701 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:19:38.418075 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics/logs', 'printer_width': '80', 'use_colors': 'True', 'target_path': 'None', 'static_parser': 'True', 'write_json': 'True', 'fail_fast': 'False', 'log_format': 'default', 'no_print': 'None', 'version_check': 'True', 'empty': 'None', 'quiet': 'False', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager'}
[0m17:19:38.811580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2a016a5-f20d-461e-883a-99d85e9f975d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a70d5e0>]}
[0m17:19:38.844534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2a016a5-f20d-461e-883a-99d85e9f975d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a492cf0>]}
[0m17:19:38.845607 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:19:38.939246 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:19:39.104484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:19:39.104902 [debug] [MainThread]: Partial parsing: updated file: sequra_analytics://seeds/orders_merchant.csv
[0m17:19:39.217109 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.sequra_analytics.orders_merchant.column_types
[0m17:19:39.220207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2a016a5-f20d-461e-883a-99d85e9f975d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acdc3e0>]}
[0m17:19:39.266244 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/manifest.json
[0m17:19:39.268327 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/semantic_manifest.json
[0m17:19:39.290387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2a016a5-f20d-461e-883a-99d85e9f975d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa97e00>]}
[0m17:19:39.290709 [info ] [MainThread]: Found 7 models, 2 seeds, 11 data tests, 479 macros
[0m17:19:39.290892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2a016a5-f20d-461e-883a-99d85e9f975d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aca8ad0>]}
[0m17:19:39.291907 [info ] [MainThread]: 
[0m17:19:39.292079 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:19:39.292285 [info ] [MainThread]: 
[0m17:19:39.292595 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:39.294935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m17:19:39.380398 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m17:19:39.380673 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m17:19:39.380824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:42.046086 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.665 seconds
[0m17:19:42.050132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_raw_data)
[0m17:19:42.050530 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_staging'
[0m17:19:42.057145 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_marts'
[0m17:19:42.058191 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m17:19:42.058488 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate'
[0m17:19:42.059736 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m17:19:42.061019 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m17:19:42.061250 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m17:19:42.062278 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m17:19:42.062434 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m17:19:42.062592 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m17:19:42.063309 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m17:19:42.063497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:42.063668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:42.063829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:42.161584 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m17:19:44.410463 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be7f97-0001-66a6-0000-000167de3781
[0m17:19:44.410972 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be7f97-0001-66a6-0000-000167de3779
[0m17:19:44.411246 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be7f97-0001-66a6-0000-000167de377d
[0m17:19:44.411392 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:19:44.411537 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:19:44.411670 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:19:44.411853 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:19:44.412014 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:19:44.412233 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:19:44.412351 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:19:44.412467 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:19:44.412582 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:19:44.413080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2a016a5-f20d-461e-883a-99d85e9f975d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b75da00>]}
[0m17:19:44.416723 [debug] [Thread-1 (]: Began running node seed.sequra_analytics.merchants
[0m17:19:44.416940 [debug] [Thread-2 (]: Began running node seed.sequra_analytics.orders_merchant
[0m17:19:44.417194 [info ] [Thread-1 (]: 1 of 2 START seed file dbt_maximerosa_raw_data.merchants ....................... [RUN]
[0m17:19:44.417471 [info ] [Thread-2 (]: 2 of 2 START seed file dbt_maximerosa_raw_data.orders_merchant ................. [RUN]
[0m17:19:44.417688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_raw_data, now seed.sequra_analytics.merchants)
[0m17:19:44.417873 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now seed.sequra_analytics.orders_merchant)
[0m17:19:44.418042 [debug] [Thread-1 (]: Began compiling node seed.sequra_analytics.merchants
[0m17:19:44.418199 [debug] [Thread-2 (]: Began compiling node seed.sequra_analytics.orders_merchant
[0m17:19:44.418368 [debug] [Thread-1 (]: Began executing node seed.sequra_analytics.merchants
[0m17:19:44.418579 [debug] [Thread-2 (]: Began executing node seed.sequra_analytics.orders_merchant
[0m17:19:44.440823 [debug] [Thread-1 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m17:19:44.441110 [debug] [Thread-1 (]: On seed.sequra_analytics.merchants: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m17:19:44.445339 [debug] [Thread-2 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m17:19:44.446071 [debug] [Thread-2 (]: On seed.sequra_analytics.orders_merchant: create table SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant (order_id integer,shopper_id integer,merchant_id integer,order_date text)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m17:19:44.533177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.092 seconds
[0m17:19:44.533454 [debug] [Thread-1 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m17:19:44.533632 [debug] [Thread-1 (]: On seed.sequra_analytics.merchants: truncate table "SEQURA_DEV"."DBT_MAXIMEROSA_RAW_DATA"."MERCHANTS"
  
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */;
[0m17:19:44.645903 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m17:19:44.654014 [debug] [Thread-2 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m17:19:44.654264 [debug] [Thread-2 (]: On seed.sequra_analytics.orders_merchant: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m17:19:44.736103 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.081 seconds
[0m17:19:44.737324 [debug] [Thread-2 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m17:19:44.737618 [debug] [Thread-2 (]: On seed.sequra_analytics.orders_merchant: insert into SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant (order_id, shopper_id, merchant_id, order_date) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version":...
[0m17:19:44.788290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.254 seconds
[0m17:19:44.789714 [debug] [Thread-1 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m17:19:44.790863 [debug] [Thread-1 (]: On seed.sequra_analytics.merchants: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m17:19:45.025398 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m17:19:45.027702 [debug] [Thread-1 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m17:19:45.027911 [debug] [Thread-1 (]: On seed.sequra_analytics.merchants: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m17:19:45.102212 [debug] [Thread-2 (]: SQL status: SUCCESS 25 in 0.364 seconds
[0m17:19:45.103754 [debug] [Thread-2 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m17:19:45.103951 [debug] [Thread-2 (]: On seed.sequra_analytics.orders_merchant: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m17:19:45.112939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.085 seconds
[0m17:19:45.116335 [debug] [Thread-1 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m17:19:45.117138 [debug] [Thread-1 (]: On seed.sequra_analytics.merchants: insert into SEQURA_DEV.dbt_maximerosa_raw_data.merchants (merchant_id, merchant_name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */...
[0m17:19:45.325857 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.222 seconds
[0m17:19:45.331507 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.sequra_analytics.orders_merchant"
[0m17:19:45.345076 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2a016a5-f20d-461e-883a-99d85e9f975d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106022f60>]}
[0m17:19:45.345522 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file dbt_maximerosa_raw_data.orders_merchant ............. [[32mINSERT 25[0m in 0.93s]
[0m17:19:45.345841 [debug] [Thread-2 (]: Finished running node seed.sequra_analytics.orders_merchant
[0m17:19:45.429501 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.311 seconds
[0m17:19:45.429857 [debug] [Thread-1 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m17:19:45.430046 [debug] [Thread-1 (]: On seed.sequra_analytics.merchants: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m17:19:45.677331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m17:19:45.678919 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sequra_analytics.merchants"
[0m17:19:45.682178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2a016a5-f20d-461e-883a-99d85e9f975d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c512180>]}
[0m17:19:45.682489 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file dbt_maximerosa_raw_data.merchants ................... [[32mINSERT 7[0m in 1.26s]
[0m17:19:45.682767 [debug] [Thread-1 (]: Finished running node seed.sequra_analytics.merchants
[0m17:19:45.683475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:45.683634 [debug] [MainThread]: Connection 'seed.sequra_analytics.merchants' was left open.
[0m17:19:45.683772 [debug] [MainThread]: On seed.sequra_analytics.merchants: Close
[0m17:19:45.776798 [debug] [MainThread]: Connection 'seed.sequra_analytics.orders_merchant' was left open.
[0m17:19:45.777060 [debug] [MainThread]: On seed.sequra_analytics.orders_merchant: Close
[0m17:19:45.876273 [debug] [MainThread]: Connection 'list_SEQURA_DEV_dbt_maximerosa_marts' was left open.
[0m17:19:45.876529 [debug] [MainThread]: On list_SEQURA_DEV_dbt_maximerosa_marts: Close
[0m17:19:45.970417 [debug] [MainThread]: Connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate' was left open.
[0m17:19:45.970640 [debug] [MainThread]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m17:19:46.068719 [info ] [MainThread]: 
[0m17:19:46.069904 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 6.77 seconds (6.77s).
[0m17:19:46.071718 [debug] [MainThread]: Command end result
[0m17:19:46.086020 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/manifest.json
[0m17:19:46.092967 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/semantic_manifest.json
[0m17:19:46.096164 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/run_results.json
[0m17:19:46.096338 [info ] [MainThread]: 
[0m17:19:46.096553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:46.096691 [info ] [MainThread]: 
[0m17:19:46.096842 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:19:46.099245 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.736964, "process_in_blocks": "0", "process_kernel_time": 0.336101, "process_mem_max_rss": "171048960", "process_out_blocks": "0", "process_user_time": 1.613882}
[0m17:19:46.099533 [debug] [MainThread]: Command `dbt seed` succeeded at 17:19:46.099486 after 7.74 seconds
[0m17:19:46.099722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108712c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109132b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7f3260>]}
[0m17:19:46.099900 [debug] [MainThread]: Flushing usage events
[0m17:19:46.516937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:20:11.838563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0d5e0>]}


============================== 17:20:11.842953 | fb7f5aa8-aea9-4b6a-9da4-d551a99d3498 ==============================
[0m17:20:11.842953 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:20:11.843311 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'introspect': 'True', 'log_path': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics/logs', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics', 'target_path': 'None', 'debug': 'False', 'partial_parse': 'True', 'printer_width': '80', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'use_experimental_parser': 'False'}
[0m17:20:12.295263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb7f5aa8-aea9-4b6a-9da4-d551a99d3498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11865c530>]}
[0m17:20:12.326874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb7f5aa8-aea9-4b6a-9da4-d551a99d3498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca26c0>]}
[0m17:20:12.328261 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:20:12.467236 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:20:12.638758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:20:12.639066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:20:12.642291 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.sequra_analytics.orders_merchant.column_types
[0m17:20:12.665282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb7f5aa8-aea9-4b6a-9da4-d551a99d3498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188416d0>]}
[0m17:20:12.709497 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/manifest.json
[0m17:20:12.711584 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/semantic_manifest.json
[0m17:20:12.742013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb7f5aa8-aea9-4b6a-9da4-d551a99d3498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c7b470>]}
[0m17:20:12.742303 [info ] [MainThread]: Found 7 models, 2 seeds, 11 data tests, 479 macros
[0m17:20:12.742479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb7f5aa8-aea9-4b6a-9da4-d551a99d3498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186bc2f0>]}
[0m17:20:12.743540 [info ] [MainThread]: 
[0m17:20:12.743725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:20:12.743866 [info ] [MainThread]: 
[0m17:20:12.744125 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:20:12.746650 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m17:20:12.754086 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m17:20:12.758749 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m17:20:12.830559 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m17:20:12.830888 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m17:20:12.831136 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m17:20:12.831296 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m17:20:12.831456 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m17:20:12.831607 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m17:20:12.831749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:12.831923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:12.832127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:15.484578 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.652 seconds
[0m17:20:15.501008 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.668 seconds
[0m17:20:15.515451 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.683 seconds
[0m17:20:15.518784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now create_SEQURA_DEV_dbt_maximerosa_staging)
[0m17:20:15.520017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now create_SEQURA_DEV_dbt_maximerosa_marts)
[0m17:20:15.523338 [debug] [ThreadPool]: Creating schema "database: "SEQURA_DEV"
schema: "dbt_maximerosa_staging"
"
[0m17:20:15.523711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now create_SEQURA_DEV_dbt_maximerosa_intermediate)
[0m17:20:15.524040 [debug] [ThreadPool]: Creating schema "database: "SEQURA_DEV"
schema: "dbt_maximerosa_marts"
"
[0m17:20:15.527094 [debug] [ThreadPool]: Using snowflake connection "create_SEQURA_DEV_dbt_maximerosa_staging"
[0m17:20:15.527541 [debug] [ThreadPool]: Creating schema "database: "SEQURA_DEV"
schema: "dbt_maximerosa_intermediate"
"
[0m17:20:15.528828 [debug] [ThreadPool]: Using snowflake connection "create_SEQURA_DEV_dbt_maximerosa_marts"
[0m17:20:15.529001 [debug] [ThreadPool]: On create_SEQURA_DEV_dbt_maximerosa_staging: create schema if not exists SEQURA_DEV.dbt_maximerosa_staging
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "create_SEQURA_DEV_dbt_maximerosa_staging"} */
[0m17:20:15.529929 [debug] [ThreadPool]: Using snowflake connection "create_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m17:20:15.530174 [debug] [ThreadPool]: On create_SEQURA_DEV_dbt_maximerosa_marts: create schema if not exists SEQURA_DEV.dbt_maximerosa_marts
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "create_SEQURA_DEV_dbt_maximerosa_marts"} */
[0m17:20:15.530688 [debug] [ThreadPool]: On create_SEQURA_DEV_dbt_maximerosa_intermediate: create schema if not exists SEQURA_DEV.dbt_maximerosa_intermediate
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "create_SEQURA_DEV_dbt_maximerosa_intermediate"} */
[0m17:20:15.634820 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m17:20:15.658724 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m17:20:15.686623 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.156 seconds
[0m17:20:15.692628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_SEQURA_DEV_dbt_maximerosa_intermediate, now list_SEQURA_DEV_dbt_maximerosa_raw_data)
[0m17:20:15.693080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_SEQURA_DEV_dbt_maximerosa_staging, now list_SEQURA_DEV_dbt_maximerosa_staging)
[0m17:20:15.699716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_SEQURA_DEV_dbt_maximerosa_marts, now list_SEQURA_DEV_dbt_maximerosa_marts)
[0m17:20:15.700524 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m17:20:15.700868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate'
[0m17:20:15.702975 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m17:20:15.704285 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m17:20:15.704486 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m17:20:15.705554 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m17:20:15.705702 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m17:20:15.705837 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m17:20:15.706224 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m17:20:15.707056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:15.796921 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.090 seconds
[0m17:20:15.797383 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.091 seconds
[0m17:20:15.814210 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.108 seconds
[0m17:20:18.011663 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.304 seconds
[0m17:20:18.014560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb7f5aa8-aea9-4b6a-9da4-d551a99d3498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c799a0>]}
[0m17:20:18.021998 [debug] [Thread-1 (]: Began running node model.sequra_analytics.stg_merchants
[0m17:20:18.022237 [debug] [Thread-2 (]: Began running node model.sequra_analytics.stg_orders
[0m17:20:18.022516 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt_maximerosa_staging.stg_merchants ............... [RUN]
[0m17:20:18.022832 [info ] [Thread-2 (]: 2 of 7 START sql view model dbt_maximerosa_staging.stg_orders .................. [RUN]
[0m17:20:18.023102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_raw_data, now model.sequra_analytics.stg_merchants)
[0m17:20:18.023305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now model.sequra_analytics.stg_orders)
[0m17:20:18.023499 [debug] [Thread-1 (]: Began compiling node model.sequra_analytics.stg_merchants
[0m17:20:18.023708 [debug] [Thread-2 (]: Began compiling node model.sequra_analytics.stg_orders
[0m17:20:18.027949 [debug] [Thread-1 (]: Writing injected SQL for node "model.sequra_analytics.stg_merchants"
[0m17:20:18.029606 [debug] [Thread-2 (]: Writing injected SQL for node "model.sequra_analytics.stg_orders"
[0m17:20:18.030283 [debug] [Thread-1 (]: Began executing node model.sequra_analytics.stg_merchants
[0m17:20:18.036802 [debug] [Thread-2 (]: Began executing node model.sequra_analytics.stg_orders
[0m17:20:18.053120 [debug] [Thread-1 (]: Writing runtime sql for node "model.sequra_analytics.stg_merchants"
[0m17:20:18.053520 [debug] [Thread-2 (]: Writing runtime sql for node "model.sequra_analytics.stg_orders"
[0m17:20:18.054771 [debug] [Thread-2 (]: Using snowflake connection "model.sequra_analytics.stg_orders"
[0m17:20:18.055013 [debug] [Thread-2 (]: On model.sequra_analytics.stg_orders: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders
  
  
  
  
  as (
    

with source_data as (
    select
        order_id,
        shopper_id,
        merchant_id,
        order_date as order_date_raw,
        -- Parse the date format (d/m/yy or dd/mm/yy)
        case 
            when split_part(order_date, '/', 3) = '22' then '2022'
            when split_part(order_date, '/', 3) = '23' then '2023'
            else '20' || split_part(order_date, '/', 3)
        end || '-' ||
        lpad(split_part(order_date, '/', 2), 2, '0') || '-' ||
        lpad(split_part(order_date, '/', 1), 2, '0') as order_date_formatted
    from SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant
)

select
    order_id,
    shopper_id,
    merchant_id,
    order_date_raw,
    to_date(order_date_formatted, 'YYYY-MM-DD') as order_date,
    date_trunc('month', to_date(order_date_formatted, 'YYYY-MM-DD')) as order_month,
    to_char(to_date(order_date_formatted, 'YYYY-MM-DD'), 'YYYY-MM') as month_year
from source_data
where order_date_raw is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders"} */;
[0m17:20:18.055536 [debug] [Thread-1 (]: Using snowflake connection "model.sequra_analytics.stg_merchants"
[0m17:20:18.055808 [debug] [Thread-1 (]: On model.sequra_analytics.stg_merchants: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
  
  
  
  
  as (
    

select
    merchant_id,
    merchant_name
from SEQURA_DEV.dbt_maximerosa_raw_data.merchants
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_merchants"} */;
[0m17:20:18.318129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.262 seconds
[0m17:20:18.332939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7f5aa8-aea9-4b6a-9da4-d551a99d3498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab72de0>]}
[0m17:20:18.333421 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dbt_maximerosa_staging.stg_merchants .......... [[32mSUCCESS 1[0m in 0.31s]
[0m17:20:18.333709 [debug] [Thread-1 (]: Finished running node model.sequra_analytics.stg_merchants
[0m17:20:18.346982 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.292 seconds
[0m17:20:18.348219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7f5aa8-aea9-4b6a-9da4-d551a99d3498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab6e6c0>]}
[0m17:20:18.348551 [info ] [Thread-2 (]: 2 of 7 OK created sql view model dbt_maximerosa_staging.stg_orders ............. [[32mSUCCESS 1[0m in 0.32s]
[0m17:20:18.348830 [debug] [Thread-2 (]: Finished running node model.sequra_analytics.stg_orders
[0m17:20:18.349280 [debug] [Thread-4 (]: Began running node model.sequra_analytics.int_monthly_shoppers
[0m17:20:18.349515 [info ] [Thread-4 (]: 3 of 7 START sql view model dbt_maximerosa_intermediate.int_monthly_shoppers ... [RUN]
[0m17:20:18.349730 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_intermediate, now model.sequra_analytics.int_monthly_shoppers)
[0m17:20:18.349907 [debug] [Thread-4 (]: Began compiling node model.sequra_analytics.int_monthly_shoppers
[0m17:20:18.351835 [debug] [Thread-4 (]: Writing injected SQL for node "model.sequra_analytics.int_monthly_shoppers"
[0m17:20:18.352109 [debug] [Thread-3 (]: Began running node model.sequra_analytics.int_orders_with_defaults
[0m17:20:18.352351 [debug] [Thread-1 (]: Began running node model.sequra_analytics.int_recurrent_shoppers
[0m17:20:18.352586 [info ] [Thread-3 (]: 4 of 7 START sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [RUN]
[0m17:20:18.352884 [info ] [Thread-1 (]: 5 of 7 START sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers . [RUN]
[0m17:20:18.353134 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now model.sequra_analytics.int_orders_with_defaults)
[0m17:20:18.353371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_merchants, now model.sequra_analytics.int_recurrent_shoppers)
[0m17:20:18.353551 [debug] [Thread-3 (]: Began compiling node model.sequra_analytics.int_orders_with_defaults
[0m17:20:18.353741 [debug] [Thread-1 (]: Began compiling node model.sequra_analytics.int_recurrent_shoppers
[0m17:20:18.355494 [debug] [Thread-3 (]: Writing injected SQL for node "model.sequra_analytics.int_orders_with_defaults"
[0m17:20:18.357356 [debug] [Thread-1 (]: Writing injected SQL for node "model.sequra_analytics.int_recurrent_shoppers"
[0m17:20:18.357705 [debug] [Thread-4 (]: Began executing node model.sequra_analytics.int_monthly_shoppers
[0m17:20:18.359311 [debug] [Thread-4 (]: Writing runtime sql for node "model.sequra_analytics.int_monthly_shoppers"
[0m17:20:18.359811 [debug] [Thread-1 (]: Began executing node model.sequra_analytics.int_recurrent_shoppers
[0m17:20:18.360049 [debug] [Thread-3 (]: Began executing node model.sequra_analytics.int_orders_with_defaults
[0m17:20:18.361454 [debug] [Thread-1 (]: Writing runtime sql for node "model.sequra_analytics.int_recurrent_shoppers"
[0m17:20:18.362929 [debug] [Thread-3 (]: Writing runtime sql for node "model.sequra_analytics.int_orders_with_defaults"
[0m17:20:18.363472 [debug] [Thread-4 (]: Using snowflake connection "model.sequra_analytics.int_monthly_shoppers"
[0m17:20:18.363789 [debug] [Thread-4 (]: On model.sequra_analytics.int_monthly_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers
  
  
  
  
  as (
    

with monthly_orders as (
    select distinct
        order_month,
        month_year,
        merchant_id,
        shopper_id
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
)

select
    order_month,
    month_year,
    merchant_id,
    shopper_id,
    -- Flag if this shopper made a purchase with this merchant in the current month
    1 as made_purchase_current_month
from monthly_orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_monthly_shoppers"} */;
[0m17:20:18.364881 [debug] [Thread-1 (]: Using snowflake connection "model.sequra_analytics.int_recurrent_shoppers"
[0m17:20:18.365604 [debug] [Thread-3 (]: Using snowflake connection "model.sequra_analytics.int_orders_with_defaults"
[0m17:20:18.365826 [debug] [Thread-1 (]: On model.sequra_analytics.int_recurrent_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers
  
  
  
  
  as (
    

with order_history as (
    select
        o1.order_month as current_month,
        o1.month_year as current_month_year,
        o1.merchant_id,
        o1.shopper_id,
        count(distinct o2.order_month) as months_with_purchases
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o1
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_orders o2
        on o1.merchant_id = o2.merchant_id
        and o1.shopper_id = o2.shopper_id
        and o2.order_date between dateadd(month, -11, o1.order_month) and last_day(o1.order_month)
        and o2.order_month <= o1.order_month
    group by 1, 2, 3, 4
)

select
    current_month,
    current_month_year,
    merchant_id,
    shopper_id,
    months_with_purchases,
    -- A shopper is recurrent if they have made purchases in at least 2 different months
    -- within the 12-month window including the current month
    case 
        when months_with_purchases >= 2 then 1 
        else 0 
    end as is_recurrent
from order_history
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_recurrent_shoppers"} */;
[0m17:20:18.366134 [debug] [Thread-3 (]: On model.sequra_analytics.int_orders_with_defaults: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
  
  
  
  
  as (
    

-- Placeholder for Part 2 of the challenge
-- This would contain the logic for calculating default ratios
-- when the additional data tables are available

with orders_base as (
    select
        o.*,
        m.merchant_name,
        -- Placeholder fields for default calculation
        -- These would come from the actual orders table with financial data
        null::boolean as is_in_default,
        null::integer as days_unbalanced,
        null::decimal(15,2) as current_order_value,
        null::decimal(15,2) as overdue_amount,
        null::varchar as product,
        null::integer as shopper_age
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
)

select
    *,
    case
        when days_unbalanced > 90 then '90+'
        when days_unbalanced > 60 then '60'
        when days_unbalanced > 30 then '30'
        when days_unbalanced > 17 then '17'
        else null
    end as delayed_period
from orders_base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_orders_with_defaults"} */;
[0m17:20:18.664883 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.301 seconds
[0m17:20:18.666159 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7f5aa8-aea9-4b6a-9da4-d551a99d3498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb51a00>]}
[0m17:20:18.666618 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.300 seconds
[0m17:20:18.667571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7f5aa8-aea9-4b6a-9da4-d551a99d3498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb5fc50>]}
[0m17:20:18.667914 [info ] [Thread-4 (]: 3 of 7 OK created sql view model dbt_maximerosa_intermediate.int_monthly_shoppers  [[32mSUCCESS 1[0m in 0.32s]
[0m17:20:18.668267 [debug] [Thread-4 (]: Finished running node model.sequra_analytics.int_monthly_shoppers
[0m17:20:18.668553 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers  [[32mSUCCESS 1[0m in 0.31s]
[0m17:20:18.668863 [debug] [Thread-1 (]: Finished running node model.sequra_analytics.int_recurrent_shoppers
[0m17:20:18.669164 [debug] [Thread-2 (]: Began running node model.sequra_analytics.shopper_recurrence_rate
[0m17:20:18.669389 [info ] [Thread-2 (]: 6 of 7 START sql table model dbt_maximerosa_marts.shopper_recurrence_rate ...... [RUN]
[0m17:20:18.669611 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders, now model.sequra_analytics.shopper_recurrence_rate)
[0m17:20:18.669771 [debug] [Thread-2 (]: Began compiling node model.sequra_analytics.shopper_recurrence_rate
[0m17:20:18.671664 [debug] [Thread-2 (]: Writing injected SQL for node "model.sequra_analytics.shopper_recurrence_rate"
[0m17:20:18.672342 [debug] [Thread-2 (]: Began executing node model.sequra_analytics.shopper_recurrence_rate
[0m17:20:18.686501 [debug] [Thread-2 (]: Writing runtime sql for node "model.sequra_analytics.shopper_recurrence_rate"
[0m17:20:18.687740 [debug] [Thread-2 (]: Using snowflake connection "model.sequra_analytics.shopper_recurrence_rate"
[0m17:20:18.687966 [debug] [Thread-2 (]: On model.sequra_analytics.shopper_recurrence_rate: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
    
    
    
    as (

with monthly_metrics as (
    select
        ms.order_month,
        ms.month_year,
        ms.merchant_id,
        m.merchant_name,
        count(distinct ms.shopper_id) as total_shoppers,
        sum(rs.is_recurrent) as recurrent_shoppers
    from SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers ms
    left join SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers rs
        on ms.order_month = rs.current_month
        and ms.merchant_id = rs.merchant_id
        and ms.shopper_id = rs.shopper_id
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on ms.merchant_id = m.merchant_id
    group by 1, 2, 3, 4
)

select
    merchant_name,
    month_year as month,
    round(
        case 
            when total_shoppers > 0 
            then (recurrent_shoppers::decimal / total_shoppers) * 100
            else 0 
        end, 2
    ) as recurrence_rate
from monthly_metrics
order by merchant_name, month
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.shopper_recurrence_rate"} */;
[0m17:20:18.717473 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m17:20:18.718633 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7f5aa8-aea9-4b6a-9da4-d551a99d3498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb74e30>]}
[0m17:20:18.718966 [info ] [Thread-3 (]: 4 of 7 OK created sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [[32mSUCCESS 1[0m in 0.37s]
[0m17:20:18.719255 [debug] [Thread-3 (]: Finished running node model.sequra_analytics.int_orders_with_defaults
[0m17:20:18.719526 [debug] [Thread-1 (]: Began running node model.sequra_analytics.default_ratio_analysis
[0m17:20:18.719748 [info ] [Thread-1 (]: 7 of 7 START sql table model dbt_maximerosa_marts.default_ratio_analysis ....... [RUN]
[0m17:20:18.719944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_recurrent_shoppers, now model.sequra_analytics.default_ratio_analysis)
[0m17:20:18.720104 [debug] [Thread-1 (]: Began compiling node model.sequra_analytics.default_ratio_analysis
[0m17:20:18.721882 [debug] [Thread-1 (]: Writing injected SQL for node "model.sequra_analytics.default_ratio_analysis"
[0m17:20:18.722329 [debug] [Thread-1 (]: Began executing node model.sequra_analytics.default_ratio_analysis
[0m17:20:18.723841 [debug] [Thread-1 (]: Writing runtime sql for node "model.sequra_analytics.default_ratio_analysis"
[0m17:20:18.724874 [debug] [Thread-1 (]: Using snowflake connection "model.sequra_analytics.default_ratio_analysis"
[0m17:20:18.725200 [debug] [Thread-1 (]: On model.sequra_analytics.default_ratio_analysis: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.default_ratio_analysis
    
    
    
    as (

-- This model would calculate the default ratio as requested in Part 2
-- Default Ratio = Loans in Arrears / Total Loans Granted

with default_metrics as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant_name as merchant,
        delayed_period as default_type,
        delayed_period,
        sum(case when is_in_default then current_order_value else 0 end) as debt_amount,
        sum(current_order_value) as total_order_value,
        count(case when is_in_default then 1 end) as orders_in_default,
        count(*) as total_orders
    from SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
    where current_order_value is not null  -- Would filter when real data is available
    group by 1, 2, 3, 4, 5, 6
)

select
    shopper_age,
    month_year_order,
    product,
    merchant,
    default_type,
    delayed_period,
    debt_amount,
    total_order_value,
    orders_in_default,
    total_orders,
    round(
        case 
            when total_order_value > 0 
            then (debt_amount / total_order_value) * 100
            else 0 
        end, 2
    ) as default_ratio_percentage
from default_metrics
order by month_year_order, merchant, delayed_period
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.default_ratio_analysis"} */;
[0m17:20:19.411982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.686 seconds
[0m17:20:19.413348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7f5aa8-aea9-4b6a-9da4-d551a99d3498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab15f40>]}
[0m17:20:19.413707 [info ] [Thread-1 (]: 7 of 7 OK created sql table model dbt_maximerosa_marts.default_ratio_analysis .. [[32mSUCCESS 1[0m in 0.69s]
[0m17:20:19.413993 [debug] [Thread-1 (]: Finished running node model.sequra_analytics.default_ratio_analysis
[0m17:20:20.017040 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.329 seconds
[0m17:20:20.018067 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7f5aa8-aea9-4b6a-9da4-d551a99d3498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb83740>]}
[0m17:20:20.018376 [info ] [Thread-2 (]: 6 of 7 OK created sql table model dbt_maximerosa_marts.shopper_recurrence_rate . [[32mSUCCESS 1[0m in 1.35s]
[0m17:20:20.018874 [debug] [Thread-2 (]: Finished running node model.sequra_analytics.shopper_recurrence_rate
[0m17:20:20.019693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:20.019893 [debug] [MainThread]: Connection 'model.sequra_analytics.default_ratio_analysis' was left open.
[0m17:20:20.020053 [debug] [MainThread]: On model.sequra_analytics.default_ratio_analysis: Close
[0m17:20:20.107233 [debug] [MainThread]: Connection 'model.sequra_analytics.shopper_recurrence_rate' was left open.
[0m17:20:20.107531 [debug] [MainThread]: On model.sequra_analytics.shopper_recurrence_rate: Close
[0m17:20:20.190336 [debug] [MainThread]: Connection 'model.sequra_analytics.int_orders_with_defaults' was left open.
[0m17:20:20.190630 [debug] [MainThread]: On model.sequra_analytics.int_orders_with_defaults: Close
[0m17:20:20.281956 [debug] [MainThread]: Connection 'model.sequra_analytics.int_monthly_shoppers' was left open.
[0m17:20:20.282219 [debug] [MainThread]: On model.sequra_analytics.int_monthly_shoppers: Close
[0m17:20:20.366269 [info ] [MainThread]: 
[0m17:20:20.366611 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 7.62 seconds (7.62s).
[0m17:20:20.367287 [debug] [MainThread]: Command end result
[0m17:20:20.384617 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/manifest.json
[0m17:20:20.386401 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/semantic_manifest.json
[0m17:20:20.391335 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/run_results.json
[0m17:20:20.391555 [info ] [MainThread]: 
[0m17:20:20.391732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:20:20.391934 [info ] [MainThread]: 
[0m17:20:20.392132 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m17:20:20.394033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.604194, "process_in_blocks": "0", "process_kernel_time": 0.42361, "process_mem_max_rss": "180420608", "process_out_blocks": "0", "process_user_time": 1.619248}
[0m17:20:20.394271 [debug] [MainThread]: Command `dbt run` succeeded at 17:20:20.394229 after 8.60 seconds
[0m17:20:20.394450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192c7b00>]}
[0m17:20:20.394666 [debug] [MainThread]: Flushing usage events
[0m17:20:20.852934 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:20:28.112058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f4e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113809940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113809610>]}


============================== 17:20:28.115510 | a00cd281-e84f-4638-98f7-1dff20b9b2da ==============================
[0m17:20:28.115510 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:20:28.115875 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'target_path': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'empty': 'None', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics/logs', 'static_parser': 'True', 'profiles_dir': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_format': 'default', 'no_print': 'None'}
[0m17:20:28.552200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a00cd281-e84f-4638-98f7-1dff20b9b2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ef5c40>]}
[0m17:20:28.584637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a00cd281-e84f-4638-98f7-1dff20b9b2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11455e510>]}
[0m17:20:28.586394 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:20:28.675485 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:20:28.848291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:20:28.848631 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:20:28.852094 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.sequra_analytics.orders_merchant.column_types
[0m17:20:28.874484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a00cd281-e84f-4638-98f7-1dff20b9b2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145b6c30>]}
[0m17:20:28.920066 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/manifest.json
[0m17:20:28.926584 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/semantic_manifest.json
[0m17:20:28.967316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a00cd281-e84f-4638-98f7-1dff20b9b2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a00620>]}
[0m17:20:28.967632 [info ] [MainThread]: Found 7 models, 2 seeds, 11 data tests, 479 macros
[0m17:20:28.967808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a00cd281-e84f-4638-98f7-1dff20b9b2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a02330>]}
[0m17:20:28.969016 [info ] [MainThread]: 
[0m17:20:28.969205 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:20:28.969340 [info ] [MainThread]: 
[0m17:20:28.969591 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:20:28.972134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate'
[0m17:20:28.979542 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_raw_data'
[0m17:20:28.984129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_staging'
[0m17:20:28.985560 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_marts'
[0m17:20:29.078335 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m17:20:29.078660 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m17:20:29.078875 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m17:20:29.079094 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m17:20:29.079318 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m17:20:29.079462 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m17:20:29.079614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:29.079755 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m17:20:29.079919 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m17:20:29.080049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:29.080229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:29.080780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:31.829338 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.749 seconds
[0m17:20:31.833005 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.752 seconds
[0m17:20:31.836389 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.757 seconds
[0m17:20:31.838127 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.758 seconds
[0m17:20:31.839265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a00cd281-e84f-4638-98f7-1dff20b9b2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114740380>]}
[0m17:20:31.846522 [debug] [Thread-1 (]: Began running node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m17:20:31.846740 [debug] [Thread-2 (]: Began running node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m17:20:31.847122 [debug] [Thread-3 (]: Began running node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m17:20:31.846980 [info ] [Thread-1 (]: 1 of 11 START test not_null_shopper_recurrence_rate_merchant_name .............. [RUN]
[0m17:20:31.847333 [debug] [Thread-4 (]: Began running node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m17:20:31.847496 [info ] [Thread-2 (]: 2 of 11 START test not_null_shopper_recurrence_rate_month ...................... [RUN]
[0m17:20:31.847677 [info ] [Thread-3 (]: 3 of 11 START test not_null_shopper_recurrence_rate_recurrence_rate ............ [RUN]
[0m17:20:31.847916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_intermediate, now test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8)
[0m17:20:31.848106 [info ] [Thread-4 (]: 4 of 11 START test not_null_stg_merchants_merchant_id .......................... [RUN]
[0m17:20:31.848306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_raw_data, now test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817)
[0m17:20:31.848486 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1)
[0m17:20:31.848722 [debug] [Thread-1 (]: Began compiling node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m17:20:31.848886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d)
[0m17:20:31.849042 [debug] [Thread-2 (]: Began compiling node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m17:20:31.849191 [debug] [Thread-3 (]: Began compiling node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m17:20:31.856509 [debug] [Thread-4 (]: Began compiling node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m17:20:31.858749 [debug] [Thread-1 (]: Writing injected SQL for node "test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8"
[0m17:20:31.861147 [debug] [Thread-2 (]: Writing injected SQL for node "test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817"
[0m17:20:31.863512 [debug] [Thread-3 (]: Writing injected SQL for node "test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1"
[0m17:20:31.865595 [debug] [Thread-4 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d"
[0m17:20:31.866315 [debug] [Thread-3 (]: Began executing node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m17:20:31.872655 [debug] [Thread-2 (]: Began executing node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m17:20:31.879709 [debug] [Thread-3 (]: Writing runtime sql for node "test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1"
[0m17:20:31.879923 [debug] [Thread-1 (]: Began executing node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m17:20:31.881297 [debug] [Thread-2 (]: Writing runtime sql for node "test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817"
[0m17:20:31.881655 [debug] [Thread-4 (]: Began executing node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m17:20:31.882988 [debug] [Thread-1 (]: Writing runtime sql for node "test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8"
[0m17:20:31.884283 [debug] [Thread-4 (]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d"
[0m17:20:31.884941 [debug] [Thread-3 (]: Using snowflake connection "test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1"
[0m17:20:31.885134 [debug] [Thread-3 (]: On test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recurrence_rate
from SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
where recurrence_rate is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1"} */
[0m17:20:31.885514 [debug] [Thread-2 (]: Using snowflake connection "test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817"
[0m17:20:31.885878 [debug] [Thread-1 (]: Using snowflake connection "test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8"
[0m17:20:31.886276 [debug] [Thread-2 (]: On test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
where month is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817"} */
[0m17:20:31.886653 [debug] [Thread-4 (]: Using snowflake connection "test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d"
[0m17:20:31.886886 [debug] [Thread-1 (]: On test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select merchant_name
from SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
where merchant_name is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8"} */
[0m17:20:31.887203 [debug] [Thread-4 (]: On test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select merchant_id
from SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
where merchant_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d"} */
[0m17:20:32.018917 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m17:20:32.025554 [info ] [Thread-4 (]: 4 of 11 PASS not_null_stg_merchants_merchant_id ................................ [[32mPASS[0m in 0.18s]
[0m17:20:32.025933 [debug] [Thread-4 (]: Finished running node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m17:20:32.026126 [debug] [Thread-4 (]: Began running node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m17:20:32.026291 [info ] [Thread-4 (]: 5 of 11 START test not_null_stg_merchants_merchant_name ........................ [RUN]
[0m17:20:32.026560 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d, now test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b)
[0m17:20:32.026756 [debug] [Thread-4 (]: Began compiling node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m17:20:32.028960 [debug] [Thread-4 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b"
[0m17:20:32.029455 [debug] [Thread-4 (]: Began executing node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m17:20:32.030641 [debug] [Thread-4 (]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b"
[0m17:20:32.031193 [debug] [Thread-4 (]: Using snowflake connection "test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b"
[0m17:20:32.031381 [debug] [Thread-4 (]: On test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select merchant_name
from SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
where merchant_name is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b"} */
[0m17:20:32.063766 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.178 seconds
[0m17:20:32.065014 [info ] [Thread-3 (]: 3 of 11 PASS not_null_shopper_recurrence_rate_recurrence_rate .................. [[32mPASS[0m in 0.22s]
[0m17:20:32.065316 [debug] [Thread-3 (]: Finished running node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m17:20:32.065543 [debug] [Thread-3 (]: Began running node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m17:20:32.065761 [info ] [Thread-3 (]: 6 of 11 START test not_null_stg_orders_merchant_id ............................. [RUN]
[0m17:20:32.066004 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1, now test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2)
[0m17:20:32.066176 [debug] [Thread-3 (]: Began compiling node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m17:20:32.068421 [debug] [Thread-3 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2"
[0m17:20:32.068909 [debug] [Thread-3 (]: Began executing node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m17:20:32.070306 [debug] [Thread-3 (]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2"
[0m17:20:32.071010 [debug] [Thread-3 (]: Using snowflake connection "test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2"
[0m17:20:32.071200 [debug] [Thread-3 (]: On test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select merchant_id
from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where merchant_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2"} */
[0m17:20:32.078834 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m17:20:32.080036 [info ] [Thread-2 (]: 2 of 11 PASS not_null_shopper_recurrence_rate_month ............................ [[32mPASS[0m in 0.23s]
[0m17:20:32.080344 [debug] [Thread-2 (]: Finished running node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m17:20:32.080526 [debug] [Thread-2 (]: Began running node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m17:20:32.080810 [info ] [Thread-2 (]: 7 of 11 START test not_null_stg_orders_order_date .............................. [RUN]
[0m17:20:32.081054 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817, now test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb)
[0m17:20:32.081223 [debug] [Thread-2 (]: Began compiling node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m17:20:32.083409 [debug] [Thread-2 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb"
[0m17:20:32.083826 [debug] [Thread-2 (]: Began executing node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m17:20:32.085838 [debug] [Thread-2 (]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb"
[0m17:20:32.086466 [debug] [Thread-2 (]: Using snowflake connection "test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb"
[0m17:20:32.086676 [debug] [Thread-2 (]: On test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where order_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb"} */
[0m17:20:32.093848 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.206 seconds
[0m17:20:32.095018 [error] [Thread-1 (]: 1 of 11 FAIL 6 not_null_shopper_recurrence_rate_merchant_name .................. [[31mFAIL 6[0m in 0.25s]
[0m17:20:32.095315 [debug] [Thread-1 (]: Finished running node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m17:20:32.095500 [debug] [Thread-1 (]: Began running node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m17:20:32.095725 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_orders_order_id ................................ [RUN]
[0m17:20:32.095948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8, now test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64)
[0m17:20:32.096115 [debug] [Thread-1 (]: Began compiling node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m17:20:32.098341 [debug] [Thread-1 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:20:32.098757 [debug] [Thread-1 (]: Began executing node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m17:20:32.100217 [debug] [Thread-1 (]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:20:32.100817 [debug] [Thread-1 (]: Using snowflake connection "test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:20:32.100995 [debug] [Thread-1 (]: On test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64"} */
[0m17:20:32.147523 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m17:20:32.148659 [info ] [Thread-4 (]: 5 of 11 PASS not_null_stg_merchants_merchant_name .............................. [[32mPASS[0m in 0.12s]
[0m17:20:32.148959 [debug] [Thread-4 (]: Finished running node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m17:20:32.149138 [debug] [Thread-4 (]: Began running node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m17:20:32.149295 [info ] [Thread-4 (]: 9 of 11 START test not_null_stg_orders_shopper_id .............................. [RUN]
[0m17:20:32.149523 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b, now test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112)
[0m17:20:32.149715 [debug] [Thread-4 (]: Began compiling node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m17:20:32.151856 [debug] [Thread-4 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112"
[0m17:20:32.152312 [debug] [Thread-4 (]: Began executing node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m17:20:32.153517 [debug] [Thread-4 (]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112"
[0m17:20:32.154126 [debug] [Thread-4 (]: Using snowflake connection "test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112"
[0m17:20:32.154320 [debug] [Thread-4 (]: On test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shopper_id
from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where shopper_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112"} */
[0m17:20:32.205185 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m17:20:32.206606 [info ] [Thread-3 (]: 6 of 11 PASS not_null_stg_orders_merchant_id ................................... [[32mPASS[0m in 0.14s]
[0m17:20:32.206941 [debug] [Thread-3 (]: Finished running node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m17:20:32.207116 [debug] [Thread-3 (]: Began running node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m17:20:32.207291 [info ] [Thread-3 (]: 10 of 11 START test unique_stg_merchants_merchant_id ........................... [RUN]
[0m17:20:32.207558 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2, now test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1)
[0m17:20:32.207791 [debug] [Thread-3 (]: Began compiling node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m17:20:32.211407 [debug] [Thread-3 (]: Writing injected SQL for node "test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1"
[0m17:20:32.211904 [debug] [Thread-3 (]: Began executing node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m17:20:32.213265 [debug] [Thread-3 (]: Writing runtime sql for node "test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1"
[0m17:20:32.214168 [debug] [Thread-3 (]: Using snowflake connection "test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1"
[0m17:20:32.214423 [debug] [Thread-3 (]: On test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    merchant_id as unique_field,
    count(*) as n_records

from SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
where merchant_id is not null
group by merchant_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1"} */
[0m17:20:32.222343 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m17:20:32.223535 [info ] [Thread-2 (]: 7 of 11 PASS not_null_stg_orders_order_date .................................... [[32mPASS[0m in 0.14s]
[0m17:20:32.223894 [debug] [Thread-2 (]: Finished running node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m17:20:32.224141 [debug] [Thread-2 (]: Began running node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m17:20:32.224425 [info ] [Thread-2 (]: 11 of 11 START test unique_stg_orders_order_id ................................. [RUN]
[0m17:20:32.224732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb, now test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a)
[0m17:20:32.224984 [debug] [Thread-2 (]: Began compiling node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m17:20:32.227117 [debug] [Thread-2 (]: Writing injected SQL for node "test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m17:20:32.227628 [debug] [Thread-2 (]: Began executing node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m17:20:32.228801 [debug] [Thread-2 (]: Writing runtime sql for node "test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m17:20:32.229348 [debug] [Thread-2 (]: Using snowflake connection "test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m17:20:32.229521 [debug] [Thread-2 (]: On test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a"} */
[0m17:20:32.232472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m17:20:32.233544 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.14s]
[0m17:20:32.233829 [debug] [Thread-1 (]: Finished running node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m17:20:32.282206 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m17:20:32.283408 [info ] [Thread-4 (]: 9 of 11 PASS not_null_stg_orders_shopper_id .................................... [[32mPASS[0m in 0.13s]
[0m17:20:32.283701 [debug] [Thread-4 (]: Finished running node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m17:20:32.350276 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m17:20:32.351397 [info ] [Thread-3 (]: 10 of 11 PASS unique_stg_merchants_merchant_id ................................. [[32mPASS[0m in 0.14s]
[0m17:20:32.351683 [debug] [Thread-3 (]: Finished running node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m17:20:32.370602 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m17:20:32.371811 [info ] [Thread-2 (]: 11 of 11 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.15s]
[0m17:20:32.372112 [debug] [Thread-2 (]: Finished running node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m17:20:32.372909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:32.373067 [debug] [MainThread]: Connection 'test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64' was left open.
[0m17:20:32.373209 [debug] [MainThread]: On test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m17:20:32.459566 [debug] [MainThread]: Connection 'test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a' was left open.
[0m17:20:32.459825 [debug] [MainThread]: On test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a: Close
[0m17:20:32.548477 [debug] [MainThread]: Connection 'test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1' was left open.
[0m17:20:32.548733 [debug] [MainThread]: On test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1: Close
[0m17:20:32.631783 [debug] [MainThread]: Connection 'test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112' was left open.
[0m17:20:32.632041 [debug] [MainThread]: On test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112: Close
[0m17:20:32.727200 [info ] [MainThread]: 
[0m17:20:32.727480 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m17:20:32.728345 [debug] [MainThread]: Command end result
[0m17:20:32.747129 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/manifest.json
[0m17:20:32.755424 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/semantic_manifest.json
[0m17:20:32.760258 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/run_results.json
[0m17:20:32.760494 [info ] [MainThread]: 
[0m17:20:32.760702 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:20:32.760856 [info ] [MainThread]: 
[0m17:20:32.761043 [error] [MainThread]: [31mFailure in test not_null_shopper_recurrence_rate_merchant_name (models/marts/schema.yml)[0m
[0m17:20:32.761210 [error] [MainThread]:   Got 6 results, configured to fail if != 0
[0m17:20:32.761335 [info ] [MainThread]: 
[0m17:20:32.761489 [info ] [MainThread]:   compiled code at target/compiled/sequra_analytics/models/marts/schema.yml/not_null_shopper_recurrence_rate_merchant_name.sql
[0m17:20:32.761621 [info ] [MainThread]: 
[0m17:20:32.761763 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=11
[0m17:20:32.763750 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.6948414, "process_in_blocks": "0", "process_kernel_time": 0.449386, "process_mem_max_rss": "186679296", "process_out_blocks": "0", "process_user_time": 1.598903}
[0m17:20:32.763966 [debug] [MainThread]: Command `dbt test` failed at 17:20:32.763927 after 4.70 seconds
[0m17:20:32.764157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157a7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138096d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113809610>]}
[0m17:20:32.764388 [debug] [MainThread]: Flushing usage events
[0m17:20:33.127538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:20:49.848916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107957f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12030da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12030d700>]}


============================== 17:20:49.854302 | e522a42e-73cd-4059-a473-ce1a15b81ec9 ==============================
[0m17:20:49.854302 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:20:49.854673 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics/logs', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics', 'version_check': 'True', 'empty': 'None', 'partial_parse': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt docs generate', 'fail_fast': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'indirect_selection': 'eager'}
[0m17:20:50.306554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e522a42e-73cd-4059-a473-ce1a15b81ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200ffbf0>]}
[0m17:20:50.338149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e522a42e-73cd-4059-a473-ce1a15b81ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124022a20>]}
[0m17:20:50.339180 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:20:50.419067 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:20:50.579074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:20:50.579330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:20:50.582640 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.sequra_analytics.orders_merchant.column_types
[0m17:20:50.606115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e522a42e-73cd-4059-a473-ce1a15b81ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123fb6990>]}
[0m17:20:50.629960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e522a42e-73cd-4059-a473-ce1a15b81ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12422ab40>]}
[0m17:20:50.630275 [info ] [MainThread]: Found 7 models, 2 seeds, 11 data tests, 479 macros
[0m17:20:50.630532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e522a42e-73cd-4059-a473-ce1a15b81ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244a6750>]}
[0m17:20:50.631711 [info ] [MainThread]: 
[0m17:20:50.631900 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:20:50.632037 [info ] [MainThread]: 
[0m17:20:50.632289 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:20:50.634692 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_staging'
[0m17:20:50.636969 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate'
[0m17:20:50.648674 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_raw_data'
[0m17:20:50.650208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_marts'
[0m17:20:50.749624 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m17:20:50.750011 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m17:20:50.750211 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m17:20:50.750491 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m17:20:50.750714 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m17:20:50.750858 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m17:20:50.751021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:50.751167 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m17:20:50.751320 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m17:20:50.751449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:50.751676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:50.752263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:53.480613 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.730 seconds
[0m17:20:53.481038 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.729 seconds
[0m17:20:53.481430 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.730 seconds
[0m17:20:53.513587 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.761 seconds
[0m17:20:53.514959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e522a42e-73cd-4059-a473-ce1a15b81ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1264a71d0>]}
[0m17:20:53.520849 [debug] [Thread-1 (]: Began running node seed.sequra_analytics.merchants
[0m17:20:53.521130 [debug] [Thread-2 (]: Began running node seed.sequra_analytics.orders_merchant
[0m17:20:53.521343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now seed.sequra_analytics.merchants)
[0m17:20:53.521535 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_intermediate, now seed.sequra_analytics.orders_merchant)
[0m17:20:53.521714 [debug] [Thread-1 (]: Began compiling node seed.sequra_analytics.merchants
[0m17:20:53.521894 [debug] [Thread-2 (]: Began compiling node seed.sequra_analytics.orders_merchant
[0m17:20:53.525856 [debug] [Thread-1 (]: Began executing node seed.sequra_analytics.merchants
[0m17:20:53.526941 [debug] [Thread-2 (]: Began executing node seed.sequra_analytics.orders_merchant
[0m17:20:53.527286 [debug] [Thread-1 (]: Finished running node seed.sequra_analytics.merchants
[0m17:20:53.527698 [debug] [Thread-2 (]: Finished running node seed.sequra_analytics.orders_merchant
[0m17:20:53.528002 [debug] [Thread-2 (]: Began running node model.sequra_analytics.stg_merchants
[0m17:20:53.528189 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.sequra_analytics.orders_merchant, now model.sequra_analytics.stg_merchants)
[0m17:20:53.528349 [debug] [Thread-2 (]: Began compiling node model.sequra_analytics.stg_merchants
[0m17:20:53.529960 [debug] [Thread-2 (]: Writing injected SQL for node "model.sequra_analytics.stg_merchants"
[0m17:20:53.530298 [debug] [Thread-3 (]: Began running node model.sequra_analytics.stg_orders
[0m17:20:53.530467 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_raw_data, now model.sequra_analytics.stg_orders)
[0m17:20:53.530615 [debug] [Thread-3 (]: Began compiling node model.sequra_analytics.stg_orders
[0m17:20:53.532142 [debug] [Thread-3 (]: Writing injected SQL for node "model.sequra_analytics.stg_orders"
[0m17:20:53.532459 [debug] [Thread-2 (]: Began executing node model.sequra_analytics.stg_merchants
[0m17:20:53.532761 [debug] [Thread-2 (]: Finished running node model.sequra_analytics.stg_merchants
[0m17:20:53.533018 [debug] [Thread-4 (]: Began running node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m17:20:53.533204 [debug] [Thread-1 (]: Began running node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m17:20:53.533383 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d)
[0m17:20:53.533545 [debug] [Thread-2 (]: Began running node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m17:20:53.533706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.sequra_analytics.merchants, now test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b)
[0m17:20:53.533952 [debug] [Thread-4 (]: Began compiling node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m17:20:53.534131 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_merchants, now test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1)
[0m17:20:53.534301 [debug] [Thread-1 (]: Began compiling node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m17:20:53.534488 [debug] [Thread-3 (]: Began executing node model.sequra_analytics.stg_orders
[0m17:20:53.540915 [debug] [Thread-4 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d"
[0m17:20:53.541213 [debug] [Thread-2 (]: Began compiling node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m17:20:53.543430 [debug] [Thread-1 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b"
[0m17:20:53.543810 [debug] [Thread-3 (]: Finished running node model.sequra_analytics.stg_orders
[0m17:20:53.546931 [debug] [Thread-2 (]: Writing injected SQL for node "test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1"
[0m17:20:53.547378 [debug] [Thread-3 (]: Began running node model.sequra_analytics.int_monthly_shoppers
[0m17:20:53.547565 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders, now model.sequra_analytics.int_monthly_shoppers)
[0m17:20:53.547790 [debug] [Thread-3 (]: Began compiling node model.sequra_analytics.int_monthly_shoppers
[0m17:20:53.549326 [debug] [Thread-3 (]: Writing injected SQL for node "model.sequra_analytics.int_monthly_shoppers"
[0m17:20:53.549704 [debug] [Thread-2 (]: Began executing node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m17:20:53.550021 [debug] [Thread-2 (]: Finished running node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m17:20:53.550203 [debug] [Thread-2 (]: Began running node model.sequra_analytics.int_orders_with_defaults
[0m17:20:53.550371 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1, now model.sequra_analytics.int_orders_with_defaults)
[0m17:20:53.550644 [debug] [Thread-1 (]: Began executing node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m17:20:53.550796 [debug] [Thread-4 (]: Began executing node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m17:20:53.550976 [debug] [Thread-2 (]: Began compiling node model.sequra_analytics.int_orders_with_defaults
[0m17:20:53.551268 [debug] [Thread-1 (]: Finished running node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m17:20:53.551604 [debug] [Thread-4 (]: Finished running node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m17:20:53.551785 [debug] [Thread-3 (]: Began executing node model.sequra_analytics.int_monthly_shoppers
[0m17:20:53.554792 [debug] [Thread-2 (]: Writing injected SQL for node "model.sequra_analytics.int_orders_with_defaults"
[0m17:20:53.555061 [debug] [Thread-1 (]: Began running node model.sequra_analytics.int_recurrent_shoppers
[0m17:20:53.555263 [debug] [Thread-4 (]: Began running node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m17:20:53.555636 [debug] [Thread-3 (]: Finished running node model.sequra_analytics.int_monthly_shoppers
[0m17:20:53.555879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b, now model.sequra_analytics.int_recurrent_shoppers)
[0m17:20:53.556053 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d, now test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2)
[0m17:20:53.556232 [debug] [Thread-3 (]: Began running node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m17:20:53.556404 [debug] [Thread-1 (]: Began compiling node model.sequra_analytics.int_recurrent_shoppers
[0m17:20:53.556556 [debug] [Thread-4 (]: Began compiling node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m17:20:53.556712 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_monthly_shoppers, now test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb)
[0m17:20:53.558430 [debug] [Thread-1 (]: Writing injected SQL for node "model.sequra_analytics.int_recurrent_shoppers"
[0m17:20:53.560438 [debug] [Thread-4 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2"
[0m17:20:53.560640 [debug] [Thread-3 (]: Began compiling node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m17:20:53.560989 [debug] [Thread-2 (]: Began executing node model.sequra_analytics.int_orders_with_defaults
[0m17:20:53.563210 [debug] [Thread-3 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb"
[0m17:20:53.563681 [debug] [Thread-2 (]: Finished running node model.sequra_analytics.int_orders_with_defaults
[0m17:20:53.564056 [debug] [Thread-2 (]: Began running node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m17:20:53.564254 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_orders_with_defaults, now test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64)
[0m17:20:53.564432 [debug] [Thread-1 (]: Began executing node model.sequra_analytics.int_recurrent_shoppers
[0m17:20:53.564697 [debug] [Thread-2 (]: Began compiling node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m17:20:53.564866 [debug] [Thread-4 (]: Began executing node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m17:20:53.565079 [debug] [Thread-3 (]: Began executing node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m17:20:53.565354 [debug] [Thread-1 (]: Finished running node model.sequra_analytics.int_recurrent_shoppers
[0m17:20:53.567383 [debug] [Thread-2 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:20:53.567746 [debug] [Thread-4 (]: Finished running node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m17:20:53.568034 [debug] [Thread-3 (]: Finished running node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m17:20:53.568213 [debug] [Thread-1 (]: Began running node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m17:20:53.568458 [debug] [Thread-4 (]: Began running node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m17:20:53.568657 [debug] [Thread-3 (]: Began running node model.sequra_analytics.default_ratio_analysis
[0m17:20:53.568865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_recurrent_shoppers, now test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112)
[0m17:20:53.569039 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2, now test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a)
[0m17:20:53.569224 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb, now model.sequra_analytics.default_ratio_analysis)
[0m17:20:53.569384 [debug] [Thread-1 (]: Began compiling node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m17:20:53.569534 [debug] [Thread-4 (]: Began compiling node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m17:20:53.569683 [debug] [Thread-3 (]: Began compiling node model.sequra_analytics.default_ratio_analysis
[0m17:20:53.571990 [debug] [Thread-1 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112"
[0m17:20:53.573971 [debug] [Thread-4 (]: Writing injected SQL for node "test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m17:20:53.575628 [debug] [Thread-3 (]: Writing injected SQL for node "model.sequra_analytics.default_ratio_analysis"
[0m17:20:53.575944 [debug] [Thread-2 (]: Began executing node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m17:20:53.576366 [debug] [Thread-2 (]: Finished running node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m17:20:53.576544 [debug] [Thread-2 (]: Began running node model.sequra_analytics.shopper_recurrence_rate
[0m17:20:53.576737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64, now model.sequra_analytics.shopper_recurrence_rate)
[0m17:20:53.576893 [debug] [Thread-2 (]: Began compiling node model.sequra_analytics.shopper_recurrence_rate
[0m17:20:53.578673 [debug] [Thread-2 (]: Writing injected SQL for node "model.sequra_analytics.shopper_recurrence_rate"
[0m17:20:53.578979 [debug] [Thread-3 (]: Began executing node model.sequra_analytics.default_ratio_analysis
[0m17:20:53.579149 [debug] [Thread-4 (]: Began executing node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m17:20:53.579431 [debug] [Thread-3 (]: Finished running node model.sequra_analytics.default_ratio_analysis
[0m17:20:53.579694 [debug] [Thread-4 (]: Finished running node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m17:20:53.579869 [debug] [Thread-1 (]: Began executing node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m17:20:53.580232 [debug] [Thread-1 (]: Finished running node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m17:20:53.580400 [debug] [Thread-2 (]: Began executing node model.sequra_analytics.shopper_recurrence_rate
[0m17:20:53.580749 [debug] [Thread-2 (]: Finished running node model.sequra_analytics.shopper_recurrence_rate
[0m17:20:53.581169 [debug] [Thread-3 (]: Began running node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m17:20:53.581386 [debug] [Thread-4 (]: Began running node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m17:20:53.581554 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.default_ratio_analysis, now test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8)
[0m17:20:53.581724 [debug] [Thread-1 (]: Began running node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m17:20:53.581886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a, now test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817)
[0m17:20:53.582041 [debug] [Thread-3 (]: Began compiling node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m17:20:53.582189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112, now test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1)
[0m17:20:53.582337 [debug] [Thread-4 (]: Began compiling node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m17:20:53.584297 [debug] [Thread-3 (]: Writing injected SQL for node "test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8"
[0m17:20:53.584511 [debug] [Thread-1 (]: Began compiling node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m17:20:53.586340 [debug] [Thread-4 (]: Writing injected SQL for node "test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817"
[0m17:20:53.589312 [debug] [Thread-1 (]: Writing injected SQL for node "test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1"
[0m17:20:53.590247 [debug] [Thread-3 (]: Began executing node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m17:20:53.590603 [debug] [Thread-3 (]: Finished running node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m17:20:53.591363 [debug] [Thread-1 (]: Began executing node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m17:20:53.591697 [debug] [Thread-1 (]: Finished running node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m17:20:53.591868 [debug] [Thread-4 (]: Began executing node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m17:20:53.592171 [debug] [Thread-4 (]: Finished running node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m17:20:53.592675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:53.592828 [debug] [MainThread]: Connection 'test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1' was left open.
[0m17:20:53.592964 [debug] [MainThread]: On test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1: Close
[0m17:20:53.679890 [debug] [MainThread]: Connection 'model.sequra_analytics.shopper_recurrence_rate' was left open.
[0m17:20:53.680167 [debug] [MainThread]: On model.sequra_analytics.shopper_recurrence_rate: Close
[0m17:20:53.773693 [debug] [MainThread]: Connection 'test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8' was left open.
[0m17:20:53.773959 [debug] [MainThread]: On test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8: Close
[0m17:20:53.855338 [debug] [MainThread]: Connection 'test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817' was left open.
[0m17:20:53.855586 [debug] [MainThread]: On test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817: Close
[0m17:20:53.952222 [debug] [MainThread]: Command end result
[0m17:20:53.995267 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/manifest.json
[0m17:20:53.997024 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/semantic_manifest.json
[0m17:20:54.001594 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/run_results.json
[0m17:20:54.004067 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m17:20:54.004233 [info ] [MainThread]: Building catalog
[0m17:20:54.009330 [debug] [ThreadPool]: Acquiring new snowflake connection 'SEQURA_DEV.information_schema'
[0m17:20:54.018694 [debug] [ThreadPool]: Using snowflake connection "SEQURA_DEV.information_schema"
[0m17:20:54.019177 [debug] [ThreadPool]: On SEQURA_DEV.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from SEQURA_DEV.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'dbt_maximerosa_staging' and upper("table_schema") = upper('dbt_maximerosa_staging')

                    and 
    "table_name" ilike 'stg_merchants' and upper("table_name") = upper('stg_merchants')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_raw_data' and upper("table_schema") = upper('dbt_maximerosa_raw_data')

                    and 
    "table_name" ilike 'merchants' and upper("table_name") = upper('merchants')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_raw_data' and upper("table_schema") = upper('dbt_maximerosa_raw_data')

                    and 
    "table_name" ilike 'orders_merchant' and upper("table_name") = upper('orders_merchant')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_marts' and upper("table_schema") = upper('dbt_maximerosa_marts')

                    and 
    "table_name" ilike 'default_ratio_analysis' and upper("table_name") = upper('default_ratio_analysis')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_intermediate' and upper("table_schema") = upper('dbt_maximerosa_intermediate')

                    and 
    "table_name" ilike 'int_recurrent_shoppers' and upper("table_name") = upper('int_recurrent_shoppers')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_intermediate' and upper("table_schema") = upper('dbt_maximerosa_intermediate')

                    and 
    "table_name" ilike 'int_monthly_shoppers' and upper("table_name") = upper('int_monthly_shoppers')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_marts' and upper("table_schema") = upper('dbt_maximerosa_marts')

                    and 
    "table_name" ilike 'shopper_recurrence_rate' and upper("table_name") = upper('shopper_recurrence_rate')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_staging' and upper("table_schema") = upper('dbt_maximerosa_staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_intermediate' and upper("table_schema") = upper('dbt_maximerosa_intermediate')

                    and 
    "table_name" ilike 'int_orders_with_defaults' and upper("table_name") = upper('int_orders_with_defaults')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from SEQURA_DEV.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'dbt_maximerosa_staging' and upper("table_schema") = upper('dbt_maximerosa_staging')

                    and 
    "table_name" ilike 'stg_merchants' and upper("table_name") = upper('stg_merchants')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_raw_data' and upper("table_schema") = upper('dbt_maximerosa_raw_data')

                    and 
    "table_name" ilike 'merchants' and upper("table_name") = upper('merchants')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_raw_data' and upper("table_schema") = upper('dbt_maximerosa_raw_data')

                    and 
    "table_name" ilike 'orders_merchant' and upper("table_name") = upper('orders_merchant')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_marts' and upper("table_schema") = upper('dbt_maximerosa_marts')

                    and 
    "table_name" ilike 'default_ratio_analysis' and upper("table_name") = upper('default_ratio_analysis')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_intermediate' and upper("table_schema") = upper('dbt_maximerosa_intermediate')

                    and 
    "table_name" ilike 'int_recurrent_shoppers' and upper("table_name") = upper('int_recurrent_shoppers')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_intermediate' and upper("table_schema") = upper('dbt_maximerosa_intermediate')

                    and 
    "table_name" ilike 'int_monthly_shoppers' and upper("table_name") = upper('int_monthly_shoppers')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_marts' and upper("table_schema") = upper('dbt_maximerosa_marts')

                    and 
    "table_name" ilike 'shopper_recurrence_rate' and upper("table_name") = upper('shopper_recurrence_rate')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_staging' and upper("table_schema") = upper('dbt_maximerosa_staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'dbt_maximerosa_intermediate' and upper("table_schema") = upper('dbt_maximerosa_intermediate')

                    and 
    "table_name" ilike 'int_orders_with_defaults' and upper("table_name") = upper('int_orders_with_defaults')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "SEQURA_DEV.information_schema"} */
[0m17:20:54.019529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:01.636561 [debug] [ThreadPool]: SQL status: SUCCESS 55 in 7.617 seconds
[0m17:21:01.656417 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/catalog.json
[0m17:21:01.669876 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/manifest.json
[0m17:21:01.671321 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/semantic_manifest.json
[0m17:21:01.671550 [info ] [MainThread]: Catalog written to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/catalog.json
[0m17:21:01.673363 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 11.875957, "process_in_blocks": "0", "process_kernel_time": 0.490461, "process_mem_max_rss": "166526976", "process_out_blocks": "0", "process_user_time": 1.590788}
[0m17:21:01.673652 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:21:01.673606 after 11.88 seconds
[0m17:21:01.673811 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:21:01.673933 [debug] [MainThread]: Connection 'SEQURA_DEV.information_schema' was left open.
[0m17:21:01.674056 [debug] [MainThread]: On SEQURA_DEV.information_schema: Close
[0m17:21:01.761625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079564b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244a5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202a2ae0>]}
[0m17:21:01.761936 [debug] [MainThread]: Flushing usage events
[0m17:21:02.155149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:03.886051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104320a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106311940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106311640>]}


============================== 17:21:03.889807 | 5d639bf2-ec0e-4b5f-a739-5407a5d69aff ==============================
[0m17:21:03.889807 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:21:03.890260 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'no_print': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'None', 'log_path': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics/logs', 'introspect': 'True', 'quiet': 'False', 'debug': 'False', 'use_experimental_parser': 'False'}
[0m17:21:04.239310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d639bf2-ec0e-4b5f-a739-5407a5d69aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c5b80>]}
[0m17:21:04.271990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d639bf2-ec0e-4b5f-a739-5407a5d69aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6f230>]}
[0m17:30:15.192398 [error] [MainThread]: Encountered an error:

[0m17:30:15.207759 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/maximerosa/Downloads/sequra_test/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/maximerosa/Downloads/sequra_test/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/maximerosa/Downloads/sequra_test/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/maximerosa/Downloads/sequra_test/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/maximerosa/Downloads/sequra_test/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/maximerosa/Downloads/sequra_test/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/maximerosa/Downloads/sequra_test/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:30:15.210733 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 551.3838, "process_in_blocks": "0", "process_kernel_time": 0.215163, "process_mem_max_rss": "131366912", "process_out_blocks": "0", "process_user_time": 1.021083}
[0m17:30:15.212292 [debug] [MainThread]: Command `dbt docs serve` failed at 17:30:15.212190 after 551.39 seconds
[0m17:30:15.212909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063114c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073897f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107389bb0>]}
[0m17:30:15.213203 [debug] [MainThread]: Flushing usage events
[0m17:30:15.622514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:23.138263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104843c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0d5e0>]}


============================== 17:30:23.141728 | 4b80d1c6-1107-40c6-815e-130888999b92 ==============================
[0m17:30:23.141728 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:30:23.142174 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics/logs', 'target_path': 'None', 'quiet': 'False', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'static_parser': 'True', 'profiles_dir': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics'}
[0m17:30:23.521352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b80d1c6-1107-40c6-815e-130888999b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106434050>]}
[0m17:30:23.553049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b80d1c6-1107-40c6-815e-130888999b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c5070>]}
[0m17:30:23.554225 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:30:23.638534 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:30:23.809667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:30:23.810108 [debug] [MainThread]: Partial parsing: updated file: sequra_analytics://models/marts/default_ratio_analysis.sql
[0m17:30:23.975397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.sequra_analytics.orders_merchant.column_types
[0m17:30:23.978747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b80d1c6-1107-40c6-815e-130888999b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081165a0>]}
[0m17:30:24.022520 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/manifest.json
[0m17:30:24.024406 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/semantic_manifest.json
[0m17:30:24.046790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b80d1c6-1107-40c6-815e-130888999b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afc2420>]}
[0m17:30:24.047100 [info ] [MainThread]: Found 7 models, 2 seeds, 11 data tests, 479 macros
[0m17:30:24.047281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b80d1c6-1107-40c6-815e-130888999b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e553a0>]}
[0m17:30:24.048309 [info ] [MainThread]: 
[0m17:30:24.048490 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:30:24.048624 [info ] [MainThread]: 
[0m17:30:24.048939 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:30:24.051491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m17:30:24.059117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m17:30:24.060607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m17:30:24.156081 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m17:30:24.156413 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m17:30:24.156669 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m17:30:24.156853 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m17:30:24.157026 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m17:30:24.157193 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m17:30:24.157339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:24.157479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:24.157608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:26.876412 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.719 seconds
[0m17:30:26.876837 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.719 seconds
[0m17:30:26.878165 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.721 seconds
[0m17:30:26.880159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_raw_data)
[0m17:30:26.887565 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m17:30:26.887777 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m17:30:26.888391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_marts)
[0m17:30:26.889787 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m17:30:26.890120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_intermediate)
[0m17:30:26.890297 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m17:30:26.890845 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_staging'
[0m17:30:26.892248 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m17:30:26.893836 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m17:30:26.894245 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m17:30:26.894623 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m17:30:26.895086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:26.989696 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.095 seconds
[0m17:30:26.991511 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.104 seconds
[0m17:30:26.993042 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.100 seconds
[0m17:30:29.233753 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.338 seconds
[0m17:30:29.237360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b80d1c6-1107-40c6-815e-130888999b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcd5b80>]}
[0m17:30:29.242329 [debug] [Thread-1 (]: Began running node model.sequra_analytics.stg_merchants
[0m17:30:29.242631 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt_maximerosa_staging.stg_merchants ............... [RUN]
[0m17:30:29.242873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_raw_data, now model.sequra_analytics.stg_merchants)
[0m17:30:29.243059 [debug] [Thread-1 (]: Began compiling node model.sequra_analytics.stg_merchants
[0m17:30:29.247213 [debug] [Thread-1 (]: Writing injected SQL for node "model.sequra_analytics.stg_merchants"
[0m17:30:29.247473 [debug] [Thread-2 (]: Began running node model.sequra_analytics.stg_orders
[0m17:30:29.247679 [info ] [Thread-2 (]: 2 of 7 START sql view model dbt_maximerosa_staging.stg_orders .................. [RUN]
[0m17:30:29.247883 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now model.sequra_analytics.stg_orders)
[0m17:30:29.248072 [debug] [Thread-2 (]: Began compiling node model.sequra_analytics.stg_orders
[0m17:30:29.250964 [debug] [Thread-2 (]: Writing injected SQL for node "model.sequra_analytics.stg_orders"
[0m17:30:29.251441 [debug] [Thread-1 (]: Began executing node model.sequra_analytics.stg_merchants
[0m17:30:29.267609 [debug] [Thread-1 (]: Writing runtime sql for node "model.sequra_analytics.stg_merchants"
[0m17:30:29.268049 [debug] [Thread-2 (]: Began executing node model.sequra_analytics.stg_orders
[0m17:30:29.269597 [debug] [Thread-2 (]: Writing runtime sql for node "model.sequra_analytics.stg_orders"
[0m17:30:29.270152 [debug] [Thread-1 (]: Using snowflake connection "model.sequra_analytics.stg_merchants"
[0m17:30:29.270389 [debug] [Thread-1 (]: On model.sequra_analytics.stg_merchants: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
  
  
  
  
  as (
    

select
    merchant_id,
    merchant_name
from SEQURA_DEV.dbt_maximerosa_raw_data.merchants
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_merchants"} */;
[0m17:30:29.271184 [debug] [Thread-2 (]: Using snowflake connection "model.sequra_analytics.stg_orders"
[0m17:30:29.271575 [debug] [Thread-2 (]: On model.sequra_analytics.stg_orders: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders
  
  
  
  
  as (
    

with source_data as (
    select
        order_id,
        shopper_id,
        merchant_id,
        order_date as order_date_raw,
        -- Parse the date format (d/m/yy or dd/mm/yy)
        case 
            when split_part(order_date, '/', 3) = '22' then '2022'
            when split_part(order_date, '/', 3) = '23' then '2023'
            else '20' || split_part(order_date, '/', 3)
        end || '-' ||
        lpad(split_part(order_date, '/', 2), 2, '0') || '-' ||
        lpad(split_part(order_date, '/', 1), 2, '0') as order_date_formatted
    from SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant
)

select
    order_id,
    shopper_id,
    merchant_id,
    order_date_raw,
    to_date(order_date_formatted, 'YYYY-MM-DD') as order_date,
    date_trunc('month', to_date(order_date_formatted, 'YYYY-MM-DD')) as order_month,
    to_char(to_date(order_date_formatted, 'YYYY-MM-DD'), 'YYYY-MM') as month_year
from source_data
where order_date_raw is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders"} */;
[0m17:30:29.496260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m17:30:29.512952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b80d1c6-1107-40c6-815e-130888999b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641b230>]}
[0m17:30:29.513353 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dbt_maximerosa_staging.stg_merchants .......... [[32mSUCCESS 1[0m in 0.27s]
[0m17:30:29.513689 [debug] [Thread-1 (]: Finished running node model.sequra_analytics.stg_merchants
[0m17:30:29.544839 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m17:30:29.546123 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b80d1c6-1107-40c6-815e-130888999b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec8170>]}
[0m17:30:29.546457 [info ] [Thread-2 (]: 2 of 7 OK created sql view model dbt_maximerosa_staging.stg_orders ............. [[32mSUCCESS 1[0m in 0.30s]
[0m17:30:29.546742 [debug] [Thread-2 (]: Finished running node model.sequra_analytics.stg_orders
[0m17:30:29.547095 [debug] [Thread-4 (]: Began running node model.sequra_analytics.default_ratio_analysis
[0m17:30:29.547307 [info ] [Thread-4 (]: 3 of 7 START sql table model dbt_maximerosa_marts.default_ratio_analysis ....... [RUN]
[0m17:30:29.547716 [debug] [Thread-3 (]: Began running node model.sequra_analytics.int_monthly_shoppers
[0m17:30:29.547904 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now model.sequra_analytics.default_ratio_analysis)
[0m17:30:29.548078 [debug] [Thread-1 (]: Began running node model.sequra_analytics.int_orders_with_defaults
[0m17:30:29.548415 [debug] [Thread-2 (]: Began running node model.sequra_analytics.int_recurrent_shoppers
[0m17:30:29.548656 [info ] [Thread-3 (]: 4 of 7 START sql view model dbt_maximerosa_intermediate.int_monthly_shoppers ... [RUN]
[0m17:30:29.548865 [debug] [Thread-4 (]: Began compiling node model.sequra_analytics.default_ratio_analysis
[0m17:30:29.549067 [info ] [Thread-1 (]: 5 of 7 START sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [RUN]
[0m17:30:29.549286 [info ] [Thread-2 (]: 6 of 7 START sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers . [RUN]
[0m17:30:29.549482 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_intermediate, now model.sequra_analytics.int_monthly_shoppers)
[0m17:30:29.551397 [debug] [Thread-4 (]: Writing injected SQL for node "model.sequra_analytics.default_ratio_analysis"
[0m17:30:29.551621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_merchants, now model.sequra_analytics.int_orders_with_defaults)
[0m17:30:29.551796 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders, now model.sequra_analytics.int_recurrent_shoppers)
[0m17:30:29.551963 [debug] [Thread-3 (]: Began compiling node model.sequra_analytics.int_monthly_shoppers
[0m17:30:29.552220 [debug] [Thread-1 (]: Began compiling node model.sequra_analytics.int_orders_with_defaults
[0m17:30:29.552432 [debug] [Thread-2 (]: Began compiling node model.sequra_analytics.int_recurrent_shoppers
[0m17:30:29.554157 [debug] [Thread-3 (]: Writing injected SQL for node "model.sequra_analytics.int_monthly_shoppers"
[0m17:30:29.555980 [debug] [Thread-1 (]: Writing injected SQL for node "model.sequra_analytics.int_orders_with_defaults"
[0m17:30:29.557855 [debug] [Thread-2 (]: Writing injected SQL for node "model.sequra_analytics.int_recurrent_shoppers"
[0m17:30:29.558150 [debug] [Thread-4 (]: Began executing node model.sequra_analytics.default_ratio_analysis
[0m17:30:29.571864 [debug] [Thread-4 (]: Writing runtime sql for node "model.sequra_analytics.default_ratio_analysis"
[0m17:30:29.572161 [debug] [Thread-1 (]: Began executing node model.sequra_analytics.int_orders_with_defaults
[0m17:30:29.573552 [debug] [Thread-1 (]: Writing runtime sql for node "model.sequra_analytics.int_orders_with_defaults"
[0m17:30:29.573849 [debug] [Thread-3 (]: Began executing node model.sequra_analytics.int_monthly_shoppers
[0m17:30:29.575091 [debug] [Thread-3 (]: Writing runtime sql for node "model.sequra_analytics.int_monthly_shoppers"
[0m17:30:29.575381 [debug] [Thread-2 (]: Began executing node model.sequra_analytics.int_recurrent_shoppers
[0m17:30:29.576786 [debug] [Thread-4 (]: Using snowflake connection "model.sequra_analytics.default_ratio_analysis"
[0m17:30:29.577437 [debug] [Thread-1 (]: Using snowflake connection "model.sequra_analytics.int_orders_with_defaults"
[0m17:30:29.578633 [debug] [Thread-2 (]: Writing runtime sql for node "model.sequra_analytics.int_recurrent_shoppers"
[0m17:30:29.578935 [debug] [Thread-4 (]: On model.sequra_analytics.default_ratio_analysis: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.default_ratio_analysis
    
    
    
    as (

-- This model calculates the default ratio as requested in Part 2

with orders_with_defaults as (
    -- This would come from the actual orders table with financial data
    select
        o.*,
        m.merchant_name as merchant,
        -- These fields would come from the actual source data:
        null::integer as shopper_age,
        null::varchar as product,
        null::boolean as is_in_default,
        null::integer as days_unbalanced,
        null::decimal(15,2) as current_order_value,
        null::decimal(15,2) as overdue_amount
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
),

-- Calculate delayed periods based on days_unbalanced
-- An order with 35 days unbalanced is included in both 17 and 30 day calculations
delayed_period_17 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '17' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 17
        and is_in_default = true
),

delayed_period_30 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '30' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 30
        and is_in_default = true
),

delayed_period_60 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '60' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 60
        and is_in_default = true
),

delayed_period_90 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '90' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 90
        and is_in_default = true
),

-- Union all delayed periods
all_defaults as (
    select * from delayed_period_17
    union all
    select * from delayed_period_30
    union all
    select * from delayed_period_60
    union all
    select * from delayed_period_90
)

-- Final output with the exact columns requested
select
    shopper_age,
    month_year_order,
    product,
    merchant,
    default_type,
    delayed_period
from all_defaults
order by 
    month_year_order,
    merchant,
    delayed_period::integer
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.default_ratio_analysis"} */;
[0m17:30:29.579224 [debug] [Thread-1 (]: On model.sequra_analytics.int_orders_with_defaults: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
  
  
  
  
  as (
    

-- Placeholder for Part 2 of the challenge
-- This would contain the logic for calculating default ratios
-- when the additional data tables are available

with orders_base as (
    select
        o.*,
        m.merchant_name,
        -- Placeholder fields for default calculation
        -- These would come from the actual orders table with financial data
        null::boolean as is_in_default,
        null::integer as days_unbalanced,
        null::decimal(15,2) as current_order_value,
        null::decimal(15,2) as overdue_amount,
        null::varchar as product,
        null::integer as shopper_age
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
)

select
    *,
    case
        when days_unbalanced > 90 then '90+'
        when days_unbalanced > 60 then '60'
        when days_unbalanced > 30 then '30'
        when days_unbalanced > 17 then '17'
        else null
    end as delayed_period
from orders_base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_orders_with_defaults"} */;
[0m17:30:29.579713 [debug] [Thread-3 (]: Using snowflake connection "model.sequra_analytics.int_monthly_shoppers"
[0m17:30:29.580259 [debug] [Thread-3 (]: On model.sequra_analytics.int_monthly_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers
  
  
  
  
  as (
    

with monthly_orders as (
    select distinct
        order_month,
        month_year,
        merchant_id,
        shopper_id
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
)

select
    order_month,
    month_year,
    merchant_id,
    shopper_id,
    -- Flag if this shopper made a purchase with this merchant in the current month
    1 as made_purchase_current_month
from monthly_orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_monthly_shoppers"} */;
[0m17:30:29.581148 [debug] [Thread-2 (]: Using snowflake connection "model.sequra_analytics.int_recurrent_shoppers"
[0m17:30:29.581611 [debug] [Thread-2 (]: On model.sequra_analytics.int_recurrent_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers
  
  
  
  
  as (
    

with order_history as (
    select
        o1.order_month as current_month,
        o1.month_year as current_month_year,
        o1.merchant_id,
        o1.shopper_id,
        count(distinct o2.order_month) as months_with_purchases
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o1
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_orders o2
        on o1.merchant_id = o2.merchant_id
        and o1.shopper_id = o2.shopper_id
        and o2.order_date between dateadd(month, -11, o1.order_month) and last_day(o1.order_month)
        and o2.order_month <= o1.order_month
    group by 1, 2, 3, 4
)

select
    current_month,
    current_month_year,
    merchant_id,
    shopper_id,
    months_with_purchases,
    -- A shopper is recurrent if they have made purchases in at least 2 different months
    -- within the 12-month window including the current month
    case 
        when months_with_purchases >= 2 then 1 
        else 0 
    end as is_recurrent
from order_history
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_recurrent_shoppers"} */;
[0m17:30:29.854478 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m17:30:29.857342 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b80d1c6-1107-40c6-815e-130888999b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111abdf40>]}
[0m17:30:29.857789 [info ] [Thread-3 (]: 4 of 7 OK created sql view model dbt_maximerosa_intermediate.int_monthly_shoppers  [[32mSUCCESS 1[0m in 0.31s]
[0m17:30:29.858138 [debug] [Thread-3 (]: Finished running node model.sequra_analytics.int_monthly_shoppers
[0m17:30:29.880555 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.299 seconds
[0m17:30:29.881771 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b80d1c6-1107-40c6-815e-130888999b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bed4a70>]}
[0m17:30:29.882100 [info ] [Thread-2 (]: 6 of 7 OK created sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers  [[32mSUCCESS 1[0m in 0.33s]
[0m17:30:29.882360 [debug] [Thread-2 (]: Finished running node model.sequra_analytics.int_recurrent_shoppers
[0m17:30:29.882657 [debug] [Thread-3 (]: Began running node model.sequra_analytics.shopper_recurrence_rate
[0m17:30:29.882997 [info ] [Thread-3 (]: 7 of 7 START sql table model dbt_maximerosa_marts.shopper_recurrence_rate ...... [RUN]
[0m17:30:29.883240 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_monthly_shoppers, now model.sequra_analytics.shopper_recurrence_rate)
[0m17:30:29.883489 [debug] [Thread-3 (]: Began compiling node model.sequra_analytics.shopper_recurrence_rate
[0m17:30:29.885523 [debug] [Thread-3 (]: Writing injected SQL for node "model.sequra_analytics.shopper_recurrence_rate"
[0m17:30:29.886417 [debug] [Thread-3 (]: Began executing node model.sequra_analytics.shopper_recurrence_rate
[0m17:30:29.887879 [debug] [Thread-3 (]: Writing runtime sql for node "model.sequra_analytics.shopper_recurrence_rate"
[0m17:30:29.889142 [debug] [Thread-3 (]: Using snowflake connection "model.sequra_analytics.shopper_recurrence_rate"
[0m17:30:29.889391 [debug] [Thread-3 (]: On model.sequra_analytics.shopper_recurrence_rate: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
    
    
    
    as (

with monthly_metrics as (
    select
        ms.order_month,
        ms.month_year,
        ms.merchant_id,
        m.merchant_name,
        count(distinct ms.shopper_id) as total_shoppers,
        sum(rs.is_recurrent) as recurrent_shoppers
    from SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers ms
    left join SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers rs
        on ms.order_month = rs.current_month
        and ms.merchant_id = rs.merchant_id
        and ms.shopper_id = rs.shopper_id
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on ms.merchant_id = m.merchant_id
    group by 1, 2, 3, 4
)

select
    merchant_name,
    month_year as month,
    round(
        case 
            when total_shoppers > 0 
            then (recurrent_shoppers::decimal / total_shoppers) * 100
            else 0 
        end, 2
    ) as recurrence_rate
from monthly_metrics
order by merchant_name, month
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.shopper_recurrence_rate"} */;
[0m17:30:29.955437 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m17:30:29.956675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b80d1c6-1107-40c6-815e-130888999b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11253cbc0>]}
[0m17:30:29.957021 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [[32mSUCCESS 1[0m in 0.41s]
[0m17:30:29.957291 [debug] [Thread-1 (]: Finished running node model.sequra_analytics.int_orders_with_defaults
[0m17:30:30.161762 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.582 seconds
[0m17:30:30.164187 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b80d1c6-1107-40c6-815e-130888999b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a906e0>]}
[0m17:30:30.164541 [info ] [Thread-4 (]: 3 of 7 OK created sql table model dbt_maximerosa_marts.default_ratio_analysis .. [[32mSUCCESS 1[0m in 0.62s]
[0m17:30:30.164823 [debug] [Thread-4 (]: Finished running node model.sequra_analytics.default_ratio_analysis
[0m17:30:31.046641 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.157 seconds
[0m17:30:31.047896 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b80d1c6-1107-40c6-815e-130888999b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112593560>]}
[0m17:30:31.048242 [info ] [Thread-3 (]: 7 of 7 OK created sql table model dbt_maximerosa_marts.shopper_recurrence_rate . [[32mSUCCESS 1[0m in 1.16s]
[0m17:30:31.048529 [debug] [Thread-3 (]: Finished running node model.sequra_analytics.shopper_recurrence_rate
[0m17:30:31.049232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:31.049406 [debug] [MainThread]: Connection 'model.sequra_analytics.int_orders_with_defaults' was left open.
[0m17:30:31.049549 [debug] [MainThread]: On model.sequra_analytics.int_orders_with_defaults: Close
[0m17:30:31.145384 [debug] [MainThread]: Connection 'model.sequra_analytics.int_recurrent_shoppers' was left open.
[0m17:30:31.145703 [debug] [MainThread]: On model.sequra_analytics.int_recurrent_shoppers: Close
[0m17:30:31.270763 [debug] [MainThread]: Connection 'model.sequra_analytics.shopper_recurrence_rate' was left open.
[0m17:30:31.271049 [debug] [MainThread]: On model.sequra_analytics.shopper_recurrence_rate: Close
[0m17:30:31.362717 [debug] [MainThread]: Connection 'model.sequra_analytics.default_ratio_analysis' was left open.
[0m17:30:31.362987 [debug] [MainThread]: On model.sequra_analytics.default_ratio_analysis: Close
[0m17:30:31.449037 [info ] [MainThread]: 
[0m17:30:31.449340 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m17:30:31.450020 [debug] [MainThread]: Command end result
[0m17:30:31.463844 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/manifest.json
[0m17:30:31.465394 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/semantic_manifest.json
[0m17:30:31.469622 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/run_results.json
[0m17:30:31.469848 [info ] [MainThread]: 
[0m17:30:31.470078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:31.470235 [info ] [MainThread]: 
[0m17:30:31.470401 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m17:30:31.472256 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.383224, "process_in_blocks": "0", "process_kernel_time": 0.407059, "process_mem_max_rss": "177373184", "process_out_blocks": "0", "process_user_time": 1.698587}
[0m17:30:31.472541 [debug] [MainThread]: Command `dbt run` succeeded at 17:30:31.472489 after 8.38 seconds
[0m17:30:31.472778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dca720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0863f0>]}
[0m17:30:31.472972 [debug] [MainThread]: Flushing usage events
[0m17:30:31.944656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:34.018623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033ceae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540d700>]}


============================== 17:43:34.023827 | e822fa22-87ae-4f90-9a89-17ff575b837e ==============================
[0m17:43:34.023827 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:43:34.024307 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'partial_parse': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'log_path': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics/logs', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'empty': 'False', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/maximerosa/Downloads/sequra_test/sequra_analytics', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m17:43:34.444733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e822fa22-87ae-4f90-9a89-17ff575b837e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a57f20>]}
[0m17:43:34.476610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e822fa22-87ae-4f90-9a89-17ff575b837e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056aa9f0>]}
[0m17:43:34.478188 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:43:34.558825 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:43:34.712758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:43:34.713029 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:43:34.716419 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.sequra_analytics.orders_merchant.column_types
[0m17:43:34.739415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e822fa22-87ae-4f90-9a89-17ff575b837e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c4b90>]}
[0m17:43:34.784400 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/manifest.json
[0m17:43:34.786942 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/semantic_manifest.json
[0m17:43:34.804722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e822fa22-87ae-4f90-9a89-17ff575b837e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110082600>]}
[0m17:43:34.805051 [info ] [MainThread]: Found 7 models, 2 seeds, 11 data tests, 479 macros
[0m17:43:34.805319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e822fa22-87ae-4f90-9a89-17ff575b837e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df5c70>]}
[0m17:43:34.806462 [info ] [MainThread]: 
[0m17:43:34.806655 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:43:34.806798 [info ] [MainThread]: 
[0m17:43:34.807053 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:43:34.809642 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m17:43:34.810881 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m17:43:34.811220 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m17:43:34.901982 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m17:43:34.902332 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m17:43:34.902563 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m17:43:34.902744 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m17:43:34.902914 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m17:43:34.903069 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m17:43:34.903212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:34.903341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:34.903468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:37.592195 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.689 seconds
[0m17:43:37.598201 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.695 seconds
[0m17:43:37.631716 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.728 seconds
[0m17:43:37.633551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_staging)
[0m17:43:37.633900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_intermediate)
[0m17:43:37.640068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_marts)
[0m17:43:37.641487 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m17:43:37.641792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_raw_data'
[0m17:43:37.642990 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m17:43:37.644280 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m17:43:37.644491 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m17:43:37.645712 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m17:43:37.645932 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m17:43:37.646083 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m17:43:37.646835 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m17:43:37.647204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:37.747462 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.100 seconds
[0m17:43:37.749292 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.102 seconds
[0m17:43:37.750848 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.105 seconds
[0m17:43:39.967186 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.320 seconds
[0m17:43:39.970957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e822fa22-87ae-4f90-9a89-17ff575b837e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110198140>]}
[0m17:43:39.973913 [debug] [Thread-1 (]: Began running node model.sequra_analytics.stg_merchants
[0m17:43:39.974540 [debug] [Thread-2 (]: Began running node model.sequra_analytics.stg_orders
[0m17:43:39.974301 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt_maximerosa_staging.stg_merchants ............... [RUN]
[0m17:43:39.974869 [info ] [Thread-2 (]: 2 of 7 START sql view model dbt_maximerosa_staging.stg_orders .................. [RUN]
[0m17:43:39.975123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now model.sequra_analytics.stg_merchants)
[0m17:43:39.975320 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_intermediate, now model.sequra_analytics.stg_orders)
[0m17:43:39.975492 [debug] [Thread-1 (]: Began compiling node model.sequra_analytics.stg_merchants
[0m17:43:39.975664 [debug] [Thread-2 (]: Began compiling node model.sequra_analytics.stg_orders
[0m17:43:39.979991 [debug] [Thread-1 (]: Writing injected SQL for node "model.sequra_analytics.stg_merchants"
[0m17:43:39.981947 [debug] [Thread-2 (]: Writing injected SQL for node "model.sequra_analytics.stg_orders"
[0m17:43:39.984483 [debug] [Thread-1 (]: Began executing node model.sequra_analytics.stg_merchants
[0m17:43:39.991239 [debug] [Thread-2 (]: Began executing node model.sequra_analytics.stg_orders
[0m17:43:40.003282 [debug] [Thread-2 (]: Writing runtime sql for node "model.sequra_analytics.stg_orders"
[0m17:43:40.006987 [debug] [Thread-1 (]: Writing runtime sql for node "model.sequra_analytics.stg_merchants"
[0m17:43:40.009526 [debug] [Thread-1 (]: Using snowflake connection "model.sequra_analytics.stg_merchants"
[0m17:43:40.009759 [debug] [Thread-1 (]: On model.sequra_analytics.stg_merchants: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
  
  
  
  
  as (
    

select
    merchant_id,
    merchant_name
from SEQURA_DEV.dbt_maximerosa_raw_data.merchants
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_merchants"} */;
[0m17:43:40.011100 [debug] [Thread-2 (]: Using snowflake connection "model.sequra_analytics.stg_orders"
[0m17:43:40.011475 [debug] [Thread-2 (]: On model.sequra_analytics.stg_orders: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders
  
  
  
  
  as (
    

with source_data as (
    select
        order_id,
        shopper_id,
        merchant_id,
        order_date as order_date_raw,
        -- Parse the date format (d/m/yy or dd/mm/yy)
        case 
            when split_part(order_date, '/', 3) = '22' then '2022'
            when split_part(order_date, '/', 3) = '23' then '2023'
            else '20' || split_part(order_date, '/', 3)
        end || '-' ||
        lpad(split_part(order_date, '/', 2), 2, '0') || '-' ||
        lpad(split_part(order_date, '/', 1), 2, '0') as order_date_formatted
    from SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant
)

select
    order_id,
    shopper_id,
    merchant_id,
    order_date_raw,
    to_date(order_date_formatted, 'YYYY-MM-DD') as order_date,
    date_trunc('month', to_date(order_date_formatted, 'YYYY-MM-DD')) as order_month,
    to_char(to_date(order_date_formatted, 'YYYY-MM-DD'), 'YYYY-MM') as month_year
from source_data
where order_date_raw is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders"} */;
[0m17:43:40.216579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.206 seconds
[0m17:43:40.235106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e822fa22-87ae-4f90-9a89-17ff575b837e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f32ba0>]}
[0m17:43:40.235552 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dbt_maximerosa_staging.stg_merchants .......... [[32mSUCCESS 1[0m in 0.26s]
[0m17:43:40.235861 [debug] [Thread-1 (]: Finished running node model.sequra_analytics.stg_merchants
[0m17:43:40.269063 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m17:43:40.270390 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e822fa22-87ae-4f90-9a89-17ff575b837e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104387aa0>]}
[0m17:43:40.270732 [info ] [Thread-2 (]: 2 of 7 OK created sql view model dbt_maximerosa_staging.stg_orders ............. [[32mSUCCESS 1[0m in 0.30s]
[0m17:43:40.271016 [debug] [Thread-2 (]: Finished running node model.sequra_analytics.stg_orders
[0m17:43:40.271504 [debug] [Thread-4 (]: Began running node model.sequra_analytics.default_ratio_analysis
[0m17:43:40.271916 [info ] [Thread-4 (]: 3 of 7 START sql table model dbt_maximerosa_marts.default_ratio_analysis ....... [RUN]
[0m17:43:40.272130 [debug] [Thread-3 (]: Began running node model.sequra_analytics.int_monthly_shoppers
[0m17:43:40.272314 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_raw_data, now model.sequra_analytics.default_ratio_analysis)
[0m17:43:40.272474 [debug] [Thread-1 (]: Began running node model.sequra_analytics.int_orders_with_defaults
[0m17:43:40.272677 [info ] [Thread-3 (]: 4 of 7 START sql view model dbt_maximerosa_intermediate.int_monthly_shoppers ... [RUN]
[0m17:43:40.272904 [debug] [Thread-2 (]: Began running node model.sequra_analytics.int_recurrent_shoppers
[0m17:43:40.273084 [debug] [Thread-4 (]: Began compiling node model.sequra_analytics.default_ratio_analysis
[0m17:43:40.273292 [info ] [Thread-1 (]: 5 of 7 START sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [RUN]
[0m17:43:40.273489 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now model.sequra_analytics.int_monthly_shoppers)
[0m17:43:40.273714 [info ] [Thread-2 (]: 6 of 7 START sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers . [RUN]
[0m17:43:40.275955 [debug] [Thread-4 (]: Writing injected SQL for node "model.sequra_analytics.default_ratio_analysis"
[0m17:43:40.276186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_merchants, now model.sequra_analytics.int_orders_with_defaults)
[0m17:43:40.276363 [debug] [Thread-3 (]: Began compiling node model.sequra_analytics.int_monthly_shoppers
[0m17:43:40.276522 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders, now model.sequra_analytics.int_recurrent_shoppers)
[0m17:43:40.276769 [debug] [Thread-1 (]: Began compiling node model.sequra_analytics.int_orders_with_defaults
[0m17:43:40.279740 [debug] [Thread-3 (]: Writing injected SQL for node "model.sequra_analytics.int_monthly_shoppers"
[0m17:43:40.280040 [debug] [Thread-2 (]: Began compiling node model.sequra_analytics.int_recurrent_shoppers
[0m17:43:40.281708 [debug] [Thread-1 (]: Writing injected SQL for node "model.sequra_analytics.int_orders_with_defaults"
[0m17:43:40.281980 [debug] [Thread-4 (]: Began executing node model.sequra_analytics.default_ratio_analysis
[0m17:43:40.283671 [debug] [Thread-2 (]: Writing injected SQL for node "model.sequra_analytics.int_recurrent_shoppers"
[0m17:43:40.296364 [debug] [Thread-4 (]: Writing runtime sql for node "model.sequra_analytics.default_ratio_analysis"
[0m17:43:40.296775 [debug] [Thread-3 (]: Began executing node model.sequra_analytics.int_monthly_shoppers
[0m17:43:40.298140 [debug] [Thread-3 (]: Writing runtime sql for node "model.sequra_analytics.int_monthly_shoppers"
[0m17:43:40.298417 [debug] [Thread-1 (]: Began executing node model.sequra_analytics.int_orders_with_defaults
[0m17:43:40.299744 [debug] [Thread-1 (]: Writing runtime sql for node "model.sequra_analytics.int_orders_with_defaults"
[0m17:43:40.300027 [debug] [Thread-2 (]: Began executing node model.sequra_analytics.int_recurrent_shoppers
[0m17:43:40.301346 [debug] [Thread-2 (]: Writing runtime sql for node "model.sequra_analytics.int_recurrent_shoppers"
[0m17:43:40.301855 [debug] [Thread-3 (]: Using snowflake connection "model.sequra_analytics.int_monthly_shoppers"
[0m17:43:40.303197 [debug] [Thread-4 (]: Using snowflake connection "model.sequra_analytics.default_ratio_analysis"
[0m17:43:40.303403 [debug] [Thread-3 (]: On model.sequra_analytics.int_monthly_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers
  
  
  
  
  as (
    

with monthly_orders as (
    select distinct
        order_month,
        month_year,
        merchant_id,
        shopper_id
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
)

select
    order_month,
    month_year,
    merchant_id,
    shopper_id,
    -- Flag if this shopper made a purchase with this merchant in the current month
    1 as made_purchase_current_month
from monthly_orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_monthly_shoppers"} */;
[0m17:43:40.304119 [debug] [Thread-1 (]: Using snowflake connection "model.sequra_analytics.int_orders_with_defaults"
[0m17:43:40.304410 [debug] [Thread-4 (]: On model.sequra_analytics.default_ratio_analysis: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.default_ratio_analysis
    
    
    
    as (

-- This model calculates the default ratio as requested in Part 2

with orders_with_defaults as (
    -- This would come from the actual orders table with financial data
    select
        o.*,
        m.merchant_name as merchant,
        -- These fields would come from the actual source data:
        null::integer as shopper_age,
        null::varchar as product,
        null::boolean as is_in_default,
        null::integer as days_unbalanced,
        null::decimal(15,2) as current_order_value,
        null::decimal(15,2) as overdue_amount
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
),

-- Calculate delayed periods based on days_unbalanced
-- An order with 35 days unbalanced is included in both 17 and 30 day calculations
delayed_period_17 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '17' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 17
        and is_in_default = true
),

delayed_period_30 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '30' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 30
        and is_in_default = true
),

delayed_period_60 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '60' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 60
        and is_in_default = true
),

delayed_period_90 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '90' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 90
        and is_in_default = true
),

-- Union all delayed periods
all_defaults as (
    select * from delayed_period_17
    union all
    select * from delayed_period_30
    union all
    select * from delayed_period_60
    union all
    select * from delayed_period_90
)

-- Final output with the exact columns requested
select
    shopper_age,
    month_year_order,
    product,
    merchant,
    default_type,
    delayed_period
from all_defaults
order by 
    month_year_order,
    merchant,
    delayed_period::integer
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.default_ratio_analysis"} */;
[0m17:43:40.304914 [debug] [Thread-1 (]: On model.sequra_analytics.int_orders_with_defaults: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
  
  
  
  
  as (
    

-- Placeholder for Part 2 of the challenge
-- This would contain the logic for calculating default ratios
-- when the additional data tables are available

with orders_base as (
    select
        o.*,
        m.merchant_name,
        -- Placeholder fields for default calculation
        -- These would come from the actual orders table with financial data
        null::boolean as is_in_default,
        null::integer as days_unbalanced,
        null::decimal(15,2) as current_order_value,
        null::decimal(15,2) as overdue_amount,
        null::varchar as product,
        null::integer as shopper_age
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
)

select
    *,
    case
        when days_unbalanced > 90 then '90+'
        when days_unbalanced > 60 then '60'
        when days_unbalanced > 30 then '30'
        when days_unbalanced > 17 then '17'
        else null
    end as delayed_period
from orders_base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_orders_with_defaults"} */;
[0m17:43:40.306596 [debug] [Thread-2 (]: Using snowflake connection "model.sequra_analytics.int_recurrent_shoppers"
[0m17:43:40.306924 [debug] [Thread-2 (]: On model.sequra_analytics.int_recurrent_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers
  
  
  
  
  as (
    

with order_history as (
    select
        o1.order_month as current_month,
        o1.month_year as current_month_year,
        o1.merchant_id,
        o1.shopper_id,
        count(distinct o2.order_month) as months_with_purchases
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o1
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_orders o2
        on o1.merchant_id = o2.merchant_id
        and o1.shopper_id = o2.shopper_id
        and o2.order_date between dateadd(month, -11, o1.order_month) and last_day(o1.order_month)
        and o2.order_month <= o1.order_month
    group by 1, 2, 3, 4
)

select
    current_month,
    current_month_year,
    merchant_id,
    shopper_id,
    months_with_purchases,
    -- A shopper is recurrent if they have made purchases in at least 2 different months
    -- within the 12-month window including the current month
    case 
        when months_with_purchases >= 2 then 1 
        else 0 
    end as is_recurrent
from order_history
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_recurrent_shoppers"} */;
[0m17:43:40.590783 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.286 seconds
[0m17:43:40.594729 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e822fa22-87ae-4f90-9a89-17ff575b837e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12078c9e0>]}
[0m17:43:40.595133 [info ] [Thread-3 (]: 4 of 7 OK created sql view model dbt_maximerosa_intermediate.int_monthly_shoppers  [[32mSUCCESS 1[0m in 0.32s]
[0m17:43:40.595419 [debug] [Thread-3 (]: Finished running node model.sequra_analytics.int_monthly_shoppers
[0m17:43:40.604097 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m17:43:40.605182 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e822fa22-87ae-4f90-9a89-17ff575b837e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12076ffb0>]}
[0m17:43:40.605716 [info ] [Thread-2 (]: 6 of 7 OK created sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers  [[32mSUCCESS 1[0m in 0.33s]
[0m17:43:40.606025 [debug] [Thread-2 (]: Finished running node model.sequra_analytics.int_recurrent_shoppers
[0m17:43:40.606358 [debug] [Thread-3 (]: Began running node model.sequra_analytics.shopper_recurrence_rate
[0m17:43:40.606675 [info ] [Thread-3 (]: 7 of 7 START sql table model dbt_maximerosa_marts.shopper_recurrence_rate ...... [RUN]
[0m17:43:40.606930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_monthly_shoppers, now model.sequra_analytics.shopper_recurrence_rate)
[0m17:43:40.607110 [debug] [Thread-3 (]: Began compiling node model.sequra_analytics.shopper_recurrence_rate
[0m17:43:40.609378 [debug] [Thread-3 (]: Writing injected SQL for node "model.sequra_analytics.shopper_recurrence_rate"
[0m17:43:40.610148 [debug] [Thread-3 (]: Began executing node model.sequra_analytics.shopper_recurrence_rate
[0m17:43:40.612421 [debug] [Thread-3 (]: Writing runtime sql for node "model.sequra_analytics.shopper_recurrence_rate"
[0m17:43:40.615959 [debug] [Thread-3 (]: Using snowflake connection "model.sequra_analytics.shopper_recurrence_rate"
[0m17:43:40.616167 [debug] [Thread-3 (]: On model.sequra_analytics.shopper_recurrence_rate: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
    
    
    
    as (

with monthly_metrics as (
    select
        ms.order_month,
        ms.month_year,
        ms.merchant_id,
        m.merchant_name,
        count(distinct ms.shopper_id) as total_shoppers,
        sum(rs.is_recurrent) as recurrent_shoppers
    from SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers ms
    left join SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers rs
        on ms.order_month = rs.current_month
        and ms.merchant_id = rs.merchant_id
        and ms.shopper_id = rs.shopper_id
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on ms.merchant_id = m.merchant_id
    group by 1, 2, 3, 4
)

select
    merchant_name,
    month_year as month,
    round(
        case 
            when total_shoppers > 0 
            then (recurrent_shoppers::decimal / total_shoppers) * 100
            else 0 
        end, 2
    ) as recurrence_rate
from monthly_metrics
order by merchant_name, month
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.shopper_recurrence_rate"} */;
[0m17:43:40.682601 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.377 seconds
[0m17:43:40.685078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e822fa22-87ae-4f90-9a89-17ff575b837e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120787f50>]}
[0m17:43:40.685517 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [[32mSUCCESS 1[0m in 0.41s]
[0m17:43:40.685820 [debug] [Thread-1 (]: Finished running node model.sequra_analytics.int_orders_with_defaults
[0m17:43:41.216088 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.911 seconds
[0m17:43:41.217280 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e822fa22-87ae-4f90-9a89-17ff575b837e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120790950>]}
[0m17:43:41.217607 [info ] [Thread-4 (]: 3 of 7 OK created sql table model dbt_maximerosa_marts.default_ratio_analysis .. [[32mSUCCESS 1[0m in 0.94s]
[0m17:43:41.217886 [debug] [Thread-4 (]: Finished running node model.sequra_analytics.default_ratio_analysis
[0m17:43:41.884091 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.268 seconds
[0m17:43:41.885364 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e822fa22-87ae-4f90-9a89-17ff575b837e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207b30e0>]}
[0m17:43:41.885714 [info ] [Thread-3 (]: 7 of 7 OK created sql table model dbt_maximerosa_marts.shopper_recurrence_rate . [[32mSUCCESS 1[0m in 1.28s]
[0m17:43:41.886001 [debug] [Thread-3 (]: Finished running node model.sequra_analytics.shopper_recurrence_rate
[0m17:43:41.886681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:41.886863 [debug] [MainThread]: Connection 'model.sequra_analytics.int_orders_with_defaults' was left open.
[0m17:43:41.887016 [debug] [MainThread]: On model.sequra_analytics.int_orders_with_defaults: Close
[0m17:43:41.972959 [debug] [MainThread]: Connection 'model.sequra_analytics.int_recurrent_shoppers' was left open.
[0m17:43:41.973343 [debug] [MainThread]: On model.sequra_analytics.int_recurrent_shoppers: Close
[0m17:43:42.064849 [debug] [MainThread]: Connection 'model.sequra_analytics.shopper_recurrence_rate' was left open.
[0m17:43:42.065115 [debug] [MainThread]: On model.sequra_analytics.shopper_recurrence_rate: Close
[0m17:43:42.150594 [debug] [MainThread]: Connection 'model.sequra_analytics.default_ratio_analysis' was left open.
[0m17:43:42.150833 [debug] [MainThread]: On model.sequra_analytics.default_ratio_analysis: Close
[0m17:43:42.234643 [info ] [MainThread]: 
[0m17:43:42.234927 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 7.43 seconds (7.43s).
[0m17:43:42.235617 [debug] [MainThread]: Command end result
[0m17:43:42.250190 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/manifest.json
[0m17:43:42.252373 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/semantic_manifest.json
[0m17:43:42.256994 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/sequra_test/sequra_analytics/target/run_results.json
[0m17:43:42.257183 [info ] [MainThread]: 
[0m17:43:42.257375 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:43:42.257521 [info ] [MainThread]: 
[0m17:43:42.257674 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m17:43:42.259535 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.2860775, "process_in_blocks": "0", "process_kernel_time": 0.450842, "process_mem_max_rss": "178552832", "process_out_blocks": "0", "process_user_time": 1.609883}
[0m17:43:42.259805 [debug] [MainThread]: Command `dbt run` succeeded at 17:43:42.259757 after 8.29 seconds
[0m17:43:42.259987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f5850>]}
[0m17:43:42.260165 [debug] [MainThread]: Flushing usage events
[0m17:43:42.705511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:33:52.766547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d1d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d1d280>]}


============================== 18:33:52.770723 | 2f94da49-ccb5-4e5b-b071-6498c3b0d51f ==============================
[0m18:33:52.770723 [info ] [MainThread]: Running with dbt=1.10.9
[0m18:33:52.771110 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'empty': 'None'}
[0m18:33:52.790212 [info ] [MainThread]: dbt version: 1.10.9
[0m18:33:52.790480 [info ] [MainThread]: python version: 3.12.7
[0m18:33:52.790628 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
[0m18:33:52.790799 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m18:33:53.392056 [info ] [MainThread]: Using profiles dir at /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics
[0m18:33:53.392370 [info ] [MainThread]: Using profiles.yml file at /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/profiles.yml
[0m18:33:53.392520 [info ] [MainThread]: Using dbt_project.yml file at /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/dbt_project.yml
[0m18:33:53.393191 [info ] [MainThread]: adapter type: snowflake
[0m18:33:53.393330 [info ] [MainThread]: adapter version: 1.10.0
[0m18:33:53.464301 [info ] [MainThread]: Configuration:
[0m18:33:53.464596 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:33:53.464756 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:33:53.464894 [info ] [MainThread]: Required dependencies:
[0m18:33:53.465433 [debug] [MainThread]: Executing "git --help"
[0m18:33:53.485948 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:33:53.486747 [debug] [MainThread]: STDERR: "b''"
[0m18:33:53.486991 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:33:53.487202 [info ] [MainThread]: Connection:
[0m18:33:53.487395 [info ] [MainThread]:   account: lqgtqud-rv87386
[0m18:33:53.487526 [info ] [MainThread]:   user: maximerosa
[0m18:33:53.487648 [info ] [MainThread]:   database: SEQURA_DEV
[0m18:33:53.487765 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m18:33:53.487876 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m18:33:53.487989 [info ] [MainThread]:   schema: dbt_maximerosa
[0m18:33:53.488111 [info ] [MainThread]:   authenticator: None
[0m18:33:53.488222 [info ] [MainThread]:   oauth_client_id: None
[0m18:33:53.488335 [info ] [MainThread]:   query_tag: None
[0m18:33:53.488444 [info ] [MainThread]:   client_session_keep_alive: True
[0m18:33:53.488555 [info ] [MainThread]:   host: None
[0m18:33:53.488666 [info ] [MainThread]:   port: None
[0m18:33:53.488779 [info ] [MainThread]:   proxy_host: None
[0m18:33:53.488897 [info ] [MainThread]:   proxy_port: None
[0m18:33:53.489004 [info ] [MainThread]:   protocol: None
[0m18:33:53.489117 [info ] [MainThread]:   connect_retries: 1
[0m18:33:53.489298 [info ] [MainThread]:   connect_timeout: None
[0m18:33:53.489533 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:33:53.489680 [info ] [MainThread]:   retry_all: False
[0m18:33:53.489803 [info ] [MainThread]:   insecure_mode: False
[0m18:33:53.489924 [info ] [MainThread]:   reuse_connections: None
[0m18:33:53.490054 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m18:33:53.490530 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:33:53.566599 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:33:53.630605 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:33:53.630851 [debug] [MainThread]: On debug: select 1 as id
[0m18:33:53.630994 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:56.875804 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.245 seconds
[0m18:33:56.877152 [debug] [MainThread]: On debug: Close
[0m18:33:56.965651 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:33:56.966279 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:33:56.970324 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.258641, "process_in_blocks": "0", "process_kernel_time": 0.302794, "process_mem_max_rss": "158711808", "process_out_blocks": "0", "process_user_time": 1.265809}
[0m18:33:56.970885 [debug] [MainThread]: Command `dbt debug` succeeded at 18:33:56.970773 after 4.26 seconds
[0m18:33:56.971247 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:33:56.971595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117f49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123311c0>]}
[0m18:33:56.972043 [debug] [MainThread]: Flushing usage events
[0m18:33:57.377818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:03.132635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098535c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a011bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a011880>]}


============================== 18:34:03.136702 | 482fb428-f034-48db-86a9-31ae4fdadbdb ==============================
[0m18:34:03.136702 [info ] [MainThread]: Running with dbt=1.10.9
[0m18:34:03.137037 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'empty': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'partial_parse': 'True', 'quiet': 'False', 'target_path': 'None', 'invocation_command': 'dbt run', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'printer_width': '80', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics', 'use_experimental_parser': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None'}
[0m18:34:03.484678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '482fb428-f034-48db-86a9-31ae4fdadbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c127bf0>]}
[0m18:34:03.518564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '482fb428-f034-48db-86a9-31ae4fdadbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd7800>]}
[0m18:34:03.519563 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:34:03.590215 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m18:34:03.735515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:03.735776 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:03.738766 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.sequra_analytics.orders_merchant.column_types
[0m18:34:03.760977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '482fb428-f034-48db-86a9-31ae4fdadbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c466900>]}
[0m18:34:03.804126 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m18:34:03.805735 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m18:34:03.828368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '482fb428-f034-48db-86a9-31ae4fdadbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52e4b0>]}
[0m18:34:03.828698 [info ] [MainThread]: Found 7 models, 2 seeds, 11 data tests, 479 macros
[0m18:34:03.828865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '482fb428-f034-48db-86a9-31ae4fdadbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bff3860>]}
[0m18:34:03.829901 [info ] [MainThread]: 
[0m18:34:03.830080 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:34:03.830217 [info ] [MainThread]: 
[0m18:34:03.830461 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:34:03.832909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m18:34:03.840546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m18:34:03.842099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m18:34:03.904456 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m18:34:03.904804 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m18:34:03.904992 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m18:34:03.905238 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m18:34:03.905428 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m18:34:03.905660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:03.905851 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m18:34:03.906002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:03.906238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:06.398437 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.492 seconds
[0m18:34:06.399233 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.493 seconds
[0m18:34:06.400798 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m18:34:06.402045 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m18:34:06.599071 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.693 seconds
[0m18:34:06.601611 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m18:34:06.680172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_staging)
[0m18:34:06.680855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_intermediate)
[0m18:34:06.682573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_marts)
[0m18:34:06.683362 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_raw_data'
[0m18:34:06.697707 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m18:34:06.699537 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m18:34:06.701422 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m18:34:06.703225 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m18:34:06.703518 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m18:34:06.703785 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m18:34:06.704037 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m18:34:06.704277 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m18:34:06.704508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:06.704721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:06.704922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:06.705129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:09.041327 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.336 seconds
[0m18:34:09.043647 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: Close
[0m18:34:09.045699 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.341 seconds
[0m18:34:09.047565 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: Close
[0m18:34:09.149122 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.444 seconds
[0m18:34:09.151348 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: Close
[0m18:34:09.194357 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.490 seconds
[0m18:34:09.196436 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m18:34:09.292577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '482fb428-f034-48db-86a9-31ae4fdadbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c95cbf0>]}
[0m18:34:09.315216 [debug] [Thread-8 (]: Began running node model.sequra_analytics.stg_merchants
[0m18:34:09.315947 [debug] [Thread-9 (]: Began running node model.sequra_analytics.stg_orders
[0m18:34:09.316603 [info ] [Thread-8 (]: 1 of 7 START sql view model dbt_maximerosa_staging.stg_merchants ............... [RUN]
[0m18:34:09.317369 [info ] [Thread-9 (]: 2 of 7 START sql view model dbt_maximerosa_staging.stg_orders .................. [RUN]
[0m18:34:09.318134 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now model.sequra_analytics.stg_merchants)
[0m18:34:09.318951 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_intermediate, now model.sequra_analytics.stg_orders)
[0m18:34:09.319584 [debug] [Thread-8 (]: Began compiling node model.sequra_analytics.stg_merchants
[0m18:34:09.320053 [debug] [Thread-9 (]: Began compiling node model.sequra_analytics.stg_orders
[0m18:34:09.329585 [debug] [Thread-8 (]: Writing injected SQL for node "model.sequra_analytics.stg_merchants"
[0m18:34:09.332814 [debug] [Thread-9 (]: Writing injected SQL for node "model.sequra_analytics.stg_orders"
[0m18:34:09.336427 [debug] [Thread-9 (]: Began executing node model.sequra_analytics.stg_orders
[0m18:34:09.336890 [debug] [Thread-8 (]: Began executing node model.sequra_analytics.stg_merchants
[0m18:34:09.374706 [debug] [Thread-9 (]: Writing runtime sql for node "model.sequra_analytics.stg_orders"
[0m18:34:09.376376 [debug] [Thread-8 (]: Writing runtime sql for node "model.sequra_analytics.stg_merchants"
[0m18:34:09.378216 [debug] [Thread-9 (]: Using snowflake connection "model.sequra_analytics.stg_orders"
[0m18:34:09.378620 [debug] [Thread-8 (]: Using snowflake connection "model.sequra_analytics.stg_merchants"
[0m18:34:09.378868 [debug] [Thread-9 (]: On model.sequra_analytics.stg_orders: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders
  
  
  
  
  as (
    

with source_data as (
    select
        order_id,
        shopper_id,
        merchant_id,
        order_date as order_date_raw,
        -- Parse the date format (d/m/yy or dd/mm/yy)
        case 
            when split_part(order_date, '/', 3) = '22' then '2022'
            when split_part(order_date, '/', 3) = '23' then '2023'
            else '20' || split_part(order_date, '/', 3)
        end || '-' ||
        lpad(split_part(order_date, '/', 2), 2, '0') || '-' ||
        lpad(split_part(order_date, '/', 1), 2, '0') as order_date_formatted
    from SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant
)

select
    order_id,
    shopper_id,
    merchant_id,
    order_date_raw,
    to_date(order_date_formatted, 'YYYY-MM-DD') as order_date,
    date_trunc('month', to_date(order_date_formatted, 'YYYY-MM-DD')) as order_month,
    to_char(to_date(order_date_formatted, 'YYYY-MM-DD'), 'YYYY-MM') as month_year
from source_data
where order_date_raw is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders"} */;
[0m18:34:09.379109 [debug] [Thread-8 (]: On model.sequra_analytics.stg_merchants: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
  
  
  
  
  as (
    

select
    merchant_id,
    merchant_name
from SEQURA_DEV.dbt_maximerosa_raw_data.merchants
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_merchants"} */;
[0m18:34:09.379294 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m18:34:09.379463 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m18:34:11.931395 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.551 seconds
[0m18:34:11.939700 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.560 seconds
[0m18:34:11.963405 [debug] [Thread-9 (]: On model.sequra_analytics.stg_orders: Close
[0m18:34:11.965064 [debug] [Thread-8 (]: On model.sequra_analytics.stg_merchants: Close
[0m18:34:12.042948 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482fb428-f034-48db-86a9-31ae4fdadbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fcb8c0>]}
[0m18:34:12.043779 [info ] [Thread-9 (]: 2 of 7 OK created sql view model dbt_maximerosa_staging.stg_orders ............. [[32mSUCCESS 1[0m in 2.72s]
[0m18:34:12.044395 [debug] [Thread-9 (]: Finished running node model.sequra_analytics.stg_orders
[0m18:34:12.044937 [debug] [Thread-11 ]: Began running node model.sequra_analytics.int_monthly_shoppers
[0m18:34:12.045280 [debug] [Thread-10 ]: Began running node model.sequra_analytics.int_recurrent_shoppers
[0m18:34:12.045710 [info ] [Thread-11 ]: 3 of 7 START sql view model dbt_maximerosa_intermediate.int_monthly_shoppers ... [RUN]
[0m18:34:12.046129 [info ] [Thread-10 ]: 4 of 7 START sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers . [RUN]
[0m18:34:12.046548 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_raw_data, now model.sequra_analytics.int_monthly_shoppers)
[0m18:34:12.046887 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now model.sequra_analytics.int_recurrent_shoppers)
[0m18:34:12.047220 [debug] [Thread-11 ]: Began compiling node model.sequra_analytics.int_monthly_shoppers
[0m18:34:12.047515 [debug] [Thread-10 ]: Began compiling node model.sequra_analytics.int_recurrent_shoppers
[0m18:34:12.052214 [debug] [Thread-11 ]: Writing injected SQL for node "model.sequra_analytics.int_monthly_shoppers"
[0m18:34:12.055014 [debug] [Thread-10 ]: Writing injected SQL for node "model.sequra_analytics.int_recurrent_shoppers"
[0m18:34:12.057332 [debug] [Thread-10 ]: Began executing node model.sequra_analytics.int_recurrent_shoppers
[0m18:34:12.059768 [debug] [Thread-10 ]: Writing runtime sql for node "model.sequra_analytics.int_recurrent_shoppers"
[0m18:34:12.060434 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482fb428-f034-48db-86a9-31ae4fdadbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9a1670>]}
[0m18:34:12.060850 [debug] [Thread-11 ]: Began executing node model.sequra_analytics.int_monthly_shoppers
[0m18:34:12.063320 [debug] [Thread-11 ]: Writing runtime sql for node "model.sequra_analytics.int_monthly_shoppers"
[0m18:34:12.061424 [info ] [Thread-8 (]: 1 of 7 OK created sql view model dbt_maximerosa_staging.stg_merchants .......... [[32mSUCCESS 1[0m in 2.74s]
[0m18:34:12.063914 [debug] [Thread-8 (]: Finished running node model.sequra_analytics.stg_merchants
[0m18:34:12.064963 [debug] [Thread-10 ]: Using snowflake connection "model.sequra_analytics.int_recurrent_shoppers"
[0m18:34:12.065395 [debug] [Thread-10 ]: On model.sequra_analytics.int_recurrent_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers
  
  
  
  
  as (
    

with order_history as (
    select
        o1.order_month as current_month,
        o1.month_year as current_month_year,
        o1.merchant_id,
        o1.shopper_id,
        count(distinct o2.order_month) as months_with_purchases
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o1
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_orders o2
        on o1.merchant_id = o2.merchant_id
        and o1.shopper_id = o2.shopper_id
        and o2.order_date between dateadd(month, -11, o1.order_month) and last_day(o1.order_month)
        and o2.order_month <= o1.order_month
    group by 1, 2, 3, 4
)

select
    current_month,
    current_month_year,
    merchant_id,
    shopper_id,
    months_with_purchases,
    -- A shopper is recurrent if they have made purchases in at least 2 different months
    -- within the 12-month window including the current month
    case 
        when months_with_purchases >= 2 then 1 
        else 0 
    end as is_recurrent
from order_history
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_recurrent_shoppers"} */;
[0m18:34:12.065772 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m18:34:12.066073 [debug] [Thread-9 (]: Began running node model.sequra_analytics.default_ratio_analysis
[0m18:34:12.066630 [debug] [Thread-8 (]: Began running node model.sequra_analytics.int_orders_with_defaults
[0m18:34:12.066413 [info ] [Thread-9 (]: 5 of 7 START sql table model dbt_maximerosa_marts.default_ratio_analysis ....... [RUN]
[0m18:34:12.067481 [info ] [Thread-8 (]: 6 of 7 START sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [RUN]
[0m18:34:12.068040 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders, now model.sequra_analytics.default_ratio_analysis)
[0m18:34:12.068406 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_merchants, now model.sequra_analytics.int_orders_with_defaults)
[0m18:34:12.069059 [debug] [Thread-9 (]: Began compiling node model.sequra_analytics.default_ratio_analysis
[0m18:34:12.069483 [debug] [Thread-8 (]: Began compiling node model.sequra_analytics.int_orders_with_defaults
[0m18:34:12.072063 [debug] [Thread-9 (]: Writing injected SQL for node "model.sequra_analytics.default_ratio_analysis"
[0m18:34:12.074528 [debug] [Thread-8 (]: Writing injected SQL for node "model.sequra_analytics.int_orders_with_defaults"
[0m18:34:12.075458 [debug] [Thread-11 ]: Using snowflake connection "model.sequra_analytics.int_monthly_shoppers"
[0m18:34:12.076062 [debug] [Thread-11 ]: On model.sequra_analytics.int_monthly_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers
  
  
  
  
  as (
    

with monthly_orders as (
    select distinct
        order_month,
        month_year,
        merchant_id,
        shopper_id
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
)

select
    order_month,
    month_year,
    merchant_id,
    shopper_id,
    -- Flag if this shopper made a purchase with this merchant in the current month
    1 as made_purchase_current_month
from monthly_orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_monthly_shoppers"} */;
[0m18:34:12.076496 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m18:34:12.076947 [debug] [Thread-9 (]: Began executing node model.sequra_analytics.default_ratio_analysis
[0m18:34:12.078465 [debug] [Thread-8 (]: Began executing node model.sequra_analytics.int_orders_with_defaults
[0m18:34:12.092728 [debug] [Thread-8 (]: Writing runtime sql for node "model.sequra_analytics.int_orders_with_defaults"
[0m18:34:12.095874 [debug] [Thread-9 (]: Writing runtime sql for node "model.sequra_analytics.default_ratio_analysis"
[0m18:34:12.105334 [debug] [Thread-9 (]: Using snowflake connection "model.sequra_analytics.default_ratio_analysis"
[0m18:34:12.106471 [debug] [Thread-8 (]: Using snowflake connection "model.sequra_analytics.int_orders_with_defaults"
[0m18:34:12.107864 [debug] [Thread-9 (]: On model.sequra_analytics.default_ratio_analysis: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.default_ratio_analysis
    
    
    
    as (

-- This model calculates the default ratio as requested in Part 2

with orders_with_defaults as (
    -- This would come from the actual orders table with financial data
    select
        o.*,
        m.merchant_name as merchant,
        -- These fields would come from the actual source data:
        null::integer as shopper_age,
        null::varchar as product,
        null::boolean as is_in_default,
        null::integer as days_unbalanced,
        null::decimal(15,2) as current_order_value,
        null::decimal(15,2) as overdue_amount
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
),

-- Calculate delayed periods based on days_unbalanced
-- An order with 35 days unbalanced is included in both 17 and 30 day calculations
delayed_period_17 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '17' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 17
        and is_in_default = true
),

delayed_period_30 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '30' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 30
        and is_in_default = true
),

delayed_period_60 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '60' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 60
        and is_in_default = true
),

delayed_period_90 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '90' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 90
        and is_in_default = true
),

-- Union all delayed periods
all_defaults as (
    select * from delayed_period_17
    union all
    select * from delayed_period_30
    union all
    select * from delayed_period_60
    union all
    select * from delayed_period_90
)

-- Final output with the exact columns requested
select
    shopper_age,
    month_year_order,
    product,
    merchant,
    default_type,
    delayed_period
from all_defaults
order by 
    month_year_order,
    merchant,
    delayed_period::integer
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.default_ratio_analysis"} */;
[0m18:34:12.108688 [debug] [Thread-8 (]: On model.sequra_analytics.int_orders_with_defaults: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
  
  
  
  
  as (
    

-- Placeholder for Part 2 of the challenge
-- This would contain the logic for calculating default ratios
-- when the additional data tables are available

with orders_base as (
    select
        o.*,
        m.merchant_name,
        -- Placeholder fields for default calculation
        -- These would come from the actual orders table with financial data
        null::boolean as is_in_default,
        null::integer as days_unbalanced,
        null::decimal(15,2) as current_order_value,
        null::decimal(15,2) as overdue_amount,
        null::varchar as product,
        null::integer as shopper_age
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
)

select
    *,
    case
        when days_unbalanced > 90 then '90+'
        when days_unbalanced > 60 then '60'
        when days_unbalanced > 30 then '30'
        when days_unbalanced > 17 then '17'
        else null
    end as delayed_period
from orders_base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_orders_with_defaults"} */;
[0m18:34:12.109009 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m18:34:12.109280 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m18:34:14.694590 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.629 seconds
[0m18:34:14.695701 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.619 seconds
[0m18:34:14.698131 [debug] [Thread-10 ]: On model.sequra_analytics.int_recurrent_shoppers: Close
[0m18:34:14.700658 [debug] [Thread-11 ]: On model.sequra_analytics.int_monthly_shoppers: Close
[0m18:34:14.701304 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.592 seconds
[0m18:34:14.705472 [debug] [Thread-8 (]: On model.sequra_analytics.int_orders_with_defaults: Close
[0m18:34:14.784466 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482fb428-f034-48db-86a9-31ae4fdadbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128e10500>]}
[0m18:34:14.785706 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482fb428-f034-48db-86a9-31ae4fdadbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128e7fcb0>]}
[0m18:34:14.786177 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482fb428-f034-48db-86a9-31ae4fdadbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106610860>]}
[0m18:34:14.786748 [info ] [Thread-8 (]: 6 of 7 OK created sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [[32mSUCCESS 1[0m in 2.72s]
[0m18:34:14.787226 [info ] [Thread-10 ]: 4 of 7 OK created sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers  [[32mSUCCESS 1[0m in 2.74s]
[0m18:34:14.788090 [debug] [Thread-8 (]: Finished running node model.sequra_analytics.int_orders_with_defaults
[0m18:34:14.787627 [info ] [Thread-11 ]: 3 of 7 OK created sql view model dbt_maximerosa_intermediate.int_monthly_shoppers  [[32mSUCCESS 1[0m in 2.74s]
[0m18:34:14.788625 [debug] [Thread-10 ]: Finished running node model.sequra_analytics.int_recurrent_shoppers
[0m18:34:14.789143 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.int_monthly_shoppers
[0m18:34:14.789711 [debug] [Thread-8 (]: Began running node model.sequra_analytics.shopper_recurrence_rate
[0m18:34:14.790094 [info ] [Thread-8 (]: 7 of 7 START sql table model dbt_maximerosa_marts.shopper_recurrence_rate ...... [RUN]
[0m18:34:14.790478 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_orders_with_defaults, now model.sequra_analytics.shopper_recurrence_rate)
[0m18:34:14.790781 [debug] [Thread-8 (]: Began compiling node model.sequra_analytics.shopper_recurrence_rate
[0m18:34:14.795073 [debug] [Thread-8 (]: Writing injected SQL for node "model.sequra_analytics.shopper_recurrence_rate"
[0m18:34:14.796427 [debug] [Thread-8 (]: Began executing node model.sequra_analytics.shopper_recurrence_rate
[0m18:34:14.799419 [debug] [Thread-8 (]: Writing runtime sql for node "model.sequra_analytics.shopper_recurrence_rate"
[0m18:34:14.803254 [debug] [Thread-8 (]: Using snowflake connection "model.sequra_analytics.shopper_recurrence_rate"
[0m18:34:14.803825 [debug] [Thread-8 (]: On model.sequra_analytics.shopper_recurrence_rate: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
    
    
    
    as (

with monthly_metrics as (
    select
        ms.order_month,
        ms.month_year,
        ms.merchant_id,
        m.merchant_name,
        count(distinct ms.shopper_id) as total_shoppers,
        sum(rs.is_recurrent) as recurrent_shoppers
    from SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers ms
    left join SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers rs
        on ms.order_month = rs.current_month
        and ms.merchant_id = rs.merchant_id
        and ms.shopper_id = rs.shopper_id
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on ms.merchant_id = m.merchant_id
    group by 1, 2, 3, 4
)

select
    merchant_name,
    month_year as month,
    round(
        case 
            when total_shoppers > 0 
            then (recurrent_shoppers::decimal / total_shoppers) * 100
            else 0 
        end, 2
    ) as recurrence_rate
from monthly_metrics
order by merchant_name, month
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.shopper_recurrence_rate"} */;
[0m18:34:14.804176 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m18:34:15.409992 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 3.301 seconds
[0m18:34:15.412032 [debug] [Thread-9 (]: On model.sequra_analytics.default_ratio_analysis: Close
[0m18:34:15.478458 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482fb428-f034-48db-86a9-31ae4fdadbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9a0740>]}
[0m18:34:15.479107 [info ] [Thread-9 (]: 5 of 7 OK created sql table model dbt_maximerosa_marts.default_ratio_analysis .. [[32mSUCCESS 1[0m in 3.41s]
[0m18:34:15.479486 [debug] [Thread-9 (]: Finished running node model.sequra_analytics.default_ratio_analysis
[0m18:34:18.688309 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 3.884 seconds
[0m18:34:18.690800 [debug] [Thread-8 (]: On model.sequra_analytics.shopper_recurrence_rate: Close
[0m18:34:18.767828 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482fb428-f034-48db-86a9-31ae4fdadbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128e1ffe0>]}
[0m18:34:18.768925 [info ] [Thread-8 (]: 7 of 7 OK created sql table model dbt_maximerosa_marts.shopper_recurrence_rate . [[32mSUCCESS 1[0m in 3.98s]
[0m18:34:18.769653 [debug] [Thread-8 (]: Finished running node model.sequra_analytics.shopper_recurrence_rate
[0m18:34:18.770947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:18.771291 [debug] [MainThread]: Connection 'model.sequra_analytics.shopper_recurrence_rate' was properly closed.
[0m18:34:18.771538 [debug] [MainThread]: Connection 'model.sequra_analytics.default_ratio_analysis' was properly closed.
[0m18:34:18.771754 [debug] [MainThread]: Connection 'model.sequra_analytics.int_recurrent_shoppers' was properly closed.
[0m18:34:18.771962 [debug] [MainThread]: Connection 'model.sequra_analytics.int_monthly_shoppers' was properly closed.
[0m18:34:18.772324 [info ] [MainThread]: 
[0m18:34:18.772662 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 14.94 seconds (14.94s).
[0m18:34:18.773939 [debug] [MainThread]: Command end result
[0m18:34:18.798635 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m18:34:18.803050 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m18:34:18.807947 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/run_results.json
[0m18:34:18.808224 [info ] [MainThread]: 
[0m18:34:18.808465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:18.808651 [info ] [MainThread]: 
[0m18:34:18.808853 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m18:34:18.811047 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.71703, "process_in_blocks": "0", "process_kernel_time": 0.470189, "process_mem_max_rss": "183074816", "process_out_blocks": "0", "process_user_time": 2.244951}
[0m18:34:18.811346 [debug] [MainThread]: Command `dbt run` succeeded at 18:34:18.811296 after 15.72 seconds
[0m18:34:18.811572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fae360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a011b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff0bf0>]}
[0m18:34:18.811799 [debug] [MainThread]: Flushing usage events
[0m18:34:19.236957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:31.962309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105659820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059199d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059196a0>]}


============================== 18:50:31.967714 | 5aaa2fcf-9d52-4ca6-9fe8-81cb1caad4f3 ==============================
[0m18:50:31.967714 [info ] [MainThread]: Running with dbt=1.10.9
[0m18:50:31.968190 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'empty': 'None', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'printer_width': '80', 'partial_parse': 'True'}
[0m18:50:32.372632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5aaa2fcf-9d52-4ca6-9fe8-81cb1caad4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10487e0f0>]}
[0m18:50:32.402212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5aaa2fcf-9d52-4ca6-9fe8-81cb1caad4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10666cb30>]}
[0m18:50:32.403260 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:50:32.479726 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m18:50:32.628863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:50:32.629128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:50:32.632175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.sequra_analytics.orders_merchant.column_types
[0m18:50:32.654371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5aaa2fcf-9d52-4ca6-9fe8-81cb1caad4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d61910>]}
[0m18:50:32.698041 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m18:50:32.700820 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m18:50:32.725156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5aaa2fcf-9d52-4ca6-9fe8-81cb1caad4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078680e0>]}
[0m18:50:32.725490 [info ] [MainThread]: Found 7 models, 2 seeds, 11 data tests, 479 macros
[0m18:50:32.725677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aaa2fcf-9d52-4ca6-9fe8-81cb1caad4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b0080>]}
[0m18:50:32.726846 [info ] [MainThread]: 
[0m18:50:32.727079 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:50:32.727214 [info ] [MainThread]: 
[0m18:50:32.727495 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:50:32.729648 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m18:50:32.802979 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m18:50:32.803248 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m18:50:32.803394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:35.460035 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.658 seconds
[0m18:50:35.462179 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m18:50:35.544982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_staging)
[0m18:50:35.545748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_marts'
[0m18:50:35.547394 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_raw_data'
[0m18:50:35.559908 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m18:50:35.562327 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m18:50:35.562790 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate'
[0m18:50:35.564921 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m18:50:35.565293 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m18:50:35.565618 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m18:50:35.567342 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m18:50:35.567621 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m18:50:35.567850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:35.568052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:35.568249 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m18:50:35.568443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:35.570531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:37.874458 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.307 seconds
[0m18:50:37.876464 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: Close
[0m18:50:37.880054 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.313 seconds
[0m18:50:37.881841 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: Close
[0m18:50:38.046066 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.478 seconds
[0m18:50:38.049378 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: Close
[0m18:50:38.054473 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.485 seconds
[0m18:50:38.056522 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m18:50:38.130374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aaa2fcf-9d52-4ca6-9fe8-81cb1caad4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c4830>]}
[0m18:50:38.139374 [debug] [Thread-6 (]: Began running node seed.sequra_analytics.merchants
[0m18:50:38.139860 [debug] [Thread-7 (]: Began running node seed.sequra_analytics.orders_merchant
[0m18:50:38.140396 [info ] [Thread-6 (]: 1 of 2 START seed file dbt_maximerosa_raw_data.merchants ....................... [RUN]
[0m18:50:38.140906 [info ] [Thread-7 (]: 2 of 2 START seed file dbt_maximerosa_raw_data.orders_merchant ................. [RUN]
[0m18:50:38.141476 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now seed.sequra_analytics.merchants)
[0m18:50:38.141936 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now seed.sequra_analytics.orders_merchant)
[0m18:50:38.142307 [debug] [Thread-6 (]: Began compiling node seed.sequra_analytics.merchants
[0m18:50:38.142676 [debug] [Thread-7 (]: Began compiling node seed.sequra_analytics.orders_merchant
[0m18:50:38.143039 [debug] [Thread-6 (]: Began executing node seed.sequra_analytics.merchants
[0m18:50:38.143359 [debug] [Thread-7 (]: Began executing node seed.sequra_analytics.orders_merchant
[0m18:50:38.183716 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m18:50:38.184084 [debug] [Thread-7 (]: On seed.sequra_analytics.orders_merchant: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m18:50:38.184310 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m18:50:38.186056 [debug] [Thread-6 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m18:50:38.186625 [debug] [Thread-6 (]: On seed.sequra_analytics.merchants: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m18:50:38.187986 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m18:50:40.534615 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.351 seconds
[0m18:50:40.535514 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m18:50:40.536357 [debug] [Thread-7 (]: On seed.sequra_analytics.orders_merchant: truncate table "SEQURA_DEV"."DBT_MAXIMEROSA_RAW_DATA"."ORDERS_MERCHANT"
  
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */;
[0m18:50:40.537113 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 2.350 seconds
[0m18:50:40.537818 [debug] [Thread-6 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m18:50:40.538484 [debug] [Thread-6 (]: On seed.sequra_analytics.merchants: truncate table "SEQURA_DEV"."DBT_MAXIMEROSA_RAW_DATA"."MERCHANTS"
  
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */;
[0m18:50:40.718017 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m18:50:40.718686 [debug] [Thread-6 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m18:50:40.718969 [debug] [Thread-6 (]: On seed.sequra_analytics.merchants: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m18:50:40.809671 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.272 seconds
[0m18:50:40.812277 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m18:50:40.812838 [debug] [Thread-7 (]: On seed.sequra_analytics.orders_merchant: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m18:50:40.901567 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m18:50:40.918295 [debug] [Thread-6 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m18:50:40.918973 [debug] [Thread-6 (]: On seed.sequra_analytics.merchants: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m18:50:40.993293 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m18:50:40.999989 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m18:50:41.000623 [debug] [Thread-7 (]: On seed.sequra_analytics.orders_merchant: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m18:50:41.002554 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.083 seconds
[0m18:50:41.003509 [debug] [Thread-6 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m18:50:41.003846 [debug] [Thread-6 (]: On seed.sequra_analytics.merchants: insert into SEQURA_DEV.dbt_maximerosa_raw_data.merchants (merchant_id, merchant_name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */...
[0m18:50:41.094372 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.092 seconds
[0m18:50:41.096913 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m18:50:41.097430 [debug] [Thread-7 (]: On seed.sequra_analytics.orders_merchant: insert into SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant (order_id, shopper_id, merchant_id, order_date) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version":...
[0m18:50:41.436265 [debug] [Thread-6 (]: SQL status: SUCCESS 6 in 0.432 seconds
[0m18:50:41.438335 [debug] [Thread-6 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m18:50:41.438908 [debug] [Thread-6 (]: On seed.sequra_analytics.merchants: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m18:50:41.450870 [debug] [Thread-7 (]: SQL status: SUCCESS 25 in 0.353 seconds
[0m18:50:41.451802 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m18:50:41.452309 [debug] [Thread-7 (]: On seed.sequra_analytics.orders_merchant: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m18:50:41.740952 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.301 seconds
[0m18:50:41.742582 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.290 seconds
[0m18:50:41.750763 [debug] [Thread-6 (]: Writing runtime SQL for node "seed.sequra_analytics.merchants"
[0m18:50:41.751430 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.sequra_analytics.orders_merchant"
[0m18:50:41.783720 [debug] [Thread-6 (]: On seed.sequra_analytics.merchants: Close
[0m18:50:41.784246 [debug] [Thread-7 (]: On seed.sequra_analytics.orders_merchant: Close
[0m18:50:42.096405 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaa2fcf-9d52-4ca6-9fe8-81cb1caad4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d3dd0>]}
[0m18:50:42.097036 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaa2fcf-9d52-4ca6-9fe8-81cb1caad4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10296b260>]}
[0m18:50:42.097821 [info ] [Thread-7 (]: 2 of 2 OK loaded seed file dbt_maximerosa_raw_data.orders_merchant ............. [[32mINSERT 25[0m in 3.95s]
[0m18:50:42.098336 [info ] [Thread-6 (]: 1 of 2 OK loaded seed file dbt_maximerosa_raw_data.merchants ................... [[32mINSERT 6[0m in 3.95s]
[0m18:50:42.098937 [debug] [Thread-7 (]: Finished running node seed.sequra_analytics.orders_merchant
[0m18:50:42.099565 [debug] [Thread-6 (]: Finished running node seed.sequra_analytics.merchants
[0m18:50:42.101086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:42.101467 [debug] [MainThread]: Connection 'seed.sequra_analytics.merchants' was properly closed.
[0m18:50:42.101770 [debug] [MainThread]: Connection 'seed.sequra_analytics.orders_merchant' was properly closed.
[0m18:50:42.102047 [debug] [MainThread]: Connection 'list_SEQURA_DEV_dbt_maximerosa_raw_data' was properly closed.
[0m18:50:42.102321 [debug] [MainThread]: Connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate' was properly closed.
[0m18:50:42.102657 [info ] [MainThread]: 
[0m18:50:42.102953 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 9.38 seconds (9.38s).
[0m18:50:42.103969 [debug] [MainThread]: Command end result
[0m18:50:42.128385 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m18:50:42.131452 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m18:50:42.136230 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/run_results.json
[0m18:50:42.136510 [info ] [MainThread]: 
[0m18:50:42.136826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:50:42.137085 [info ] [MainThread]: 
[0m18:50:42.137318 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:50:42.139186 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 10.227423, "process_in_blocks": "0", "process_kernel_time": 0.378338, "process_mem_max_rss": "168509440", "process_out_blocks": "0", "process_user_time": 1.859665}
[0m18:50:42.139545 [debug] [MainThread]: Command `dbt seed` succeeded at 18:50:42.139483 after 10.23 seconds
[0m18:50:42.139802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ae360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105944d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0d340>]}
[0m18:50:42.140038 [debug] [MainThread]: Flushing usage events
[0m18:50:42.526667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:49.898543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10617ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b11be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b118e0>]}


============================== 18:50:49.901371 | df812c5e-c5f5-4496-8fa9-85b9a03089a3 ==============================
[0m18:50:49.901371 [info ] [MainThread]: Running with dbt=1.10.9
[0m18:50:49.901700 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'debug': 'False', 'static_parser': 'True', 'write_json': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'introspect': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics', 'target_path': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'empty': 'False'}
[0m18:50:50.198587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df812c5e-c5f5-4496-8fa9-85b9a03089a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce4dd0>]}
[0m18:50:50.230130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df812c5e-c5f5-4496-8fa9-85b9a03089a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111cd0a0>]}
[0m18:50:50.231100 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:50:50.301023 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m18:50:50.442320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:50:50.442615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:50:50.445968 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.sequra_analytics.orders_merchant.column_types
[0m18:50:50.468017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df812c5e-c5f5-4496-8fa9-85b9a03089a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c0e8d0>]}
[0m18:50:50.509923 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m18:50:50.511634 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m18:50:50.526245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df812c5e-c5f5-4496-8fa9-85b9a03089a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11316b8c0>]}
[0m18:50:50.526538 [info ] [MainThread]: Found 7 models, 2 seeds, 11 data tests, 479 macros
[0m18:50:50.526712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df812c5e-c5f5-4496-8fa9-85b9a03089a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ac9040>]}
[0m18:50:50.527776 [info ] [MainThread]: 
[0m18:50:50.527945 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:50:50.528097 [info ] [MainThread]: 
[0m18:50:50.528381 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:50:50.530705 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m18:50:50.538625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m18:50:50.539158 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m18:50:50.597989 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m18:50:50.598349 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m18:50:50.598515 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m18:50:50.598795 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m18:50:50.599107 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m18:50:50.599315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:50.599488 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m18:50:50.599633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:50.600413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:53.219291 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.619 seconds
[0m18:50:53.220066 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.621 seconds
[0m18:50:53.221757 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m18:50:53.223125 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m18:50:53.233822 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.635 seconds
[0m18:50:53.235300 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m18:50:53.304365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_staging)
[0m18:50:53.304936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_intermediate)
[0m18:50:53.305408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_raw_data)
[0m18:50:53.306779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_marts'
[0m18:50:53.321457 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m18:50:53.323936 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m18:50:53.325600 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m18:50:53.327080 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m18:50:53.327311 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m18:50:53.327512 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m18:50:53.327689 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m18:50:53.327860 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m18:50:53.328023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:53.328258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:53.328492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:53.328703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:55.673137 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.345 seconds
[0m18:50:55.675661 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: Close
[0m18:50:55.677337 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.349 seconds
[0m18:50:55.679394 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: Close
[0m18:50:55.681452 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.353 seconds
[0m18:50:55.683306 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: Close
[0m18:50:55.685663 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.358 seconds
[0m18:50:55.689171 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m18:50:55.776771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df812c5e-c5f5-4496-8fa9-85b9a03089a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136178f0>]}
[0m18:50:55.782130 [debug] [Thread-8 (]: Began running node model.sequra_analytics.stg_merchants
[0m18:50:55.782597 [debug] [Thread-9 (]: Began running node model.sequra_analytics.stg_orders
[0m18:50:55.783091 [info ] [Thread-8 (]: 1 of 7 START sql view model dbt_maximerosa_staging.stg_merchants ............... [RUN]
[0m18:50:55.783557 [info ] [Thread-9 (]: 2 of 7 START sql view model dbt_maximerosa_staging.stg_orders .................. [RUN]
[0m18:50:55.783960 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now model.sequra_analytics.stg_merchants)
[0m18:50:55.784283 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_intermediate, now model.sequra_analytics.stg_orders)
[0m18:50:55.784596 [debug] [Thread-8 (]: Began compiling node model.sequra_analytics.stg_merchants
[0m18:50:55.784864 [debug] [Thread-9 (]: Began compiling node model.sequra_analytics.stg_orders
[0m18:50:55.792269 [debug] [Thread-8 (]: Writing injected SQL for node "model.sequra_analytics.stg_merchants"
[0m18:50:55.794922 [debug] [Thread-9 (]: Writing injected SQL for node "model.sequra_analytics.stg_orders"
[0m18:50:55.796176 [debug] [Thread-8 (]: Began executing node model.sequra_analytics.stg_merchants
[0m18:50:55.796550 [debug] [Thread-9 (]: Began executing node model.sequra_analytics.stg_orders
[0m18:50:55.826859 [debug] [Thread-9 (]: Writing runtime sql for node "model.sequra_analytics.stg_orders"
[0m18:50:55.828177 [debug] [Thread-8 (]: Writing runtime sql for node "model.sequra_analytics.stg_merchants"
[0m18:50:55.833786 [debug] [Thread-9 (]: Using snowflake connection "model.sequra_analytics.stg_orders"
[0m18:50:55.834197 [debug] [Thread-8 (]: Using snowflake connection "model.sequra_analytics.stg_merchants"
[0m18:50:55.834468 [debug] [Thread-9 (]: On model.sequra_analytics.stg_orders: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders
  
  
  
  
  as (
    

with source_data as (
    select
        order_id,
        shopper_id,
        merchant_id,
        order_date as order_date_raw,
        -- Parse the date format (d/m/yy or dd/mm/yy)
        case 
            when split_part(order_date, '/', 3) = '22' then '2022'
            when split_part(order_date, '/', 3) = '23' then '2023'
            else '20' || split_part(order_date, '/', 3)
        end || '-' ||
        lpad(split_part(order_date, '/', 2), 2, '0') || '-' ||
        lpad(split_part(order_date, '/', 1), 2, '0') as order_date_formatted
    from SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant
)

select
    order_id,
    shopper_id,
    merchant_id,
    order_date_raw,
    to_date(order_date_formatted, 'YYYY-MM-DD') as order_date,
    date_trunc('month', to_date(order_date_formatted, 'YYYY-MM-DD')) as order_month,
    to_char(to_date(order_date_formatted, 'YYYY-MM-DD'), 'YYYY-MM') as month_year
from source_data
where order_date_raw is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders"} */;
[0m18:50:55.834718 [debug] [Thread-8 (]: On model.sequra_analytics.stg_merchants: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
  
  
  
  
  as (
    

select
    merchant_id,
    merchant_name
from SEQURA_DEV.dbt_maximerosa_raw_data.merchants
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_merchants"} */;
[0m18:50:55.834918 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m18:50:55.835089 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m18:50:58.214700 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.379 seconds
[0m18:50:58.242659 [debug] [Thread-8 (]: On model.sequra_analytics.stg_merchants: Close
[0m18:50:58.277518 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.443 seconds
[0m18:50:58.279676 [debug] [Thread-9 (]: On model.sequra_analytics.stg_orders: Close
[0m18:50:58.316883 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df812c5e-c5f5-4496-8fa9-85b9a03089a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078cb8c0>]}
[0m18:50:58.317869 [info ] [Thread-8 (]: 1 of 7 OK created sql view model dbt_maximerosa_staging.stg_merchants .......... [[32mSUCCESS 1[0m in 2.53s]
[0m18:50:58.318402 [debug] [Thread-8 (]: Finished running node model.sequra_analytics.stg_merchants
[0m18:50:58.353717 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df812c5e-c5f5-4496-8fa9-85b9a03089a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139dbdd0>]}
[0m18:50:58.354395 [info ] [Thread-9 (]: 2 of 7 OK created sql view model dbt_maximerosa_staging.stg_orders ............. [[32mSUCCESS 1[0m in 2.57s]
[0m18:50:58.354848 [debug] [Thread-9 (]: Finished running node model.sequra_analytics.stg_orders
[0m18:50:58.355713 [debug] [Thread-11 ]: Began running node model.sequra_analytics.default_ratio_analysis
[0m18:50:58.356045 [debug] [Thread-10 ]: Began running node model.sequra_analytics.int_monthly_shoppers
[0m18:50:58.356456 [info ] [Thread-11 ]: 3 of 7 START sql table model dbt_maximerosa_marts.default_ratio_analysis ....... [RUN]
[0m18:50:58.357162 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now model.sequra_analytics.default_ratio_analysis)
[0m18:50:58.356855 [info ] [Thread-10 ]: 4 of 7 START sql view model dbt_maximerosa_intermediate.int_monthly_shoppers ... [RUN]
[0m18:50:58.357516 [debug] [Thread-11 ]: Began compiling node model.sequra_analytics.default_ratio_analysis
[0m18:50:58.357780 [debug] [Thread-8 (]: Began running node model.sequra_analytics.int_orders_with_defaults
[0m18:50:58.358086 [debug] [Thread-9 (]: Began running node model.sequra_analytics.int_recurrent_shoppers
[0m18:50:58.358437 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_raw_data, now model.sequra_analytics.int_monthly_shoppers)
[0m18:50:58.362213 [debug] [Thread-11 ]: Writing injected SQL for node "model.sequra_analytics.default_ratio_analysis"
[0m18:50:58.363965 [info ] [Thread-8 (]: 5 of 7 START sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [RUN]
[0m18:50:58.364803 [info ] [Thread-9 (]: 6 of 7 START sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers . [RUN]
[0m18:50:58.365882 [debug] [Thread-10 ]: Began compiling node model.sequra_analytics.int_monthly_shoppers
[0m18:50:58.368266 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_merchants, now model.sequra_analytics.int_orders_with_defaults)
[0m18:50:58.370086 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders, now model.sequra_analytics.int_recurrent_shoppers)
[0m18:50:58.378574 [debug] [Thread-11 ]: Began executing node model.sequra_analytics.default_ratio_analysis
[0m18:50:58.378013 [debug] [Thread-10 ]: Writing injected SQL for node "model.sequra_analytics.int_monthly_shoppers"
[0m18:50:58.381624 [debug] [Thread-8 (]: Began compiling node model.sequra_analytics.int_orders_with_defaults
[0m18:50:58.382406 [debug] [Thread-9 (]: Began compiling node model.sequra_analytics.int_recurrent_shoppers
[0m18:50:58.401396 [debug] [Thread-11 ]: Writing runtime sql for node "model.sequra_analytics.default_ratio_analysis"
[0m18:50:58.403330 [debug] [Thread-8 (]: Writing injected SQL for node "model.sequra_analytics.int_orders_with_defaults"
[0m18:50:58.405204 [debug] [Thread-9 (]: Writing injected SQL for node "model.sequra_analytics.int_recurrent_shoppers"
[0m18:50:58.405608 [debug] [Thread-10 ]: Began executing node model.sequra_analytics.int_monthly_shoppers
[0m18:50:58.406996 [debug] [Thread-10 ]: Writing runtime sql for node "model.sequra_analytics.int_monthly_shoppers"
[0m18:50:58.407348 [debug] [Thread-8 (]: Began executing node model.sequra_analytics.int_orders_with_defaults
[0m18:50:58.408801 [debug] [Thread-11 ]: Using snowflake connection "model.sequra_analytics.default_ratio_analysis"
[0m18:50:58.410185 [debug] [Thread-8 (]: Writing runtime sql for node "model.sequra_analytics.int_orders_with_defaults"
[0m18:50:58.410400 [debug] [Thread-9 (]: Began executing node model.sequra_analytics.int_recurrent_shoppers
[0m18:50:58.410762 [debug] [Thread-11 ]: On model.sequra_analytics.default_ratio_analysis: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.default_ratio_analysis
    
    
    
    as (

-- This model calculates the default ratio as requested in Part 2

with orders_with_defaults as (
    -- This would come from the actual orders table with financial data
    select
        o.*,
        m.merchant_name as merchant,
        -- These fields would come from the actual source data:
        null::integer as shopper_age,
        null::varchar as product,
        null::boolean as is_in_default,
        null::integer as days_unbalanced,
        null::decimal(15,2) as current_order_value,
        null::decimal(15,2) as overdue_amount
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
),

-- Calculate delayed periods based on days_unbalanced
-- An order with 35 days unbalanced is included in both 17 and 30 day calculations
delayed_period_17 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '17' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 17
        and is_in_default = true
),

delayed_period_30 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '30' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 30
        and is_in_default = true
),

delayed_period_60 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '60' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 60
        and is_in_default = true
),

delayed_period_90 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '90' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 90
        and is_in_default = true
),

-- Union all delayed periods
all_defaults as (
    select * from delayed_period_17
    union all
    select * from delayed_period_30
    union all
    select * from delayed_period_60
    union all
    select * from delayed_period_90
)

-- Final output with the exact columns requested
select
    shopper_age,
    month_year_order,
    product,
    merchant,
    default_type,
    delayed_period
from all_defaults
order by 
    month_year_order,
    merchant,
    delayed_period::integer
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.default_ratio_analysis"} */;
[0m18:50:58.412303 [debug] [Thread-9 (]: Writing runtime sql for node "model.sequra_analytics.int_recurrent_shoppers"
[0m18:50:58.412517 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m18:50:58.412959 [debug] [Thread-10 ]: Using snowflake connection "model.sequra_analytics.int_monthly_shoppers"
[0m18:50:58.413765 [debug] [Thread-8 (]: Using snowflake connection "model.sequra_analytics.int_orders_with_defaults"
[0m18:50:58.413952 [debug] [Thread-10 ]: On model.sequra_analytics.int_monthly_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers
  
  
  
  
  as (
    

with monthly_orders as (
    select distinct
        order_month,
        month_year,
        merchant_id,
        shopper_id
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
)

select
    order_month,
    month_year,
    merchant_id,
    shopper_id
from monthly_orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_monthly_shoppers"} */;
[0m18:50:58.414460 [debug] [Thread-8 (]: On model.sequra_analytics.int_orders_with_defaults: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
  
  
  
  
  as (
    

-- Placeholder for Part 2 of the challenge
-- This would contain the logic for calculating default ratios
-- when the additional data tables are available

with orders_base as (
    select
        o.*,
        m.merchant_name,
        -- Placeholder fields for default calculation
        -- These would come from the actual orders table with financial data
        null::boolean as is_in_default,
        null::integer as days_unbalanced,
        null::decimal(15,2) as current_order_value,
        null::decimal(15,2) as overdue_amount,
        null::varchar as product,
        null::integer as shopper_age
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
)

select
    *,
    case
        when days_unbalanced > 90 then '90+'
        when days_unbalanced > 60 then '60'
        when days_unbalanced > 30 then '30'
        when days_unbalanced > 17 then '17'
        else null
    end as delayed_period
from orders_base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_orders_with_defaults"} */;
[0m18:50:58.414717 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m18:50:58.415401 [debug] [Thread-9 (]: Using snowflake connection "model.sequra_analytics.int_recurrent_shoppers"
[0m18:50:58.415648 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m18:50:58.416341 [debug] [Thread-9 (]: On model.sequra_analytics.int_recurrent_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers
  
  
  
  
  as (
    

with order_history as (
    select
        o1.order_month as current_month,
        o1.month_year as current_month_year,
        o1.merchant_id,
        o1.shopper_id,
        count(distinct o2.order_month) as months_with_purchases
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o1
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_orders o2
        on o1.merchant_id = o2.merchant_id
        and o1.shopper_id = o2.shopper_id
        and o2.order_date between dateadd(month, -11, o1.order_month) and last_day(o1.order_month)
        and o2.order_month <= o1.order_month
    group by 1, 2, 3, 4
)

select
    current_month,
    current_month_year,
    merchant_id,
    shopper_id,
    months_with_purchases,
    -- A shopper is recurrent if they have made purchases in at least 2 different months
    -- within the 12-month window including the current month
    case 
        when months_with_purchases >= 2 then 1 
        else 0 
    end as is_recurrent
from order_history
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_recurrent_shoppers"} */;
[0m18:50:58.417068 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m18:51:00.993281 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.577 seconds
[0m18:51:00.994329 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.577 seconds
[0m18:51:00.996854 [debug] [Thread-8 (]: On model.sequra_analytics.int_orders_with_defaults: Close
[0m18:51:00.998664 [debug] [Thread-9 (]: On model.sequra_analytics.int_recurrent_shoppers: Close
[0m18:51:00.999389 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.585 seconds
[0m18:51:01.002407 [debug] [Thread-10 ]: On model.sequra_analytics.int_monthly_shoppers: Close
[0m18:51:01.093201 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df812c5e-c5f5-4496-8fa9-85b9a03089a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f0c830>]}
[0m18:51:01.094245 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df812c5e-c5f5-4496-8fa9-85b9a03089a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f17c50>]}
[0m18:51:01.095173 [info ] [Thread-10 ]: 4 of 7 OK created sql view model dbt_maximerosa_intermediate.int_monthly_shoppers  [[32mSUCCESS 1[0m in 2.73s]
[0m18:51:01.095813 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df812c5e-c5f5-4496-8fa9-85b9a03089a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f23710>]}
[0m18:51:01.096343 [info ] [Thread-8 (]: 5 of 7 OK created sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [[32mSUCCESS 1[0m in 2.73s]
[0m18:51:01.096904 [debug] [Thread-10 ]: Finished running node model.sequra_analytics.int_monthly_shoppers
[0m18:51:01.097379 [info ] [Thread-9 (]: 6 of 7 OK created sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers  [[32mSUCCESS 1[0m in 2.73s]
[0m18:51:01.097970 [debug] [Thread-8 (]: Finished running node model.sequra_analytics.int_orders_with_defaults
[0m18:51:01.098655 [debug] [Thread-9 (]: Finished running node model.sequra_analytics.int_recurrent_shoppers
[0m18:51:01.099338 [debug] [Thread-10 ]: Began running node model.sequra_analytics.shopper_recurrence_rate
[0m18:51:01.099802 [info ] [Thread-10 ]: 7 of 7 START sql table model dbt_maximerosa_marts.shopper_recurrence_rate ...... [RUN]
[0m18:51:01.100228 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_monthly_shoppers, now model.sequra_analytics.shopper_recurrence_rate)
[0m18:51:01.100564 [debug] [Thread-10 ]: Began compiling node model.sequra_analytics.shopper_recurrence_rate
[0m18:51:01.105769 [debug] [Thread-10 ]: Writing injected SQL for node "model.sequra_analytics.shopper_recurrence_rate"
[0m18:51:01.107973 [debug] [Thread-10 ]: Began executing node model.sequra_analytics.shopper_recurrence_rate
[0m18:51:01.111076 [debug] [Thread-10 ]: Writing runtime sql for node "model.sequra_analytics.shopper_recurrence_rate"
[0m18:51:01.115129 [debug] [Thread-10 ]: Using snowflake connection "model.sequra_analytics.shopper_recurrence_rate"
[0m18:51:01.115618 [debug] [Thread-10 ]: On model.sequra_analytics.shopper_recurrence_rate: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
    
    
    
    as (

with monthly_metrics as (
    select
        ms.order_month,
        ms.month_year,
        ms.merchant_id,
        m.merchant_name,
        count(distinct ms.shopper_id) as total_shoppers,
        sum(rs.is_recurrent) as recurrent_shoppers
    from SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers ms
    left join SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers rs
        on ms.order_month = rs.current_month
        and ms.merchant_id = rs.merchant_id
        and ms.shopper_id = rs.shopper_id
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on ms.merchant_id = m.merchant_id
    group by 1, 2, 3, 4
)

select
    merchant_name,
    month_year as month,
    round(
        case 
            when total_shoppers > 0 
            then (recurrent_shoppers::decimal / total_shoppers) * 100
            else 0 
        end, 2
    ) as recurrence_rate
from monthly_metrics
order by merchant_name, month
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.shopper_recurrence_rate"} */;
[0m18:51:01.115981 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m18:51:01.510859 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 3.098 seconds
[0m18:51:01.513995 [debug] [Thread-11 ]: On model.sequra_analytics.default_ratio_analysis: Close
[0m18:51:01.593293 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df812c5e-c5f5-4496-8fa9-85b9a03089a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584b470>]}
[0m18:51:01.594379 [info ] [Thread-11 ]: 3 of 7 OK created sql table model dbt_maximerosa_marts.default_ratio_analysis .. [[32mSUCCESS 1[0m in 3.24s]
[0m18:51:01.595235 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.default_ratio_analysis
[0m18:51:04.789544 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.673 seconds
[0m18:51:04.793654 [debug] [Thread-10 ]: On model.sequra_analytics.shopper_recurrence_rate: Close
[0m18:51:04.876557 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df812c5e-c5f5-4496-8fa9-85b9a03089a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115f657f0>]}
[0m18:51:04.877606 [info ] [Thread-10 ]: 7 of 7 OK created sql table model dbt_maximerosa_marts.shopper_recurrence_rate . [[32mSUCCESS 1[0m in 3.78s]
[0m18:51:04.878476 [debug] [Thread-10 ]: Finished running node model.sequra_analytics.shopper_recurrence_rate
[0m18:51:04.880153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:04.880475 [debug] [MainThread]: Connection 'model.sequra_analytics.int_orders_with_defaults' was properly closed.
[0m18:51:04.880746 [debug] [MainThread]: Connection 'model.sequra_analytics.int_recurrent_shoppers' was properly closed.
[0m18:51:04.880953 [debug] [MainThread]: Connection 'model.sequra_analytics.shopper_recurrence_rate' was properly closed.
[0m18:51:04.881149 [debug] [MainThread]: Connection 'model.sequra_analytics.default_ratio_analysis' was properly closed.
[0m18:51:04.881509 [info ] [MainThread]: 
[0m18:51:04.881809 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 14.35 seconds (14.35s).
[0m18:51:04.883018 [debug] [MainThread]: Command end result
[0m18:51:04.912612 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m18:51:04.916345 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m18:51:04.921798 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/run_results.json
[0m18:51:04.922101 [info ] [MainThread]: 
[0m18:51:04.922399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:51:04.922602 [info ] [MainThread]: 
[0m18:51:04.922819 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m18:51:04.925796 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.070098, "process_in_blocks": "0", "process_kernel_time": 0.439444, "process_mem_max_rss": "179830784", "process_out_blocks": "0", "process_user_time": 2.194232}
[0m18:51:04.926192 [debug] [MainThread]: Command `dbt run` succeeded at 18:51:04.926123 after 15.07 seconds
[0m18:51:04.926454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aaea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b119d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b11400>]}
[0m18:51:04.926698 [debug] [MainThread]: Flushing usage events
[0m18:51:05.490537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:54:20.171399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104baeab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118011a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118011760>]}


============================== 18:54:20.174647 | bc57161b-e4c0-4c6f-a6f4-3d2adb623d8f ==============================
[0m18:54:20.174647 [info ] [MainThread]: Running with dbt=1.10.9
[0m18:54:20.174995 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'partial_parse': 'True', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'static_parser': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m18:54:20.484895 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "sequra_analytics", target "dev" invalid: 'schema' is a required property
[0m18:54:20.488497 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.36266124, "process_in_blocks": "0", "process_kernel_time": 0.181179, "process_mem_max_rss": "125206528", "process_out_blocks": "0", "process_user_time": 0.862253}
[0m18:54:20.489085 [debug] [MainThread]: Command `dbt run` failed at 18:54:20.489018 after 0.36 seconds
[0m18:54:20.489319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118011880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a963c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118508110>]}
[0m18:54:20.489539 [debug] [MainThread]: Flushing usage events
[0m18:54:20.903690 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:37.073336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067bedb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f31b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f317f0>]}


============================== 19:04:37.078173 | 0d288414-9b72-449a-a525-9c88d3f5533d ==============================
[0m19:04:37.078173 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:04:37.078614 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'False', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'cache_selected_only': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics', 'log_format': 'default', 'partial_parse': 'True', 'write_json': 'True'}
[0m19:04:37.546832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d288414-9b72-449a-a525-9c88d3f5533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d40b0>]}
[0m19:04:37.579690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d288414-9b72-449a-a525-9c88d3f5533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bc8c0>]}
[0m19:04:37.580967 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:04:37.656919 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:04:37.813942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:04:37.814209 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:04:37.817255 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.sequra_analytics.orders_merchant.column_types
[0m19:04:37.839925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d288414-9b72-449a-a525-9c88d3f5533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b89040>]}
[0m19:04:37.884626 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m19:04:37.891405 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m19:04:37.913934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d288414-9b72-449a-a525-9c88d3f5533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eaeae0>]}
[0m19:04:37.914196 [info ] [MainThread]: Found 7 models, 2 seeds, 11 data tests, 479 macros
[0m19:04:37.914360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d288414-9b72-449a-a525-9c88d3f5533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f86de0>]}
[0m19:04:37.915420 [info ] [MainThread]: 
[0m19:04:37.915600 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:04:37.915730 [info ] [MainThread]: 
[0m19:04:37.915962 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:04:37.918313 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m19:04:37.919743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m19:04:37.920067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m19:04:38.014885 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m19:04:38.015249 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m19:04:38.015542 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m19:04:38.015734 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m19:04:38.015928 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m19:04:38.016157 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m19:04:38.016346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:38.016493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:38.016636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:40.784421 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.768 seconds
[0m19:04:40.785012 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.769 seconds
[0m19:04:40.786378 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m19:04:40.786860 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.770 seconds
[0m19:04:40.787906 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m19:04:40.789069 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m19:04:40.862707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now create_SEQURA_DEV_dbt_maximerosa_staging)
[0m19:04:40.863220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now create_SEQURA_DEV_dbt_maximerosa_marts)
[0m19:04:40.863573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now create_SEQURA_DEV_dbt_maximerosa_intermediate)
[0m19:04:40.863940 [debug] [ThreadPool]: Creating schema "database: "SEQURA_DEV"
schema: "dbt_maximerosa_staging"
"
[0m19:04:40.864298 [debug] [ThreadPool]: Creating schema "database: "SEQURA_DEV"
schema: "dbt_maximerosa_marts"
"
[0m19:04:40.864608 [debug] [ThreadPool]: Creating schema "database: "SEQURA_DEV"
schema: "dbt_maximerosa_intermediate"
"
[0m19:04:40.869129 [debug] [ThreadPool]: Using snowflake connection "create_SEQURA_DEV_dbt_maximerosa_marts"
[0m19:04:40.870662 [debug] [ThreadPool]: Using snowflake connection "create_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m19:04:40.871947 [debug] [ThreadPool]: Using snowflake connection "create_SEQURA_DEV_dbt_maximerosa_staging"
[0m19:04:40.872168 [debug] [ThreadPool]: On create_SEQURA_DEV_dbt_maximerosa_marts: create schema if not exists SEQURA_DEV.dbt_maximerosa_marts
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "create_SEQURA_DEV_dbt_maximerosa_marts"} */
[0m19:04:40.872385 [debug] [ThreadPool]: On create_SEQURA_DEV_dbt_maximerosa_intermediate: create schema if not exists SEQURA_DEV.dbt_maximerosa_intermediate
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "create_SEQURA_DEV_dbt_maximerosa_intermediate"} */
[0m19:04:40.872585 [debug] [ThreadPool]: On create_SEQURA_DEV_dbt_maximerosa_staging: create schema if not exists SEQURA_DEV.dbt_maximerosa_staging
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "create_SEQURA_DEV_dbt_maximerosa_staging"} */
[0m19:04:40.872766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:40.872948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:40.873110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:43.207866 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.335 seconds
[0m19:04:43.209901 [debug] [ThreadPool]: On create_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m19:04:43.317772 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.444 seconds
[0m19:04:43.320473 [debug] [ThreadPool]: On create_SEQURA_DEV_dbt_maximerosa_marts: Close
[0m19:04:43.338236 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.465 seconds
[0m19:04:43.339630 [debug] [ThreadPool]: On create_SEQURA_DEV_dbt_maximerosa_staging: Close
[0m19:04:43.428583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_SEQURA_DEV_dbt_maximerosa_intermediate, now list_SEQURA_DEV_dbt_maximerosa_staging)
[0m19:04:43.431046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_SEQURA_DEV_dbt_maximerosa_marts, now list_SEQURA_DEV_dbt_maximerosa_marts)
[0m19:04:43.431637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_SEQURA_DEV_dbt_maximerosa_staging, now list_SEQURA_DEV_dbt_maximerosa_raw_data)
[0m19:04:43.450933 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate'
[0m19:04:43.454461 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m19:04:43.456507 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m19:04:43.457191 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m19:04:43.459169 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m19:04:43.459488 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m19:04:43.459719 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m19:04:43.459926 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m19:04:43.460117 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m19:04:43.460307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:43.460471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:43.460634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:43.460797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:45.757461 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.297 seconds
[0m19:04:45.761005 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: Close
[0m19:04:45.769443 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.309 seconds
[0m19:04:45.770738 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: Close
[0m19:04:45.773228 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.312 seconds
[0m19:04:45.776989 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m19:04:45.798127 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bea1c0-0001-66de-0000-000167def381
[0m19:04:45.798392 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m19:04:45.798610 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m19:04:45.798743 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:04:45.798899 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: Close
[0m19:04:45.883345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d288414-9b72-449a-a525-9c88d3f5533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fcb680>]}
[0m19:04:45.886362 [debug] [Thread-11 ]: Began running node model.sequra_analytics.stg_merchants
[0m19:04:45.886675 [debug] [Thread-12 ]: Began running node model.sequra_analytics.stg_orders
[0m19:04:45.887017 [info ] [Thread-11 ]: 1 of 7 START sql view model dbt_maximerosa_staging.stg_merchants ............... [RUN]
[0m19:04:45.887403 [info ] [Thread-12 ]: 2 of 7 START sql view model dbt_maximerosa_staging.stg_orders .................. [RUN]
[0m19:04:45.887751 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now model.sequra_analytics.stg_merchants)
[0m19:04:45.888003 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now model.sequra_analytics.stg_orders)
[0m19:04:45.888243 [debug] [Thread-11 ]: Began compiling node model.sequra_analytics.stg_merchants
[0m19:04:45.888462 [debug] [Thread-12 ]: Began compiling node model.sequra_analytics.stg_orders
[0m19:04:45.894677 [debug] [Thread-11 ]: Writing injected SQL for node "model.sequra_analytics.stg_merchants"
[0m19:04:45.897741 [debug] [Thread-12 ]: Writing injected SQL for node "model.sequra_analytics.stg_orders"
[0m19:04:45.900297 [debug] [Thread-11 ]: Began executing node model.sequra_analytics.stg_merchants
[0m19:04:45.913034 [debug] [Thread-12 ]: Began executing node model.sequra_analytics.stg_orders
[0m19:04:45.922740 [debug] [Thread-11 ]: Writing runtime sql for node "model.sequra_analytics.stg_merchants"
[0m19:04:45.924544 [debug] [Thread-12 ]: Writing runtime sql for node "model.sequra_analytics.stg_orders"
[0m19:04:45.925758 [debug] [Thread-11 ]: Using snowflake connection "model.sequra_analytics.stg_merchants"
[0m19:04:45.925989 [debug] [Thread-11 ]: On model.sequra_analytics.stg_merchants: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
  
  
  
  
  as (
    

select
    merchant_id,
    merchant_name
from SEQURA_DEV.dbt_maximerosa_raw_data.merchants
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_merchants"} */;
[0m19:04:45.926186 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m19:04:45.927362 [debug] [Thread-12 ]: Using snowflake connection "model.sequra_analytics.stg_orders"
[0m19:04:45.927639 [debug] [Thread-12 ]: On model.sequra_analytics.stg_orders: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders
  
  
  
  
  as (
    

with source_data as (
    select
        order_id,
        shopper_id,
        merchant_id,
        order_date as order_date_raw,
        -- Parse the date format (d/m/yy or dd/mm/yy)
        case 
            when split_part(order_date, '/', 3) = '22' then '2022'
            when split_part(order_date, '/', 3) = '23' then '2023'
            else '20' || split_part(order_date, '/', 3)
        end || '-' ||
        lpad(split_part(order_date, '/', 2), 2, '0') || '-' ||
        lpad(split_part(order_date, '/', 1), 2, '0') as order_date_formatted
    from SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant
)

select
    order_id,
    shopper_id,
    merchant_id,
    order_date_raw,
    to_date(order_date_formatted, 'YYYY-MM-DD') as order_date,
    date_trunc('month', to_date(order_date_formatted, 'YYYY-MM-DD')) as order_month,
    to_char(to_date(order_date_formatted, 'YYYY-MM-DD'), 'YYYY-MM') as month_year
from source_data
where order_date_raw is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders"} */;
[0m19:04:45.927921 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m19:04:48.238730 [debug] [Thread-12 ]: Snowflake adapter: Snowflake query id: 01bea1c0-0001-670a-0001-67de000111be
[0m19:04:48.240635 [debug] [Thread-12 ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SEQURA_DEV.DBT_MAXIMEROSA_RAW_DATA' does not exist or not authorized.
[0m19:04:48.241628 [debug] [Thread-12 ]: On model.sequra_analytics.stg_orders: Close
[0m19:04:48.255104 [debug] [Thread-11 ]: Snowflake adapter: Snowflake query id: 01bea1c0-0001-66de-0000-000167def385
[0m19:04:48.255670 [debug] [Thread-11 ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SEQURA_DEV.DBT_MAXIMEROSA_RAW_DATA' does not exist or not authorized.
[0m19:04:48.256100 [debug] [Thread-11 ]: On model.sequra_analytics.stg_merchants: Close
[0m19:04:48.336729 [debug] [Thread-12 ]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (02000): SQL compilation error:
  Schema 'SEQURA_DEV.DBT_MAXIMEROSA_RAW_DATA' does not exist or not authorized.
  compiled code at target/run/sequra_analytics/models/staging/stg_orders.sql
[0m19:04:48.340657 [debug] [Thread-11 ]: Database Error in model stg_merchants (models/staging/stg_merchants.sql)
  002003 (02000): SQL compilation error:
  Schema 'SEQURA_DEV.DBT_MAXIMEROSA_RAW_DATA' does not exist or not authorized.
  compiled code at target/run/sequra_analytics/models/staging/stg_merchants.sql
[0m19:04:48.341406 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d288414-9b72-449a-a525-9c88d3f5533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113650d0>]}
[0m19:04:48.341727 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d288414-9b72-449a-a525-9c88d3f5533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f7d70>]}
[0m19:04:48.342489 [error] [Thread-12 ]: 2 of 7 ERROR creating sql view model dbt_maximerosa_staging.stg_orders ......... [[31mERROR[0m in 2.45s]
[0m19:04:48.343135 [error] [Thread-11 ]: 1 of 7 ERROR creating sql view model dbt_maximerosa_staging.stg_merchants ...... [[31mERROR[0m in 2.45s]
[0m19:04:48.343791 [debug] [Thread-12 ]: Finished running node model.sequra_analytics.stg_orders
[0m19:04:48.344294 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.stg_merchants
[0m19:04:48.344827 [debug] [Thread-17 ]: Marking all children of 'model.sequra_analytics.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (02000): SQL compilation error:
  Schema 'SEQURA_DEV.DBT_MAXIMEROSA_RAW_DATA' does not exist or not authorized.
  compiled code at target/run/sequra_analytics/models/staging/stg_orders.sql.
[0m19:04:48.346174 [debug] [Thread-17 ]: Marking all children of 'model.sequra_analytics.stg_merchants' to be skipped because of status 'error'.  Reason: Database Error in model stg_merchants (models/staging/stg_merchants.sql)
  002003 (02000): SQL compilation error:
  Schema 'SEQURA_DEV.DBT_MAXIMEROSA_RAW_DATA' does not exist or not authorized.
  compiled code at target/run/sequra_analytics/models/staging/stg_merchants.sql.
[0m19:04:48.346833 [debug] [Thread-14 ]: Began running node model.sequra_analytics.int_monthly_shoppers
[0m19:04:48.347218 [debug] [Thread-13 ]: Began running node model.sequra_analytics.int_recurrent_shoppers
[0m19:04:48.347884 [debug] [Thread-11 ]: Began running node model.sequra_analytics.default_ratio_analysis
[0m19:04:48.347614 [info ] [Thread-14 ]: 3 of 7 SKIP relation dbt_maximerosa_intermediate.int_monthly_shoppers .......... [[33mSKIP[0m]
[0m19:04:48.348390 [debug] [Thread-12 ]: Began running node model.sequra_analytics.int_orders_with_defaults
[0m19:04:48.348826 [info ] [Thread-13 ]: 4 of 7 SKIP relation dbt_maximerosa_intermediate.int_recurrent_shoppers ........ [[33mSKIP[0m]
[0m19:04:48.349220 [info ] [Thread-11 ]: 5 of 7 SKIP relation dbt_maximerosa_marts.default_ratio_analysis ............... [[33mSKIP[0m]
[0m19:04:48.349732 [debug] [Thread-14 ]: Finished running node model.sequra_analytics.int_monthly_shoppers
[0m19:04:48.350079 [info ] [Thread-12 ]: 6 of 7 SKIP relation dbt_maximerosa_intermediate.int_orders_with_defaults ...... [[33mSKIP[0m]
[0m19:04:48.350521 [debug] [Thread-13 ]: Finished running node model.sequra_analytics.int_recurrent_shoppers
[0m19:04:48.350842 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.default_ratio_analysis
[0m19:04:48.351280 [debug] [Thread-12 ]: Finished running node model.sequra_analytics.int_orders_with_defaults
[0m19:04:48.351933 [debug] [Thread-11 ]: Began running node model.sequra_analytics.shopper_recurrence_rate
[0m19:04:48.352383 [info ] [Thread-11 ]: 7 of 7 SKIP relation dbt_maximerosa_marts.shopper_recurrence_rate .............. [[33mSKIP[0m]
[0m19:04:48.352741 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.shopper_recurrence_rate
[0m19:04:48.353813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:48.354058 [debug] [MainThread]: Connection 'model.sequra_analytics.stg_merchants' was properly closed.
[0m19:04:48.354248 [debug] [MainThread]: Connection 'model.sequra_analytics.stg_orders' was properly closed.
[0m19:04:48.354422 [debug] [MainThread]: Connection 'list_SEQURA_DEV_dbt_maximerosa_raw_data' was properly closed.
[0m19:04:48.354594 [debug] [MainThread]: Connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate' was properly closed.
[0m19:04:48.354847 [info ] [MainThread]: 
[0m19:04:48.355080 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 10.44 seconds (10.44s).
[0m19:04:48.355723 [debug] [MainThread]: Command end result
[0m19:04:48.374285 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m19:04:48.376311 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m19:04:48.380979 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/run_results.json
[0m19:04:48.381240 [info ] [MainThread]: 
[0m19:04:48.381480 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:04:48.381675 [info ] [MainThread]: 
[0m19:04:48.381917 [error] [MainThread]: [31mFailure in model stg_orders (models/staging/stg_orders.sql)[0m
[0m19:04:48.382162 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (02000): SQL compilation error:
  Schema 'SEQURA_DEV.DBT_MAXIMEROSA_RAW_DATA' does not exist or not authorized.
  compiled code at target/run/sequra_analytics/models/staging/stg_orders.sql
[0m19:04:48.382327 [info ] [MainThread]: 
[0m19:04:48.382571 [info ] [MainThread]:   compiled code at target/compiled/sequra_analytics/models/staging/stg_orders.sql
[0m19:04:48.382801 [info ] [MainThread]: 
[0m19:04:48.383020 [error] [MainThread]: [31mFailure in model stg_merchants (models/staging/stg_merchants.sql)[0m
[0m19:04:48.383243 [error] [MainThread]:   Database Error in model stg_merchants (models/staging/stg_merchants.sql)
  002003 (02000): SQL compilation error:
  Schema 'SEQURA_DEV.DBT_MAXIMEROSA_RAW_DATA' does not exist or not authorized.
  compiled code at target/run/sequra_analytics/models/staging/stg_merchants.sql
[0m19:04:48.383409 [info ] [MainThread]: 
[0m19:04:48.383601 [info ] [MainThread]:   compiled code at target/compiled/sequra_analytics/models/staging/stg_merchants.sql
[0m19:04:48.383758 [info ] [MainThread]: 
[0m19:04:48.383941 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=5 NO-OP=0 TOTAL=7
[0m19:04:48.385637 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.361383, "process_in_blocks": "0", "process_kernel_time": 0.518034, "process_mem_max_rss": "179257344", "process_out_blocks": "0", "process_user_time": 2.121257}
[0m19:04:48.385942 [debug] [MainThread]: Command `dbt run` failed at 19:04:48.385884 after 11.36 seconds
[0m19:04:48.386171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f31940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ece870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972e4e0>]}
[0m19:04:48.386381 [debug] [MainThread]: Flushing usage events
[0m19:04:48.787957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:07.959573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062bf920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b158b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b15580>]}


============================== 19:05:07.962785 | 6d065766-f931-45fe-8df2-9f3cb5bc5a11 ==============================
[0m19:05:07.962785 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:05:07.963186 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'fail_fast': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'printer_width': '80', 'introspect': 'True', 'log_format': 'default', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'version_check': 'True'}
[0m19:05:08.264532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d065766-f931-45fe-8df2-9f3cb5bc5a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106252930>]}
[0m19:05:08.294856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d065766-f931-45fe-8df2-9f3cb5bc5a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aff680>]}
[0m19:05:08.297753 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:05:08.378311 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:05:08.519958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:08.520263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:08.523746 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.sequra_analytics.orders_merchant.column_types
[0m19:05:08.545555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d065766-f931-45fe-8df2-9f3cb5bc5a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11105ef90>]}
[0m19:05:08.590164 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m19:05:08.591932 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m19:05:08.604426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d065766-f931-45fe-8df2-9f3cb5bc5a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111292f60>]}
[0m19:05:08.604793 [info ] [MainThread]: Found 7 models, 2 seeds, 11 data tests, 479 macros
[0m19:05:08.605001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d065766-f931-45fe-8df2-9f3cb5bc5a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111229010>]}
[0m19:05:08.606215 [info ] [MainThread]: 
[0m19:05:08.606458 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:05:08.606681 [info ] [MainThread]: 
[0m19:05:08.606965 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:08.609218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m19:05:08.682947 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m19:05:08.683215 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m19:05:08.683361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:11.330616 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.647 seconds
[0m19:05:11.333570 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m19:05:11.419443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now create_SEQURA_DEV_dbt_maximerosa_raw_data)
[0m19:05:11.420073 [debug] [ThreadPool]: Creating schema "database: "SEQURA_DEV"
schema: "dbt_maximerosa_raw_data"
"
[0m19:05:11.425467 [debug] [ThreadPool]: Using snowflake connection "create_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m19:05:11.425884 [debug] [ThreadPool]: On create_SEQURA_DEV_dbt_maximerosa_raw_data: create schema if not exists SEQURA_DEV.dbt_maximerosa_raw_data
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "create_SEQURA_DEV_dbt_maximerosa_raw_data"} */
[0m19:05:11.426143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:13.929825 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.504 seconds
[0m19:05:13.931365 [debug] [ThreadPool]: On create_SEQURA_DEV_dbt_maximerosa_raw_data: Close
[0m19:05:14.013408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_SEQURA_DEV_dbt_maximerosa_raw_data, now list_SEQURA_DEV_dbt_maximerosa_intermediate)
[0m19:05:14.014012 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_staging'
[0m19:05:14.015177 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_marts'
[0m19:05:14.027361 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m19:05:14.028110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_raw_data'
[0m19:05:14.030469 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m19:05:14.032534 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m19:05:14.032845 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m19:05:14.035489 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m19:05:14.035733 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m19:05:14.035962 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m19:05:14.036313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:14.036700 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m19:05:14.036942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:14.037148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:14.037467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:16.305859 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.269 seconds
[0m19:05:16.307815 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: Close
[0m19:05:16.316619 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.280 seconds
[0m19:05:16.317293 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.280 seconds
[0m19:05:16.318808 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m19:05:16.320276 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: Close
[0m19:05:16.324650 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.287 seconds
[0m19:05:16.326178 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: Close
[0m19:05:16.396217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d065766-f931-45fe-8df2-9f3cb5bc5a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113379970>]}
[0m19:05:16.399918 [debug] [Thread-7 (]: Began running node seed.sequra_analytics.merchants
[0m19:05:16.400357 [debug] [Thread-8 (]: Began running node seed.sequra_analytics.orders_merchant
[0m19:05:16.400870 [info ] [Thread-7 (]: 1 of 2 START seed file dbt_maximerosa_raw_data.merchants ....................... [RUN]
[0m19:05:16.401361 [info ] [Thread-8 (]: 2 of 2 START seed file dbt_maximerosa_raw_data.orders_merchant ................. [RUN]
[0m19:05:16.401821 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_intermediate, now seed.sequra_analytics.merchants)
[0m19:05:16.402176 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now seed.sequra_analytics.orders_merchant)
[0m19:05:16.402506 [debug] [Thread-7 (]: Began compiling node seed.sequra_analytics.merchants
[0m19:05:16.402813 [debug] [Thread-8 (]: Began compiling node seed.sequra_analytics.orders_merchant
[0m19:05:16.403135 [debug] [Thread-7 (]: Began executing node seed.sequra_analytics.merchants
[0m19:05:16.403385 [debug] [Thread-8 (]: Began executing node seed.sequra_analytics.orders_merchant
[0m19:05:16.431238 [debug] [Thread-8 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m19:05:16.431561 [debug] [Thread-8 (]: On seed.sequra_analytics.orders_merchant: create table SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant (order_id integer,shopper_id integer,merchant_id integer,order_date text)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m19:05:16.431784 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m19:05:16.432476 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m19:05:16.432935 [debug] [Thread-7 (]: On seed.sequra_analytics.merchants: create table SEQURA_DEV.dbt_maximerosa_raw_data.merchants (merchant_id integer,merchant_name text)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m19:05:16.433202 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m19:05:18.913444 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.481 seconds
[0m19:05:18.926668 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.493 seconds
[0m19:05:18.929602 [debug] [Thread-8 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m19:05:18.931022 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m19:05:18.931369 [debug] [Thread-8 (]: On seed.sequra_analytics.orders_merchant: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m19:05:18.931667 [debug] [Thread-7 (]: On seed.sequra_analytics.merchants: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m19:05:19.006016 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m19:05:19.006986 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m19:05:19.007320 [debug] [Thread-7 (]: On seed.sequra_analytics.merchants: insert into SEQURA_DEV.dbt_maximerosa_raw_data.merchants (merchant_id, merchant_name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */...
[0m19:05:19.026135 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m19:05:19.027882 [debug] [Thread-8 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m19:05:19.028229 [debug] [Thread-8 (]: On seed.sequra_analytics.orders_merchant: insert into SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant (order_id, shopper_id, merchant_id, order_date) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version":...
[0m19:05:19.938314 [debug] [Thread-7 (]: SQL status: SUCCESS 6 in 0.931 seconds
[0m19:05:19.939039 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m19:05:19.939279 [debug] [Thread-7 (]: On seed.sequra_analytics.merchants: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m19:05:19.941151 [debug] [Thread-8 (]: SQL status: SUCCESS 25 in 0.913 seconds
[0m19:05:19.941723 [debug] [Thread-8 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m19:05:19.942437 [debug] [Thread-8 (]: On seed.sequra_analytics.orders_merchant: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m19:05:20.223951 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.281 seconds
[0m19:05:20.228171 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.sequra_analytics.orders_merchant"
[0m19:05:20.228805 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.289 seconds
[0m19:05:20.229149 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.sequra_analytics.merchants"
[0m19:05:20.244216 [debug] [Thread-8 (]: On seed.sequra_analytics.orders_merchant: Close
[0m19:05:20.246112 [debug] [Thread-7 (]: On seed.sequra_analytics.merchants: Close
[0m19:05:20.316434 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d065766-f931-45fe-8df2-9f3cb5bc5a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d7d40>]}
[0m19:05:20.316704 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d065766-f931-45fe-8df2-9f3cb5bc5a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103322f30>]}
[0m19:05:20.317017 [info ] [Thread-7 (]: 1 of 2 OK loaded seed file dbt_maximerosa_raw_data.merchants ................... [[32mINSERT 6[0m in 3.91s]
[0m19:05:20.317310 [info ] [Thread-8 (]: 2 of 2 OK loaded seed file dbt_maximerosa_raw_data.orders_merchant ............. [[32mINSERT 25[0m in 3.91s]
[0m19:05:20.317599 [debug] [Thread-7 (]: Finished running node seed.sequra_analytics.merchants
[0m19:05:20.317826 [debug] [Thread-8 (]: Finished running node seed.sequra_analytics.orders_merchant
[0m19:05:20.318547 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:20.318737 [debug] [MainThread]: Connection 'seed.sequra_analytics.merchants' was properly closed.
[0m19:05:20.318868 [debug] [MainThread]: Connection 'seed.sequra_analytics.orders_merchant' was properly closed.
[0m19:05:20.318987 [debug] [MainThread]: Connection 'list_SEQURA_DEV_dbt_maximerosa_marts' was properly closed.
[0m19:05:20.319099 [debug] [MainThread]: Connection 'list_SEQURA_DEV_dbt_maximerosa_raw_data' was properly closed.
[0m19:05:20.319241 [info ] [MainThread]: 
[0m19:05:20.319387 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 11.71 seconds (11.71s).
[0m19:05:20.320275 [debug] [MainThread]: Command end result
[0m19:05:20.338025 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m19:05:20.339823 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m19:05:20.343445 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/run_results.json
[0m19:05:20.343636 [info ] [MainThread]: 
[0m19:05:20.343842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:20.343986 [info ] [MainThread]: 
[0m19:05:20.344153 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m19:05:20.345946 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 12.428925, "process_in_blocks": "0", "process_kernel_time": 0.335208, "process_mem_max_rss": "166592512", "process_out_blocks": "0", "process_user_time": 1.856449}
[0m19:05:20.346261 [debug] [MainThread]: Command `dbt seed` succeeded at 19:05:20.346216 after 12.43 seconds
[0m19:05:20.346448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b156a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b157f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b15700>]}
[0m19:05:20.346634 [debug] [MainThread]: Flushing usage events
[0m19:05:20.725810 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:24.561771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac158e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac155b0>]}


============================== 19:05:24.564685 | b165ab36-678c-42d1-95aa-0088e79a2ae9 ==============================
[0m19:05:24.564685 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:05:24.565021 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics', 'warn_error': 'None', 'static_parser': 'True', 'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'version_check': 'True', 'empty': 'False', 'fail_fast': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'log_cache_events': 'False'}
[0m19:05:24.863622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b165ab36-678c-42d1-95aa-0088e79a2ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc87080>]}
[0m19:05:24.894801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b165ab36-678c-42d1-95aa-0088e79a2ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acfacc0>]}
[0m19:05:24.897318 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:05:24.978634 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:05:25.128866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:25.129131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:25.132309 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.sequra_analytics.orders_merchant.column_types
[0m19:05:25.153544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b165ab36-678c-42d1-95aa-0088e79a2ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abcd4f0>]}
[0m19:05:25.197761 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m19:05:25.204190 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m19:05:25.225216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b165ab36-678c-42d1-95aa-0088e79a2ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abcd760>]}
[0m19:05:25.225577 [info ] [MainThread]: Found 7 models, 2 seeds, 11 data tests, 479 macros
[0m19:05:25.225765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b165ab36-678c-42d1-95aa-0088e79a2ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be30f20>]}
[0m19:05:25.227009 [info ] [MainThread]: 
[0m19:05:25.227250 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:05:25.227402 [info ] [MainThread]: 
[0m19:05:25.227669 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:25.230313 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m19:05:25.238276 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m19:05:25.238744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m19:05:25.306841 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m19:05:25.307201 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m19:05:25.307388 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m19:05:25.307597 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m19:05:25.307761 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m19:05:25.307913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:25.308057 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m19:05:25.308192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:25.308386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:28.023279 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.715 seconds
[0m19:05:28.024409 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.716 seconds
[0m19:05:28.026869 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m19:05:28.027531 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.720 seconds
[0m19:05:28.029061 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m19:05:28.031675 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m19:05:28.117103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_staging)
[0m19:05:28.117661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_marts)
[0m19:05:28.119326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_raw_data)
[0m19:05:28.119825 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate'
[0m19:05:28.131030 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m19:05:28.132840 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m19:05:28.134404 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m19:05:28.136236 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m19:05:28.136502 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m19:05:28.136738 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m19:05:28.136958 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m19:05:28.137170 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m19:05:28.137381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:28.137567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:28.137750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:28.138004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:30.467695 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.330 seconds
[0m19:05:30.469537 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: Close
[0m19:05:30.585883 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.448 seconds
[0m19:05:30.588130 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: Close
[0m19:05:30.601111 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.463 seconds
[0m19:05:30.602033 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.464 seconds
[0m19:05:30.603984 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: Close
[0m19:05:30.605345 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m19:05:30.679710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b165ab36-678c-42d1-95aa-0088e79a2ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cca7170>]}
[0m19:05:30.684600 [debug] [Thread-8 (]: Began running node model.sequra_analytics.stg_merchants
[0m19:05:30.685014 [debug] [Thread-9 (]: Began running node model.sequra_analytics.stg_orders
[0m19:05:30.685450 [info ] [Thread-8 (]: 1 of 7 START sql view model dbt_maximerosa_staging.stg_merchants ............... [RUN]
[0m19:05:30.685914 [info ] [Thread-9 (]: 2 of 7 START sql view model dbt_maximerosa_staging.stg_orders .................. [RUN]
[0m19:05:30.686327 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now model.sequra_analytics.stg_merchants)
[0m19:05:30.686645 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now model.sequra_analytics.stg_orders)
[0m19:05:30.686900 [debug] [Thread-8 (]: Began compiling node model.sequra_analytics.stg_merchants
[0m19:05:30.687129 [debug] [Thread-9 (]: Began compiling node model.sequra_analytics.stg_orders
[0m19:05:30.693317 [debug] [Thread-9 (]: Writing injected SQL for node "model.sequra_analytics.stg_orders"
[0m19:05:30.695647 [debug] [Thread-8 (]: Writing injected SQL for node "model.sequra_analytics.stg_merchants"
[0m19:05:30.697893 [debug] [Thread-9 (]: Began executing node model.sequra_analytics.stg_orders
[0m19:05:30.698249 [debug] [Thread-8 (]: Began executing node model.sequra_analytics.stg_merchants
[0m19:05:30.724325 [debug] [Thread-9 (]: Writing runtime sql for node "model.sequra_analytics.stg_orders"
[0m19:05:30.721028 [debug] [Thread-8 (]: Writing runtime sql for node "model.sequra_analytics.stg_merchants"
[0m19:05:30.725530 [debug] [Thread-8 (]: Using snowflake connection "model.sequra_analytics.stg_merchants"
[0m19:05:30.726342 [debug] [Thread-9 (]: Using snowflake connection "model.sequra_analytics.stg_orders"
[0m19:05:30.726602 [debug] [Thread-8 (]: On model.sequra_analytics.stg_merchants: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
  
  
  
  
  as (
    

select
    merchant_id,
    merchant_name
from SEQURA_DEV.dbt_maximerosa_raw_data.merchants
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_merchants"} */;
[0m19:05:30.726853 [debug] [Thread-9 (]: On model.sequra_analytics.stg_orders: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders
  
  
  
  
  as (
    

with source_data as (
    select
        order_id,
        shopper_id,
        merchant_id,
        order_date as order_date_raw,
        -- Parse the date format (d/m/yy or dd/mm/yy)
        case 
            when split_part(order_date, '/', 3) = '22' then '2022'
            when split_part(order_date, '/', 3) = '23' then '2023'
            else '20' || split_part(order_date, '/', 3)
        end || '-' ||
        lpad(split_part(order_date, '/', 2), 2, '0') || '-' ||
        lpad(split_part(order_date, '/', 1), 2, '0') as order_date_formatted
    from SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant
)

select
    order_id,
    shopper_id,
    merchant_id,
    order_date_raw,
    to_date(order_date_formatted, 'YYYY-MM-DD') as order_date,
    date_trunc('month', to_date(order_date_formatted, 'YYYY-MM-DD')) as order_month,
    to_char(to_date(order_date_formatted, 'YYYY-MM-DD'), 'YYYY-MM') as month_year
from source_data
where order_date_raw is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders"} */;
[0m19:05:30.727080 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m19:05:30.727245 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m19:05:33.246625 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.519 seconds
[0m19:05:33.264042 [debug] [Thread-8 (]: On model.sequra_analytics.stg_merchants: Close
[0m19:05:33.264814 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.537 seconds
[0m19:05:33.266138 [debug] [Thread-9 (]: On model.sequra_analytics.stg_orders: Close
[0m19:05:33.344045 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b165ab36-678c-42d1-95aa-0088e79a2ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cce01a0>]}
[0m19:05:33.344442 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b165ab36-678c-42d1-95aa-0088e79a2ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb7e60>]}
[0m19:05:33.345013 [info ] [Thread-9 (]: 2 of 7 OK created sql view model dbt_maximerosa_staging.stg_orders ............. [[32mSUCCESS 1[0m in 2.65s]
[0m19:05:33.345591 [info ] [Thread-8 (]: 1 of 7 OK created sql view model dbt_maximerosa_staging.stg_merchants .......... [[32mSUCCESS 1[0m in 2.66s]
[0m19:05:33.346208 [debug] [Thread-9 (]: Finished running node model.sequra_analytics.stg_orders
[0m19:05:33.346587 [debug] [Thread-8 (]: Finished running node model.sequra_analytics.stg_merchants
[0m19:05:33.347302 [debug] [Thread-11 ]: Began running node model.sequra_analytics.int_monthly_shoppers
[0m19:05:33.347695 [debug] [Thread-10 ]: Began running node model.sequra_analytics.int_recurrent_shoppers
[0m19:05:33.348143 [info ] [Thread-11 ]: 3 of 7 START sql view model dbt_maximerosa_intermediate.int_monthly_shoppers ... [RUN]
[0m19:05:33.348490 [debug] [Thread-9 (]: Began running node model.sequra_analytics.default_ratio_analysis
[0m19:05:33.348819 [info ] [Thread-10 ]: 4 of 7 START sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers . [RUN]
[0m19:05:33.349178 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_intermediate, now model.sequra_analytics.int_monthly_shoppers)
[0m19:05:33.349447 [debug] [Thread-8 (]: Began running node model.sequra_analytics.int_orders_with_defaults
[0m19:05:33.349767 [info ] [Thread-9 (]: 5 of 7 START sql table model dbt_maximerosa_marts.default_ratio_analysis ....... [RUN]
[0m19:05:33.350059 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_raw_data, now model.sequra_analytics.int_recurrent_shoppers)
[0m19:05:33.350429 [debug] [Thread-11 ]: Began compiling node model.sequra_analytics.int_monthly_shoppers
[0m19:05:33.350857 [info ] [Thread-8 (]: 6 of 7 START sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [RUN]
[0m19:05:33.351249 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders, now model.sequra_analytics.default_ratio_analysis)
[0m19:05:33.351508 [debug] [Thread-10 ]: Began compiling node model.sequra_analytics.int_recurrent_shoppers
[0m19:05:33.354336 [debug] [Thread-11 ]: Writing injected SQL for node "model.sequra_analytics.int_monthly_shoppers"
[0m19:05:33.354701 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_merchants, now model.sequra_analytics.int_orders_with_defaults)
[0m19:05:33.354951 [debug] [Thread-9 (]: Began compiling node model.sequra_analytics.default_ratio_analysis
[0m19:05:33.357355 [debug] [Thread-10 ]: Writing injected SQL for node "model.sequra_analytics.int_recurrent_shoppers"
[0m19:05:33.357790 [debug] [Thread-8 (]: Began compiling node model.sequra_analytics.int_orders_with_defaults
[0m19:05:33.361153 [debug] [Thread-9 (]: Writing injected SQL for node "model.sequra_analytics.default_ratio_analysis"
[0m19:05:33.363700 [debug] [Thread-8 (]: Writing injected SQL for node "model.sequra_analytics.int_orders_with_defaults"
[0m19:05:33.364245 [debug] [Thread-11 ]: Began executing node model.sequra_analytics.int_monthly_shoppers
[0m19:05:33.366127 [debug] [Thread-11 ]: Writing runtime sql for node "model.sequra_analytics.int_monthly_shoppers"
[0m19:05:33.366476 [debug] [Thread-10 ]: Began executing node model.sequra_analytics.int_recurrent_shoppers
[0m19:05:33.368352 [debug] [Thread-10 ]: Writing runtime sql for node "model.sequra_analytics.int_recurrent_shoppers"
[0m19:05:33.368698 [debug] [Thread-9 (]: Began executing node model.sequra_analytics.default_ratio_analysis
[0m19:05:33.381749 [debug] [Thread-10 ]: Using snowflake connection "model.sequra_analytics.int_recurrent_shoppers"
[0m19:05:33.382097 [debug] [Thread-8 (]: Began executing node model.sequra_analytics.int_orders_with_defaults
[0m19:05:33.384777 [debug] [Thread-9 (]: Writing runtime sql for node "model.sequra_analytics.default_ratio_analysis"
[0m19:05:33.385295 [debug] [Thread-11 ]: Using snowflake connection "model.sequra_analytics.int_monthly_shoppers"
[0m19:05:33.385581 [debug] [Thread-10 ]: On model.sequra_analytics.int_recurrent_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers
  
  
  
  
  as (
    

with order_history as (
    select
        o1.order_month as current_month,
        o1.month_year as current_month_year,
        o1.merchant_id,
        o1.shopper_id,
        count(distinct o2.order_month) as months_with_purchases
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o1
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_orders o2
        on o1.merchant_id = o2.merchant_id
        and o1.shopper_id = o2.shopper_id
        and o2.order_date between dateadd(month, -11, o1.order_month) and last_day(o1.order_month)
        and o2.order_month <= o1.order_month
    group by 1, 2, 3, 4
)

select
    current_month,
    current_month_year,
    merchant_id,
    shopper_id,
    months_with_purchases,
    -- A shopper is recurrent if they have made purchases in at least 2 different months
    -- within the 12-month window including the current month
    case 
        when months_with_purchases >= 2 then 1 
        else 0 
    end as is_recurrent
from order_history
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_recurrent_shoppers"} */;
[0m19:05:33.387297 [debug] [Thread-8 (]: Writing runtime sql for node "model.sequra_analytics.int_orders_with_defaults"
[0m19:05:33.387704 [debug] [Thread-11 ]: On model.sequra_analytics.int_monthly_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers
  
  
  
  
  as (
    

with monthly_orders as (
    select distinct
        order_month,
        month_year,
        merchant_id,
        shopper_id
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
)

select
    order_month,
    month_year,
    merchant_id,
    shopper_id
from monthly_orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_monthly_shoppers"} */;
[0m19:05:33.387993 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m19:05:33.388308 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m19:05:33.389886 [debug] [Thread-9 (]: Using snowflake connection "model.sequra_analytics.default_ratio_analysis"
[0m19:05:33.390959 [debug] [Thread-8 (]: Using snowflake connection "model.sequra_analytics.int_orders_with_defaults"
[0m19:05:33.391235 [debug] [Thread-9 (]: On model.sequra_analytics.default_ratio_analysis: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.default_ratio_analysis
    
    
    
    as (

-- This model calculates the default ratio as requested in Part 2

with orders_with_defaults as (
    -- This would come from the actual orders table with financial data
    select
        o.*,
        m.merchant_name as merchant,
        -- These fields would come from the actual source data:
        null::integer as shopper_age,
        null::varchar as product,
        null::boolean as is_in_default,
        null::integer as days_unbalanced,
        null::decimal(15,2) as current_order_value,
        null::decimal(15,2) as overdue_amount
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
),

-- Calculate delayed periods based on days_unbalanced
-- An order with 35 days unbalanced is included in both 17 and 30 day calculations
delayed_period_17 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '17' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 17
        and is_in_default = true
),

delayed_period_30 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '30' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 30
        and is_in_default = true
),

delayed_period_60 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '60' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 60
        and is_in_default = true
),

delayed_period_90 as (
    select
        shopper_age,
        month_year as month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '90' as delayed_period
    from orders_with_defaults
    where days_unbalanced > 90
        and is_in_default = true
),

-- Union all delayed periods
all_defaults as (
    select * from delayed_period_17
    union all
    select * from delayed_period_30
    union all
    select * from delayed_period_60
    union all
    select * from delayed_period_90
)

-- Final output with the exact columns requested
select
    shopper_age,
    month_year_order,
    product,
    merchant,
    default_type,
    delayed_period
from all_defaults
order by 
    month_year_order,
    merchant,
    delayed_period::integer
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.default_ratio_analysis"} */;
[0m19:05:33.391694 [debug] [Thread-8 (]: On model.sequra_analytics.int_orders_with_defaults: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
  
  
  
  
  as (
    

-- Placeholder for Part 2 of the challenge
-- This would contain the logic for calculating default ratios
-- when the additional data tables are available

with orders_base as (
    select
        o.*,
        m.merchant_name,
        -- Placeholder fields for default calculation
        -- These would come from the actual orders table with financial data
        null::boolean as is_in_default,
        null::integer as days_unbalanced,
        null::decimal(15,2) as current_order_value,
        null::decimal(15,2) as overdue_amount,
        null::varchar as product,
        null::integer as shopper_age
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
)

select
    *,
    case
        when days_unbalanced > 90 then '90+'
        when days_unbalanced > 60 then '60'
        when days_unbalanced > 30 then '30'
        when days_unbalanced > 17 then '17'
        else null
    end as delayed_period
from orders_base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_orders_with_defaults"} */;
[0m19:05:33.392029 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m19:05:33.392370 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m19:05:35.917008 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.528 seconds
[0m19:05:35.917629 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.530 seconds
[0m19:05:35.919271 [debug] [Thread-11 ]: On model.sequra_analytics.int_monthly_shoppers: Close
[0m19:05:35.920396 [debug] [Thread-10 ]: On model.sequra_analytics.int_recurrent_shoppers: Close
[0m19:05:35.931044 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.539 seconds
[0m19:05:35.932632 [debug] [Thread-8 (]: On model.sequra_analytics.int_orders_with_defaults: Close
[0m19:05:35.991141 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b165ab36-678c-42d1-95aa-0088e79a2ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a586b0>]}
[0m19:05:35.991957 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b165ab36-678c-42d1-95aa-0088e79a2ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118aa2b70>]}
[0m19:05:35.992820 [info ] [Thread-10 ]: 4 of 7 OK created sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers  [[32mSUCCESS 1[0m in 2.64s]
[0m19:05:35.993531 [info ] [Thread-11 ]: 3 of 7 OK created sql view model dbt_maximerosa_intermediate.int_monthly_shoppers  [[32mSUCCESS 1[0m in 2.64s]
[0m19:05:35.994021 [debug] [Thread-10 ]: Finished running node model.sequra_analytics.int_recurrent_shoppers
[0m19:05:35.994372 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.int_monthly_shoppers
[0m19:05:35.994861 [debug] [Thread-10 ]: Began running node model.sequra_analytics.shopper_recurrence_rate
[0m19:05:35.995232 [info ] [Thread-10 ]: 7 of 7 START sql table model dbt_maximerosa_marts.shopper_recurrence_rate ...... [RUN]
[0m19:05:35.995931 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_recurrent_shoppers, now model.sequra_analytics.shopper_recurrence_rate)
[0m19:05:35.996405 [debug] [Thread-10 ]: Began compiling node model.sequra_analytics.shopper_recurrence_rate
[0m19:05:36.000833 [debug] [Thread-10 ]: Writing injected SQL for node "model.sequra_analytics.shopper_recurrence_rate"
[0m19:05:36.005991 [debug] [Thread-10 ]: Began executing node model.sequra_analytics.shopper_recurrence_rate
[0m19:05:36.008828 [debug] [Thread-10 ]: Writing runtime sql for node "model.sequra_analytics.shopper_recurrence_rate"
[0m19:05:36.011640 [debug] [Thread-10 ]: Using snowflake connection "model.sequra_analytics.shopper_recurrence_rate"
[0m19:05:36.012169 [debug] [Thread-10 ]: On model.sequra_analytics.shopper_recurrence_rate: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
    
    
    
    as (

with monthly_metrics as (
    select
        ms.order_month,
        ms.month_year,
        ms.merchant_id,
        m.merchant_name,
        count(distinct ms.shopper_id) as total_shoppers,
        sum(rs.is_recurrent) as recurrent_shoppers
    from SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers ms
    left join SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers rs
        on ms.order_month = rs.current_month
        and ms.merchant_id = rs.merchant_id
        and ms.shopper_id = rs.shopper_id
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on ms.merchant_id = m.merchant_id
    group by 1, 2, 3, 4
)

select
    merchant_name,
    month_year as month,
    round(
        case 
            when total_shoppers > 0 
            then (recurrent_shoppers::decimal / total_shoppers) * 100
            else 0 
        end, 2
    ) as recurrence_rate
from monthly_metrics
order by merchant_name, month
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.shopper_recurrence_rate"} */;
[0m19:05:36.012553 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m19:05:36.013112 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b165ab36-678c-42d1-95aa-0088e79a2ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a02ae0>]}
[0m19:05:36.014233 [info ] [Thread-8 (]: 6 of 7 OK created sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [[32mSUCCESS 1[0m in 2.66s]
[0m19:05:36.015111 [debug] [Thread-8 (]: Finished running node model.sequra_analytics.int_orders_with_defaults
[0m19:05:36.317799 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.926 seconds
[0m19:05:36.320336 [debug] [Thread-9 (]: On model.sequra_analytics.default_ratio_analysis: Close
[0m19:05:36.388359 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b165ab36-678c-42d1-95aa-0088e79a2ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a87fb0>]}
[0m19:05:36.389224 [info ] [Thread-9 (]: 5 of 7 OK created sql table model dbt_maximerosa_marts.default_ratio_analysis .. [[32mSUCCESS 1[0m in 3.04s]
[0m19:05:36.389757 [debug] [Thread-9 (]: Finished running node model.sequra_analytics.default_ratio_analysis
[0m19:05:39.391642 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.379 seconds
[0m19:05:39.394335 [debug] [Thread-10 ]: On model.sequra_analytics.shopper_recurrence_rate: Close
[0m19:05:39.473521 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b165ab36-678c-42d1-95aa-0088e79a2ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107809220>]}
[0m19:05:39.474421 [info ] [Thread-10 ]: 7 of 7 OK created sql table model dbt_maximerosa_marts.shopper_recurrence_rate . [[32mSUCCESS 1[0m in 3.48s]
[0m19:05:39.475017 [debug] [Thread-10 ]: Finished running node model.sequra_analytics.shopper_recurrence_rate
[0m19:05:39.476705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:39.477218 [debug] [MainThread]: Connection 'model.sequra_analytics.int_orders_with_defaults' was properly closed.
[0m19:05:39.477469 [debug] [MainThread]: Connection 'model.sequra_analytics.default_ratio_analysis' was properly closed.
[0m19:05:39.477693 [debug] [MainThread]: Connection 'model.sequra_analytics.shopper_recurrence_rate' was properly closed.
[0m19:05:39.477923 [debug] [MainThread]: Connection 'model.sequra_analytics.int_monthly_shoppers' was properly closed.
[0m19:05:39.478400 [info ] [MainThread]: 
[0m19:05:39.478937 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 14.25 seconds (14.25s).
[0m19:05:39.480478 [debug] [MainThread]: Command end result
[0m19:05:39.508186 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m19:05:39.511204 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m19:05:39.517263 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/run_results.json
[0m19:05:39.517626 [info ] [MainThread]: 
[0m19:05:39.517911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:39.518139 [info ] [MainThread]: 
[0m19:05:39.518363 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m19:05:39.521764 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.997627, "process_in_blocks": "0", "process_kernel_time": 0.458528, "process_mem_max_rss": "178012160", "process_out_blocks": "0", "process_user_time": 2.16495}
[0m19:05:39.522189 [debug] [MainThread]: Command `dbt run` succeeded at 19:05:39.522114 after 15.00 seconds
[0m19:05:39.522466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac156d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb6e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ded5e0>]}
[0m19:05:39.522737 [debug] [MainThread]: Flushing usage events
[0m19:05:40.002435 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:24.486781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040395b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d15760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d15430>]}


============================== 19:59:24.490319 | 8ab27af0-2ab9-4919-a0ae-91b8c0257e16 ==============================
[0m19:59:24.490319 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:59:24.490693 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'printer_width': '80', 'debug': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt seed', 'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:59:24.887895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ab27af0-2ab9-4919-a0ae-91b8c0257e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e3ec0>]}
[0m19:59:24.919056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ab27af0-2ab9-4919-a0ae-91b8c0257e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a076e10>]}
[0m19:59:24.920322 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:59:24.995198 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:59:25.135533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:59:25.135821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:59:25.138967 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.sequra_analytics.dim_shoppers.column_types
- seeds.sequra_analytics.orders_financial.column_types
[0m19:59:25.160900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ab27af0-2ab9-4919-a0ae-91b8c0257e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3328d0>]}
[0m19:59:25.205204 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m19:59:25.214427 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m19:59:25.247620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ab27af0-2ab9-4919-a0ae-91b8c0257e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4621b0>]}
[0m19:59:25.247956 [info ] [MainThread]: Found 9 models, 4 seeds, 11 data tests, 479 macros
[0m19:59:25.248139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ab27af0-2ab9-4919-a0ae-91b8c0257e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a568f80>]}
[0m19:59:25.249355 [info ] [MainThread]: 
[0m19:59:25.249546 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:59:25.249681 [info ] [MainThread]: 
[0m19:59:25.249940 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:59:25.252240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m19:59:25.331306 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m19:59:25.331590 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m19:59:25.331754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:28.118808 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.786 seconds
[0m19:59:28.122282 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m19:59:28.203781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now create_SEQURA_DEV_dbt_maximerosa)
[0m19:59:28.204519 [debug] [ThreadPool]: Creating schema "database: "SEQURA_DEV"
schema: "dbt_maximerosa"
"
[0m19:59:28.210739 [debug] [ThreadPool]: Using snowflake connection "create_SEQURA_DEV_dbt_maximerosa"
[0m19:59:28.211222 [debug] [ThreadPool]: On create_SEQURA_DEV_dbt_maximerosa: create schema if not exists SEQURA_DEV.dbt_maximerosa
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "create_SEQURA_DEV_dbt_maximerosa"} */
[0m19:59:28.211490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:30.640017 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.428 seconds
[0m19:59:30.641256 [debug] [ThreadPool]: On create_SEQURA_DEV_dbt_maximerosa: Close
[0m19:59:30.733720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_SEQURA_DEV_dbt_maximerosa, now list_SEQURA_DEV_dbt_maximerosa_intermediate)
[0m19:59:30.734707 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_staging'
[0m19:59:30.736330 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa'
[0m19:59:30.748290 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m19:59:30.748932 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_marts'
[0m19:59:30.751045 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m19:59:30.754275 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa"
[0m19:59:30.754603 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m19:59:30.756367 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m19:59:30.756616 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m19:59:30.756889 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa: show objects in SEQURA_DEV.dbt_maximerosa
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa"} */;
[0m19:59:30.757149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:30.757374 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m19:59:30.757589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:30.757777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:30.758062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:33.054468 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.297 seconds
[0m19:59:33.056257 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: Close
[0m19:59:33.128284 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.370 seconds
[0m19:59:33.129752 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa: Close
[0m19:59:33.142215 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.385 seconds
[0m19:59:33.144006 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m19:59:33.146651 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.389 seconds
[0m19:59:33.147857 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: Close
[0m19:59:33.503436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ab27af0-2ab9-4919-a0ae-91b8c0257e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4629f0>]}
[0m19:59:33.507405 [debug] [Thread-7 (]: Began running node seed.sequra_analytics.dim_shoppers
[0m19:59:33.507823 [debug] [Thread-8 (]: Began running node seed.sequra_analytics.merchants
[0m19:59:33.508165 [debug] [Thread-9 (]: Began running node seed.sequra_analytics.orders_financial
[0m19:59:33.508962 [debug] [Thread-10 ]: Began running node seed.sequra_analytics.orders_merchant
[0m19:59:33.508662 [info ] [Thread-7 (]: 1 of 4 START seed file dbt_maximerosa.dim_shoppers ............................. [RUN]
[0m19:59:33.509514 [info ] [Thread-8 (]: 2 of 4 START seed file dbt_maximerosa.merchants ................................ [RUN]
[0m19:59:33.510029 [info ] [Thread-9 (]: 3 of 4 START seed file dbt_maximerosa.orders_financial ......................... [RUN]
[0m19:59:33.510448 [info ] [Thread-10 ]: 4 of 4 START seed file dbt_maximerosa.orders_merchant .......................... [RUN]
[0m19:59:33.510902 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_intermediate, now seed.sequra_analytics.dim_shoppers)
[0m19:59:33.511270 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now seed.sequra_analytics.merchants)
[0m19:59:33.511573 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa, now seed.sequra_analytics.orders_financial)
[0m19:59:33.511874 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now seed.sequra_analytics.orders_merchant)
[0m19:59:33.512173 [debug] [Thread-7 (]: Began compiling node seed.sequra_analytics.dim_shoppers
[0m19:59:33.512445 [debug] [Thread-8 (]: Began compiling node seed.sequra_analytics.merchants
[0m19:59:33.512742 [debug] [Thread-9 (]: Began compiling node seed.sequra_analytics.orders_financial
[0m19:59:33.513048 [debug] [Thread-10 ]: Began compiling node seed.sequra_analytics.orders_merchant
[0m19:59:33.513381 [debug] [Thread-7 (]: Began executing node seed.sequra_analytics.dim_shoppers
[0m19:59:33.513691 [debug] [Thread-8 (]: Began executing node seed.sequra_analytics.merchants
[0m19:59:33.514014 [debug] [Thread-9 (]: Began executing node seed.sequra_analytics.orders_financial
[0m19:59:33.514319 [debug] [Thread-10 ]: Began executing node seed.sequra_analytics.orders_merchant
[0m19:59:33.551709 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m19:59:33.552482 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m19:59:33.555512 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m19:59:33.555781 [debug] [Thread-7 (]: On seed.sequra_analytics.dim_shoppers: create table SEQURA_DEV.dbt_maximerosa.dim_shoppers (shopper_id integer,age integer)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */
[0m19:59:33.556425 [debug] [Thread-8 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m19:59:33.556668 [debug] [Thread-10 ]: On seed.sequra_analytics.orders_merchant: create table SEQURA_DEV.dbt_maximerosa.orders_merchant (order_id integer,shopper_id integer,merchant_id integer,order_date text)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m19:59:33.556883 [debug] [Thread-9 (]: On seed.sequra_analytics.orders_financial: create table SEQURA_DEV.dbt_maximerosa.orders_financial (order_id integer,shopper_id integer,order_date date,product_id integer,merchant_id integer,is_in_default boolean,days_unbalanced integer,current_order_value integer,overdue_principal integer,overdue_fees float8)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */
[0m19:59:33.557080 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m19:59:33.557260 [debug] [Thread-8 (]: On seed.sequra_analytics.merchants: create table SEQURA_DEV.dbt_maximerosa.merchants (merchant_id integer,merchant_name text)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m19:59:33.557432 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m19:59:33.557594 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m19:59:33.557838 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m19:59:36.254757 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.693 seconds
[0m19:59:36.257558 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.700 seconds
[0m19:59:36.270718 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m19:59:36.271311 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.714 seconds
[0m19:59:36.272495 [debug] [Thread-8 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m19:59:36.272842 [debug] [Thread-9 (]: On seed.sequra_analytics.orders_financial: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */
[0m19:59:36.273373 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.716 seconds
[0m19:59:36.274593 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m19:59:36.274895 [debug] [Thread-8 (]: On seed.sequra_analytics.merchants: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m19:59:36.276131 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m19:59:36.276635 [debug] [Thread-10 ]: On seed.sequra_analytics.orders_merchant: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m19:59:36.278044 [debug] [Thread-7 (]: On seed.sequra_analytics.dim_shoppers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */
[0m19:59:36.451903 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.174 seconds
[0m19:59:36.453480 [debug] [Thread-8 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m19:59:36.454539 [debug] [Thread-8 (]: On seed.sequra_analytics.merchants: insert into SEQURA_DEV.dbt_maximerosa.merchants (merchant_id, merchant_name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */...
[0m19:59:36.455416 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.176 seconds
[0m19:59:36.456161 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.178 seconds
[0m19:59:36.457041 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m19:59:36.457696 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m19:59:36.458847 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m19:59:36.461243 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m19:59:36.462117 [debug] [Thread-7 (]: On seed.sequra_analytics.dim_shoppers: insert into SEQURA_DEV.dbt_maximerosa.dim_shoppers (shopper_id, age) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */...
[0m19:59:36.462696 [debug] [Thread-10 ]: On seed.sequra_analytics.orders_merchant: insert into SEQURA_DEV.dbt_maximerosa.orders_merchant (order_id, shopper_id, merchant_id, order_date) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.9"...
[0m19:59:36.463447 [debug] [Thread-9 (]: On seed.sequra_analytics.orders_financial: insert into SEQURA_DEV.dbt_maximerosa.orders_financial (order_id, shopper_id, order_date, product_id, merchant_id, is_in_default, days_unbalanced, current_order_value, overdue_principal, overdue_fees) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,...
[0m19:59:37.156165 [debug] [Thread-8 (]: SQL status: SUCCESS 6 in 0.699 seconds
[0m19:59:37.158514 [debug] [Thread-9 (]: SQL status: SUCCESS 25 in 0.693 seconds
[0m19:59:37.158835 [debug] [Thread-8 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m19:59:37.159097 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m19:59:37.159397 [debug] [Thread-8 (]: On seed.sequra_analytics.merchants: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m19:59:37.159661 [debug] [Thread-9 (]: On seed.sequra_analytics.orders_financial: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */
[0m19:59:37.503009 [debug] [Thread-10 ]: SQL status: SUCCESS 25 in 1.036 seconds
[0m19:59:37.505023 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m19:59:37.508243 [debug] [Thread-10 ]: On seed.sequra_analytics.orders_merchant: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m19:59:37.509381 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.349 seconds
[0m19:59:37.510079 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.350 seconds
[0m19:59:37.511264 [debug] [Thread-7 (]: SQL status: SUCCESS 9 in 1.047 seconds
[0m19:59:37.517840 [debug] [Thread-9 (]: Writing runtime SQL for node "seed.sequra_analytics.orders_financial"
[0m19:59:37.519061 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.sequra_analytics.merchants"
[0m19:59:37.519648 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m19:59:37.520474 [debug] [Thread-7 (]: On seed.sequra_analytics.dim_shoppers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */
[0m19:59:37.543141 [debug] [Thread-9 (]: On seed.sequra_analytics.orders_financial: Close
[0m19:59:37.544771 [debug] [Thread-8 (]: On seed.sequra_analytics.merchants: Close
[0m19:59:37.647958 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab27af0-2ab9-4919-a0ae-91b8c0257e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454af30>]}
[0m19:59:37.648396 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab27af0-2ab9-4919-a0ae-91b8c0257e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d78fb00>]}
[0m19:59:37.648938 [info ] [Thread-9 (]: 3 of 4 OK loaded seed file dbt_maximerosa.orders_financial ..................... [[32mINSERT 25[0m in 4.13s]
[0m19:59:37.649393 [info ] [Thread-8 (]: 2 of 4 OK loaded seed file dbt_maximerosa.merchants ............................ [[32mINSERT 6[0m in 4.14s]
[0m19:59:37.649901 [debug] [Thread-9 (]: Finished running node seed.sequra_analytics.orders_financial
[0m19:59:37.650377 [debug] [Thread-8 (]: Finished running node seed.sequra_analytics.merchants
[0m19:59:37.715897 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m19:59:37.716799 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.sequra_analytics.dim_shoppers"
[0m19:59:37.718985 [debug] [Thread-7 (]: On seed.sequra_analytics.dim_shoppers: Close
[0m19:59:37.727492 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.217 seconds
[0m19:59:37.728312 [debug] [Thread-10 ]: Writing runtime SQL for node "seed.sequra_analytics.orders_merchant"
[0m19:59:37.731643 [debug] [Thread-10 ]: On seed.sequra_analytics.orders_merchant: Close
[0m19:59:37.786367 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab27af0-2ab9-4919-a0ae-91b8c0257e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d81ef00>]}
[0m19:59:37.787230 [info ] [Thread-7 (]: 1 of 4 OK loaded seed file dbt_maximerosa.dim_shoppers ......................... [[32mINSERT 9[0m in 4.28s]
[0m19:59:37.787772 [debug] [Thread-7 (]: Finished running node seed.sequra_analytics.dim_shoppers
[0m19:59:38.030899 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab27af0-2ab9-4919-a0ae-91b8c0257e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d78e1e0>]}
[0m19:59:38.031583 [info ] [Thread-10 ]: 4 of 4 OK loaded seed file dbt_maximerosa.orders_merchant ...................... [[32mINSERT 25[0m in 4.52s]
[0m19:59:38.031970 [debug] [Thread-10 ]: Finished running node seed.sequra_analytics.orders_merchant
[0m19:59:38.033012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:38.033246 [debug] [MainThread]: Connection 'seed.sequra_analytics.dim_shoppers' was properly closed.
[0m19:59:38.033420 [debug] [MainThread]: Connection 'seed.sequra_analytics.merchants' was properly closed.
[0m19:59:38.033591 [debug] [MainThread]: Connection 'seed.sequra_analytics.orders_financial' was properly closed.
[0m19:59:38.033729 [debug] [MainThread]: Connection 'seed.sequra_analytics.orders_merchant' was properly closed.
[0m19:59:38.033921 [info ] [MainThread]: 
[0m19:59:38.034110 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 12.78 seconds (12.78s).
[0m19:59:38.034795 [debug] [MainThread]: Command end result
[0m19:59:38.055564 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m19:59:38.057630 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m19:59:38.061772 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/run_results.json
[0m19:59:38.062016 [info ] [MainThread]: 
[0m19:59:38.062270 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:59:38.062450 [info ] [MainThread]: 
[0m19:59:38.062647 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m19:59:38.064750 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 13.62626, "process_in_blocks": "0", "process_kernel_time": 0.359689, "process_mem_max_rss": "166887424", "process_out_blocks": "0", "process_user_time": 1.988014}
[0m19:59:38.065100 [debug] [MainThread]: Command `dbt seed` succeeded at 19:59:38.065046 after 13.63 seconds
[0m19:59:38.065337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d15580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d15430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d488d10>]}
[0m19:59:38.065576 [debug] [MainThread]: Flushing usage events
[0m19:59:38.645535 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:10.540192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d11af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d11700>]}


============================== 20:00:10.543721 | 60764404-c87c-4ae6-9db5-b283df914de7 ==============================
[0m20:00:10.543721 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:00:10.544102 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'debug': 'False', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'target_path': 'None', 'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics', 'empty': 'False', 'static_parser': 'True', 'printer_width': '80', 'fail_fast': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'quiet': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'write_json': 'True'}
[0m20:00:10.892469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11866a0c0>]}
[0m20:00:10.924888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118182ab0>]}
[0m20:00:10.929377 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:00:11.002904 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:00:11.135547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:11.135820 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:11.139038 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.sequra_analytics.orders_financial.column_types
- seeds.sequra_analytics.dim_shoppers.column_types
[0m20:00:11.160220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d0e1b0>]}
[0m20:00:11.206692 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m20:00:11.213725 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m20:00:11.226694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119064cb0>]}
[0m20:00:11.226992 [info ] [MainThread]: Found 9 models, 4 seeds, 11 data tests, 479 macros
[0m20:00:11.227161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d0fa70>]}
[0m20:00:11.228219 [info ] [MainThread]: 
[0m20:00:11.228408 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:00:11.228547 [info ] [MainThread]: 
[0m20:00:11.228793 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:00:11.231194 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m20:00:11.232274 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m20:00:11.243710 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m20:00:11.309784 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m20:00:11.310157 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m20:00:11.310435 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m20:00:11.310678 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m20:00:11.310940 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m20:00:11.311146 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m20:00:11.311412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:11.311590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:11.311784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:14.379764 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3.068 seconds
[0m20:00:14.380493 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3.069 seconds
[0m20:00:14.382130 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m20:00:14.383445 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m20:00:14.386704 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3.075 seconds
[0m20:00:14.387827 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m20:00:14.457992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_staging)
[0m20:00:14.459162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa)
[0m20:00:14.459483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_marts)
[0m20:00:14.466113 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate'
[0m20:00:14.467057 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m20:00:14.468142 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m20:00:14.465889 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa"
[0m20:00:14.469480 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m20:00:14.469681 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m20:00:14.469839 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m20:00:14.469983 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa: show objects in SEQURA_DEV.dbt_maximerosa
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa"} */;
[0m20:00:14.470123 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m20:00:14.470295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:14.470482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:14.470628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:14.470858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:16.783993 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.313 seconds
[0m20:00:16.786661 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m20:00:16.794895 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.325 seconds
[0m20:00:16.795498 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.325 seconds
[0m20:00:16.796689 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: Close
[0m20:00:16.797665 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: Close
[0m20:00:16.808700 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.338 seconds
[0m20:00:16.809958 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa: Close
[0m20:00:16.883043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118806960>]}
[0m20:00:16.887606 [debug] [Thread-8 (]: Began running node model.sequra_analytics.stg_dim_shoppers
[0m20:00:16.888549 [debug] [Thread-9 (]: Began running node model.sequra_analytics.stg_merchants
[0m20:00:16.888257 [info ] [Thread-8 (]: 1 of 9 START sql view model dbt_maximerosa_staging.stg_dim_shoppers ............ [RUN]
[0m20:00:16.889311 [debug] [Thread-10 ]: Began running node model.sequra_analytics.stg_orders
[0m20:00:16.889603 [debug] [Thread-11 ]: Began running node model.sequra_analytics.stg_orders_financial
[0m20:00:16.889079 [info ] [Thread-9 (]: 2 of 9 START sql view model dbt_maximerosa_staging.stg_merchants ............... [RUN]
[0m20:00:16.890010 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now model.sequra_analytics.stg_dim_shoppers)
[0m20:00:16.890405 [info ] [Thread-10 ]: 3 of 9 START sql view model dbt_maximerosa_staging.stg_orders .................. [RUN]
[0m20:00:16.890855 [info ] [Thread-11 ]: 4 of 9 START sql view model dbt_maximerosa_staging.stg_orders_financial ........ [RUN]
[0m20:00:16.891281 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa, now model.sequra_analytics.stg_merchants)
[0m20:00:16.891641 [debug] [Thread-8 (]: Began compiling node model.sequra_analytics.stg_dim_shoppers
[0m20:00:16.892033 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now model.sequra_analytics.stg_orders)
[0m20:00:16.892339 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_intermediate, now model.sequra_analytics.stg_orders_financial)
[0m20:00:16.892654 [debug] [Thread-9 (]: Began compiling node model.sequra_analytics.stg_merchants
[0m20:00:16.898505 [debug] [Thread-8 (]: Writing injected SQL for node "model.sequra_analytics.stg_dim_shoppers"
[0m20:00:16.898830 [debug] [Thread-10 ]: Began compiling node model.sequra_analytics.stg_orders
[0m20:00:16.899057 [debug] [Thread-11 ]: Began compiling node model.sequra_analytics.stg_orders_financial
[0m20:00:16.901496 [debug] [Thread-9 (]: Writing injected SQL for node "model.sequra_analytics.stg_merchants"
[0m20:00:16.904005 [debug] [Thread-10 ]: Writing injected SQL for node "model.sequra_analytics.stg_orders"
[0m20:00:16.906087 [debug] [Thread-11 ]: Writing injected SQL for node "model.sequra_analytics.stg_orders_financial"
[0m20:00:16.906565 [debug] [Thread-8 (]: Began executing node model.sequra_analytics.stg_dim_shoppers
[0m20:00:16.924994 [debug] [Thread-8 (]: Writing runtime sql for node "model.sequra_analytics.stg_dim_shoppers"
[0m20:00:16.925542 [debug] [Thread-9 (]: Began executing node model.sequra_analytics.stg_merchants
[0m20:00:16.925787 [debug] [Thread-11 ]: Began executing node model.sequra_analytics.stg_orders_financial
[0m20:00:16.926005 [debug] [Thread-10 ]: Began executing node model.sequra_analytics.stg_orders
[0m20:00:16.927736 [debug] [Thread-9 (]: Writing runtime sql for node "model.sequra_analytics.stg_merchants"
[0m20:00:16.929099 [debug] [Thread-11 ]: Writing runtime sql for node "model.sequra_analytics.stg_orders_financial"
[0m20:00:16.929547 [debug] [Thread-8 (]: Using snowflake connection "model.sequra_analytics.stg_dim_shoppers"
[0m20:00:16.930976 [debug] [Thread-10 ]: Writing runtime sql for node "model.sequra_analytics.stg_orders"
[0m20:00:16.931347 [debug] [Thread-8 (]: On model.sequra_analytics.stg_dim_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_dim_shoppers
  
  
  
  
  as (
    

select
    shopper_id,
    age as shopper_age
from SEQURA_DEV.dbt_maximerosa.dim_shoppers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_dim_shoppers"} */;
[0m20:00:16.931711 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m20:00:16.932531 [debug] [Thread-11 ]: Using snowflake connection "model.sequra_analytics.stg_orders_financial"
[0m20:00:16.932868 [debug] [Thread-9 (]: Using snowflake connection "model.sequra_analytics.stg_merchants"
[0m20:00:16.933332 [debug] [Thread-11 ]: On model.sequra_analytics.stg_orders_financial: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders_financial
  
  
  
  
  as (
    

select
    order_id,
    shopper_id,
    to_date(order_date) as order_date,
    date_trunc('month', to_date(order_date)) as order_month,
    to_char(to_date(order_date), 'YYYY-MM') as month_year_order,
    product_id,
    case product_id
        when 1 then 'FlexPay'
        when 2 then 'PayLater'
        when 3 then 'DirectPay'
        else 'Product_' || product_id::varchar
    end as product,
    merchant_id,
    is_in_default,
    days_unbalanced,
    current_order_value,
    overdue_principal,
    overdue_fees,
    overdue_principal + overdue_fees as total_overdue
from SEQURA_DEV.dbt_maximerosa.orders_financial
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders_financial"} */;
[0m20:00:16.934181 [debug] [Thread-10 ]: Using snowflake connection "model.sequra_analytics.stg_orders"
[0m20:00:16.934371 [debug] [Thread-9 (]: On model.sequra_analytics.stg_merchants: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
  
  
  
  
  as (
    

select
    merchant_id,
    merchant_name
from SEQURA_DEV.dbt_maximerosa.merchants
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_merchants"} */;
[0m20:00:16.934701 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m20:00:16.934939 [debug] [Thread-10 ]: On model.sequra_analytics.stg_orders: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders
  
  
  
  
  as (
    

with source_data as (
    select
        order_id,
        shopper_id,
        merchant_id,
        order_date as order_date_raw,
        -- Parse the date format (d/m/yy or dd/mm/yy)
        case 
            when split_part(order_date, '/', 3) = '22' then '2022'
            when split_part(order_date, '/', 3) = '23' then '2023'
            else '20' || split_part(order_date, '/', 3)
        end || '-' ||
        lpad(split_part(order_date, '/', 2), 2, '0') || '-' ||
        lpad(split_part(order_date, '/', 1), 2, '0') as order_date_formatted
    from SEQURA_DEV.dbt_maximerosa.orders_merchant
)

select
    order_id,
    shopper_id,
    merchant_id,
    order_date_raw,
    to_date(order_date_formatted, 'YYYY-MM-DD') as order_date,
    date_trunc('month', to_date(order_date_formatted, 'YYYY-MM-DD')) as order_month,
    to_char(to_date(order_date_formatted, 'YYYY-MM-DD'), 'YYYY-MM') as month_year
from source_data
where order_date_raw is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders"} */;
[0m20:00:16.935600 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m20:00:16.936109 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m20:00:19.398939 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.467 seconds
[0m20:00:19.422589 [debug] [Thread-8 (]: On model.sequra_analytics.stg_dim_shoppers: Close
[0m20:00:19.423506 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.488 seconds
[0m20:00:19.429146 [debug] [Thread-9 (]: On model.sequra_analytics.stg_merchants: Close
[0m20:00:19.431890 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.496 seconds
[0m20:00:19.433872 [debug] [Thread-10 ]: On model.sequra_analytics.stg_orders: Close
[0m20:00:19.452453 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.518 seconds
[0m20:00:19.454307 [debug] [Thread-11 ]: On model.sequra_analytics.stg_orders_financial: Close
[0m20:00:19.511165 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b699700>]}
[0m20:00:19.511604 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10305f2f0>]}
[0m20:00:19.511990 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd7dd0>]}
[0m20:00:19.512584 [info ] [Thread-8 (]: 1 of 9 OK created sql view model dbt_maximerosa_staging.stg_dim_shoppers ....... [[32mSUCCESS 1[0m in 2.62s]
[0m20:00:19.512922 [info ] [Thread-9 (]: 2 of 9 OK created sql view model dbt_maximerosa_staging.stg_merchants .......... [[32mSUCCESS 1[0m in 2.62s]
[0m20:00:19.513915 [debug] [Thread-8 (]: Finished running node model.sequra_analytics.stg_dim_shoppers
[0m20:00:19.513380 [info ] [Thread-10 ]: 3 of 9 OK created sql view model dbt_maximerosa_staging.stg_orders ............. [[32mSUCCESS 1[0m in 2.62s]
[0m20:00:19.514391 [debug] [Thread-9 (]: Finished running node model.sequra_analytics.stg_merchants
[0m20:00:19.514931 [debug] [Thread-10 ]: Finished running node model.sequra_analytics.stg_orders
[0m20:00:19.515481 [debug] [Thread-8 (]: Began running node model.sequra_analytics.int_monthly_shoppers
[0m20:00:19.515788 [debug] [Thread-9 (]: Began running node model.sequra_analytics.int_recurrent_shoppers
[0m20:00:19.516166 [info ] [Thread-8 (]: 5 of 9 START sql view model dbt_maximerosa_intermediate.int_monthly_shoppers ... [RUN]
[0m20:00:19.516664 [info ] [Thread-9 (]: 6 of 9 START sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers . [RUN]
[0m20:00:19.517144 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_dim_shoppers, now model.sequra_analytics.int_monthly_shoppers)
[0m20:00:19.517486 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_merchants, now model.sequra_analytics.int_recurrent_shoppers)
[0m20:00:19.517797 [debug] [Thread-8 (]: Began compiling node model.sequra_analytics.int_monthly_shoppers
[0m20:00:19.518059 [debug] [Thread-9 (]: Began compiling node model.sequra_analytics.int_recurrent_shoppers
[0m20:00:19.520584 [debug] [Thread-8 (]: Writing injected SQL for node "model.sequra_analytics.int_monthly_shoppers"
[0m20:00:19.522923 [debug] [Thread-9 (]: Writing injected SQL for node "model.sequra_analytics.int_recurrent_shoppers"
[0m20:00:19.525047 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b6afe90>]}
[0m20:00:19.525500 [info ] [Thread-11 ]: 4 of 9 OK created sql view model dbt_maximerosa_staging.stg_orders_financial ... [[32mSUCCESS 1[0m in 2.63s]
[0m20:00:19.525882 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.stg_orders_financial
[0m20:00:19.526373 [debug] [Thread-10 ]: Began running node model.sequra_analytics.int_orders_with_defaults
[0m20:00:19.526894 [info ] [Thread-10 ]: 7 of 9 START sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [RUN]
[0m20:00:19.527251 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders, now model.sequra_analytics.int_orders_with_defaults)
[0m20:00:19.527525 [debug] [Thread-10 ]: Began compiling node model.sequra_analytics.int_orders_with_defaults
[0m20:00:19.527785 [debug] [Thread-9 (]: Began executing node model.sequra_analytics.int_recurrent_shoppers
[0m20:00:19.530994 [debug] [Thread-10 ]: Writing injected SQL for node "model.sequra_analytics.int_orders_with_defaults"
[0m20:00:19.531298 [debug] [Thread-8 (]: Began executing node model.sequra_analytics.int_monthly_shoppers
[0m20:00:19.533223 [debug] [Thread-9 (]: Writing runtime sql for node "model.sequra_analytics.int_recurrent_shoppers"
[0m20:00:19.534985 [debug] [Thread-8 (]: Writing runtime sql for node "model.sequra_analytics.int_monthly_shoppers"
[0m20:00:19.542470 [debug] [Thread-9 (]: Using snowflake connection "model.sequra_analytics.int_recurrent_shoppers"
[0m20:00:19.542820 [debug] [Thread-10 ]: Began executing node model.sequra_analytics.int_orders_with_defaults
[0m20:00:19.543479 [debug] [Thread-8 (]: Using snowflake connection "model.sequra_analytics.int_monthly_shoppers"
[0m20:00:19.543830 [debug] [Thread-9 (]: On model.sequra_analytics.int_recurrent_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers
  
  
  
  
  as (
    

with order_history as (
    select
        o1.order_month as current_month,
        o1.month_year as current_month_year,
        o1.merchant_id,
        o1.shopper_id,
        count(distinct o2.order_month) as months_with_purchases
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o1
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_orders o2
        on o1.merchant_id = o2.merchant_id
        and o1.shopper_id = o2.shopper_id
        and o2.order_date between dateadd(month, -11, o1.order_month) and last_day(o1.order_month)
        and o2.order_month <= o1.order_month
    group by 1, 2, 3, 4
)

select
    current_month,
    current_month_year,
    merchant_id,
    shopper_id,
    months_with_purchases,
    -- A shopper is recurrent if they have made purchases in at least 2 different months
    -- within the 12-month window including the current month
    case 
        when months_with_purchases >= 2 then 1 
        else 0 
    end as is_recurrent
from order_history
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_recurrent_shoppers"} */;
[0m20:00:19.545810 [debug] [Thread-10 ]: Writing runtime sql for node "model.sequra_analytics.int_orders_with_defaults"
[0m20:00:19.546227 [debug] [Thread-8 (]: On model.sequra_analytics.int_monthly_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers
  
  
  
  
  as (
    

with monthly_orders as (
    select distinct
        order_month,
        month_year,
        merchant_id,
        shopper_id
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
)

select
    order_month,
    month_year,
    merchant_id,
    shopper_id
from monthly_orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_monthly_shoppers"} */;
[0m20:00:19.546591 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m20:00:19.546861 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m20:00:19.552923 [debug] [Thread-10 ]: Using snowflake connection "model.sequra_analytics.int_orders_with_defaults"
[0m20:00:19.553206 [debug] [Thread-10 ]: On model.sequra_analytics.int_orders_with_defaults: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
  
  
  
  
  as (
    

with orders_enriched as (
    select
        -- Order information
        o.order_id,
        o.order_date,
        o.order_month,
        o.month_year_order,
        
        -- Product and merchant
        o.product_id,
        o.product,
        o.merchant_id,
        m.merchant_name as merchant,
        
        -- Shopper information
        o.shopper_id,
        s.shopper_age,
        
        -- Financial metrics
        o.is_in_default,
        o.days_unbalanced,
        o.current_order_value,
        o.overdue_principal,
        o.overdue_fees,
        o.total_overdue,
        
        -- Calculated delayed period (for filtering, not cumulative)
        case
            when o.days_unbalanced > 90 then '90'
            when o.days_unbalanced > 60 then '60'
            when o.days_unbalanced > 30 then '30'
            when o.days_unbalanced > 17 then '17'
            else null
        end as max_delayed_period
        
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders_financial o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_dim_shoppers s
        on o.shopper_id = s.shopper_id
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
)

select * from orders_enriched
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_orders_with_defaults"} */;
[0m20:00:19.553442 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m20:00:22.186071 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.639 seconds
[0m20:00:22.187130 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.640 seconds
[0m20:00:22.189975 [debug] [Thread-9 (]: On model.sequra_analytics.int_recurrent_shoppers: Close
[0m20:00:22.191784 [debug] [Thread-8 (]: On model.sequra_analytics.int_monthly_shoppers: Close
[0m20:00:22.222687 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.669 seconds
[0m20:00:22.224875 [debug] [Thread-10 ]: On model.sequra_analytics.int_orders_with_defaults: Close
[0m20:00:22.266694 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c02c590>]}
[0m20:00:22.267119 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b66c740>]}
[0m20:00:22.267570 [info ] [Thread-9 (]: 6 of 9 OK created sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers  [[32mSUCCESS 1[0m in 2.75s]
[0m20:00:22.267988 [info ] [Thread-8 (]: 5 of 9 OK created sql view model dbt_maximerosa_intermediate.int_monthly_shoppers  [[32mSUCCESS 1[0m in 2.75s]
[0m20:00:22.268338 [debug] [Thread-9 (]: Finished running node model.sequra_analytics.int_recurrent_shoppers
[0m20:00:22.268638 [debug] [Thread-8 (]: Finished running node model.sequra_analytics.int_monthly_shoppers
[0m20:00:22.268974 [debug] [Thread-11 ]: Began running node model.sequra_analytics.shopper_recurrence_rate
[0m20:00:22.269225 [info ] [Thread-11 ]: 8 of 9 START sql table model dbt_maximerosa_marts.shopper_recurrence_rate ...... [RUN]
[0m20:00:22.269474 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders_financial, now model.sequra_analytics.shopper_recurrence_rate)
[0m20:00:22.269664 [debug] [Thread-11 ]: Began compiling node model.sequra_analytics.shopper_recurrence_rate
[0m20:00:22.272044 [debug] [Thread-11 ]: Writing injected SQL for node "model.sequra_analytics.shopper_recurrence_rate"
[0m20:00:22.272963 [debug] [Thread-11 ]: Began executing node model.sequra_analytics.shopper_recurrence_rate
[0m20:00:22.287612 [debug] [Thread-11 ]: Writing runtime sql for node "model.sequra_analytics.shopper_recurrence_rate"
[0m20:00:22.289419 [debug] [Thread-11 ]: Using snowflake connection "model.sequra_analytics.shopper_recurrence_rate"
[0m20:00:22.289723 [debug] [Thread-11 ]: On model.sequra_analytics.shopper_recurrence_rate: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
    
    
    
    as (

with monthly_metrics as (
    select
        ms.order_month,
        ms.month_year,
        ms.merchant_id,
        m.merchant_name,
        count(distinct ms.shopper_id) as total_shoppers,
        sum(rs.is_recurrent) as recurrent_shoppers
    from SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers ms
    left join SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers rs
        on ms.order_month = rs.current_month
        and ms.merchant_id = rs.merchant_id
        and ms.shopper_id = rs.shopper_id
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on ms.merchant_id = m.merchant_id
    group by 1, 2, 3, 4
)

select
    merchant_name,
    month_year as month,
    round(
        case 
            when total_shoppers > 0 
            then (recurrent_shoppers::decimal / total_shoppers) * 100
            else 0 
        end, 2
    ) as recurrence_rate
from monthly_metrics
order by merchant_name, month
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.shopper_recurrence_rate"} */;
[0m20:00:22.289942 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m20:00:22.307328 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b05e7b0>]}
[0m20:00:22.308119 [info ] [Thread-10 ]: 7 of 9 OK created sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [[32mSUCCESS 1[0m in 2.78s]
[0m20:00:22.308581 [debug] [Thread-10 ]: Finished running node model.sequra_analytics.int_orders_with_defaults
[0m20:00:22.308911 [debug] [Thread-8 (]: Began running node model.sequra_analytics.default_ratio_analysis
[0m20:00:22.309255 [info ] [Thread-8 (]: 9 of 9 START sql table model dbt_maximerosa_marts.default_ratio_analysis ....... [RUN]
[0m20:00:22.309672 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_monthly_shoppers, now model.sequra_analytics.default_ratio_analysis)
[0m20:00:22.309875 [debug] [Thread-8 (]: Began compiling node model.sequra_analytics.default_ratio_analysis
[0m20:00:22.311597 [debug] [Thread-8 (]: Writing injected SQL for node "model.sequra_analytics.default_ratio_analysis"
[0m20:00:22.312470 [debug] [Thread-8 (]: Began executing node model.sequra_analytics.default_ratio_analysis
[0m20:00:22.314187 [debug] [Thread-8 (]: Writing runtime sql for node "model.sequra_analytics.default_ratio_analysis"
[0m20:00:22.315691 [debug] [Thread-8 (]: Using snowflake connection "model.sequra_analytics.default_ratio_analysis"
[0m20:00:22.316003 [debug] [Thread-8 (]: On model.sequra_analytics.default_ratio_analysis: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.default_ratio_analysis
    
    
    
    as (

-- Now we properly use the intermediate model!
with base_data as (
    select * from SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
    where is_in_default = true  -- Only defaults for this analysis
),

-- Generate records for each applicable delayed period using UNION ALL
-- This implements the cumulative logic: 35 days appears in both 17 and 30
expanded_periods as (
    -- Period 17: All orders with days_unbalanced > 17
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '17' as delayed_period
    from base_data
    where days_unbalanced > 17
    
    union all
    
    -- Period 30: All orders with days_unbalanced > 30
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '30' as delayed_period
    from base_data
    where days_unbalanced > 30
    
    union all
    
    -- Period 60: All orders with days_unbalanced > 60
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '60' as delayed_period
    from base_data
    where days_unbalanced > 60
    
    union all
    
    -- Period 90: All orders with days_unbalanced > 90
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '90' as delayed_period
    from base_data
    where days_unbalanced > 90
)

-- Final output with exact columns requested
select distinct
    shopper_age,
    month_year_order,
    product,
    merchant,
    default_type,
    delayed_period
from expanded_periods
where merchant is not null  -- Exclude records without merchant mapping
order by 
    month_year_order,
    merchant,
    cast(delayed_period as integer)
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.default_ratio_analysis"} */;
[0m20:00:22.316242 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m20:00:26.588835 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 4.298 seconds
[0m20:00:26.593045 [debug] [Thread-11 ]: On model.sequra_analytics.shopper_recurrence_rate: Close
[0m20:00:26.594019 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 4.278 seconds
[0m20:00:26.596778 [debug] [Thread-8 (]: On model.sequra_analytics.default_ratio_analysis: Close
[0m20:00:26.684753 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce234a0>]}
[0m20:00:26.685436 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60764404-c87c-4ae6-9db5-b283df914de7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b08c7a0>]}
[0m20:00:26.686281 [info ] [Thread-8 (]: 9 of 9 OK created sql table model dbt_maximerosa_marts.default_ratio_analysis .. [[32mSUCCESS 1[0m in 4.37s]
[0m20:00:26.686973 [info ] [Thread-11 ]: 8 of 9 OK created sql table model dbt_maximerosa_marts.shopper_recurrence_rate . [[32mSUCCESS 1[0m in 4.42s]
[0m20:00:26.687602 [debug] [Thread-8 (]: Finished running node model.sequra_analytics.default_ratio_analysis
[0m20:00:26.688069 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.shopper_recurrence_rate
[0m20:00:26.689606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:26.689946 [debug] [MainThread]: Connection 'model.sequra_analytics.default_ratio_analysis' was properly closed.
[0m20:00:26.690214 [debug] [MainThread]: Connection 'model.sequra_analytics.int_recurrent_shoppers' was properly closed.
[0m20:00:26.690429 [debug] [MainThread]: Connection 'model.sequra_analytics.int_orders_with_defaults' was properly closed.
[0m20:00:26.690626 [debug] [MainThread]: Connection 'model.sequra_analytics.shopper_recurrence_rate' was properly closed.
[0m20:00:26.691168 [info ] [MainThread]: 
[0m20:00:26.691818 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 15.46 seconds (15.46s).
[0m20:00:26.693746 [debug] [MainThread]: Command end result
[0m20:00:26.717643 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m20:00:26.720305 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m20:00:26.725935 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/run_results.json
[0m20:00:26.726269 [info ] [MainThread]: 
[0m20:00:26.726606 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:26.726862 [info ] [MainThread]: 
[0m20:00:26.727077 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m20:00:26.729154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.241615, "process_in_blocks": "0", "process_kernel_time": 0.483334, "process_mem_max_rss": "182206464", "process_out_blocks": "0", "process_user_time": 2.272674}
[0m20:00:26.729564 [debug] [MainThread]: Command `dbt run` succeeded at 20:00:26.729501 after 16.24 seconds
[0m20:00:26.729837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d11af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d11370>]}
[0m20:00:26.730086 [debug] [MainThread]: Flushing usage events
[0m20:00:27.302336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:37.270681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f8fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10501da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10501d790>]}


============================== 20:10:37.275689 | f37d1520-4336-49fc-91ec-2a6ad90b50cb ==============================
[0m20:10:37.275689 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:10:37.276106 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'use_experimental_parser': 'False', 'quiet': 'False', 'write_json': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics', 'printer_width': '80', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'debug': 'False', 'cache_selected_only': 'False', 'no_print': 'None'}
[0m20:10:37.663830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f37d1520-4336-49fc-91ec-2a6ad90b50cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029bc470>]}
[0m20:10:37.693720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f37d1520-4336-49fc-91ec-2a6ad90b50cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043867b0>]}
[0m20:10:37.694736 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:10:37.767915 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:10:37.900964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:37.901233 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:37.904337 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- seeds.sequra_analytics.orders_financial.column_types
- seeds.sequra_analytics.orders_merchant.column_types
- seeds.sequra_analytics.orders_merchant.merchants.column_types
- seeds.sequra_analytics.dim_shoppers.column_types
[0m20:10:37.927697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f37d1520-4336-49fc-91ec-2a6ad90b50cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c06c30>]}
[0m20:10:37.972220 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m20:10:37.974311 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m20:10:37.997430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f37d1520-4336-49fc-91ec-2a6ad90b50cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c75fd0>]}
[0m20:10:37.997739 [info ] [MainThread]: Found 9 models, 4 seeds, 11 data tests, 479 macros
[0m20:10:37.997913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f37d1520-4336-49fc-91ec-2a6ad90b50cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ebe4e0>]}
[0m20:10:37.998986 [info ] [MainThread]: 
[0m20:10:37.999171 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:37.999313 [info ] [MainThread]: 
[0m20:10:37.999587 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:38.001887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m20:10:38.075919 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m20:10:38.076201 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m20:10:38.076367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:41.280108 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3.204 seconds
[0m20:10:41.281422 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m20:10:41.391510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_raw_data)
[0m20:10:41.392324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_marts'
[0m20:10:41.392779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_staging'
[0m20:10:41.394059 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate'
[0m20:10:41.404794 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m20:10:41.406700 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m20:10:41.408648 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m20:10:41.410242 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m20:10:41.410491 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m20:10:41.410725 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m20:10:41.410937 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m20:10:41.411135 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m20:10:41.411319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:41.411491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:41.411661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:41.411824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:44.069392 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.658 seconds
[0m20:10:44.070171 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.658 seconds
[0m20:10:44.072055 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: Close
[0m20:10:44.072614 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.661 seconds
[0m20:10:44.074123 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m20:10:44.076373 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: Close
[0m20:10:44.081127 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.670 seconds
[0m20:10:44.082423 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: Close
[0m20:10:44.165043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f37d1520-4336-49fc-91ec-2a6ad90b50cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d7800>]}
[0m20:10:44.169351 [debug] [Thread-6 (]: Began running node seed.sequra_analytics.dim_shoppers
[0m20:10:44.169787 [debug] [Thread-7 (]: Began running node seed.sequra_analytics.merchants
[0m20:10:44.170169 [debug] [Thread-8 (]: Began running node seed.sequra_analytics.orders_financial
[0m20:10:44.171139 [debug] [Thread-9 (]: Began running node seed.sequra_analytics.orders_merchant
[0m20:10:44.170781 [info ] [Thread-6 (]: 1 of 4 START seed file dbt_maximerosa_raw_data.dim_shoppers .................... [RUN]
[0m20:10:44.171739 [info ] [Thread-7 (]: 2 of 4 START seed file dbt_maximerosa_raw_data.merchants ....................... [RUN]
[0m20:10:44.172301 [info ] [Thread-8 (]: 3 of 4 START seed file dbt_maximerosa_raw_data.orders_financial ................ [RUN]
[0m20:10:44.172850 [info ] [Thread-9 (]: 4 of 4 START seed file dbt_maximerosa_raw_data.orders_merchant ................. [RUN]
[0m20:10:44.173366 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_raw_data, now seed.sequra_analytics.dim_shoppers)
[0m20:10:44.173939 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now seed.sequra_analytics.merchants)
[0m20:10:44.174379 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now seed.sequra_analytics.orders_financial)
[0m20:10:44.174840 [debug] [Thread-9 (]: Acquiring new snowflake connection 'seed.sequra_analytics.orders_merchant'
[0m20:10:44.175168 [debug] [Thread-6 (]: Began compiling node seed.sequra_analytics.dim_shoppers
[0m20:10:44.175454 [debug] [Thread-7 (]: Began compiling node seed.sequra_analytics.merchants
[0m20:10:44.175734 [debug] [Thread-8 (]: Began compiling node seed.sequra_analytics.orders_financial
[0m20:10:44.175996 [debug] [Thread-9 (]: Began compiling node seed.sequra_analytics.orders_merchant
[0m20:10:44.176292 [debug] [Thread-6 (]: Began executing node seed.sequra_analytics.dim_shoppers
[0m20:10:44.176561 [debug] [Thread-7 (]: Began executing node seed.sequra_analytics.merchants
[0m20:10:44.176820 [debug] [Thread-8 (]: Began executing node seed.sequra_analytics.orders_financial
[0m20:10:44.177072 [debug] [Thread-9 (]: Began executing node seed.sequra_analytics.orders_merchant
[0m20:10:44.219119 [debug] [Thread-6 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m20:10:44.219517 [debug] [Thread-6 (]: On seed.sequra_analytics.dim_shoppers: create table SEQURA_DEV.dbt_maximerosa_raw_data.dim_shoppers (shopper_id integer,age integer)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */
[0m20:10:44.221411 [debug] [Thread-8 (]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m20:10:44.227834 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m20:10:44.229220 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m20:10:44.229422 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m20:10:44.229639 [debug] [Thread-8 (]: On seed.sequra_analytics.orders_financial: create table SEQURA_DEV.dbt_maximerosa_raw_data.orders_financial (order_id integer,shopper_id integer,order_date date,product_id integer,merchant_id integer,is_in_default boolean,days_unbalanced integer,current_order_value integer,overdue_principal integer,overdue_fees float8)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */
[0m20:10:44.229969 [debug] [Thread-7 (]: On seed.sequra_analytics.merchants: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m20:10:44.230552 [debug] [Thread-9 (]: On seed.sequra_analytics.orders_merchant: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m20:10:44.230832 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m20:10:44.231132 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m20:10:44.231999 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m20:10:46.743527 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.512 seconds
[0m20:10:46.744312 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m20:10:46.744627 [debug] [Thread-7 (]: On seed.sequra_analytics.merchants: truncate table "SEQURA_DEV"."DBT_MAXIMEROSA_RAW_DATA"."MERCHANTS"
  
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */;
[0m20:10:46.832260 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.600 seconds
[0m20:10:46.832811 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m20:10:46.833124 [debug] [Thread-9 (]: On seed.sequra_analytics.orders_merchant: truncate table "SEQURA_DEV"."DBT_MAXIMEROSA_RAW_DATA"."ORDERS_MERCHANT"
  
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */;
[0m20:10:47.247800 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m20:10:47.248617 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m20:10:47.249449 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 3.022 seconds
[0m20:10:47.250104 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 3.019 seconds
[0m20:10:47.250553 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m20:10:47.250971 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m20:10:47.261096 [debug] [Thread-6 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m20:10:47.262499 [debug] [Thread-8 (]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m20:10:47.262754 [debug] [Thread-9 (]: On seed.sequra_analytics.orders_merchant: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m20:10:47.262990 [debug] [Thread-7 (]: On seed.sequra_analytics.merchants: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m20:10:47.263205 [debug] [Thread-6 (]: On seed.sequra_analytics.dim_shoppers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */
[0m20:10:47.263403 [debug] [Thread-8 (]: On seed.sequra_analytics.orders_financial: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */
[0m20:10:47.361225 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m20:10:47.362152 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m20:10:47.364199 [debug] [Thread-8 (]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m20:10:47.365099 [debug] [Thread-6 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m20:10:47.365671 [debug] [Thread-8 (]: On seed.sequra_analytics.orders_financial: insert into SEQURA_DEV.dbt_maximerosa_raw_data.orders_financial (order_id, shopper_id, order_date, product_id, merchant_id, is_in_default, days_unbalanced, current_order_value, overdue_principal, overdue_fees) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m20:10:47.366156 [debug] [Thread-6 (]: On seed.sequra_analytics.dim_shoppers: insert into SEQURA_DEV.dbt_maximerosa_raw_data.dim_shoppers (shopper_id, age) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */...
[0m20:10:47.498360 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.234 seconds
[0m20:10:47.499613 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m20:10:47.499802 [debug] [Thread-7 (]: On seed.sequra_analytics.merchants: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m20:10:47.510844 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m20:10:47.511877 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m20:10:47.512054 [debug] [Thread-9 (]: On seed.sequra_analytics.orders_merchant: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m20:10:47.569484 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.069 seconds
[0m20:10:47.569894 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m20:10:47.570062 [debug] [Thread-7 (]: On seed.sequra_analytics.merchants: insert into SEQURA_DEV.dbt_maximerosa_raw_data.merchants (merchant_id, merchant_name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */...
[0m20:10:47.580507 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.068 seconds
[0m20:10:47.581196 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m20:10:47.581405 [debug] [Thread-9 (]: On seed.sequra_analytics.orders_merchant: insert into SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant (order_id, shopper_id, merchant_id, order_date) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version":...
[0m20:10:48.061572 [debug] [Thread-6 (]: SQL status: SUCCESS 9 in 0.694 seconds
[0m20:10:48.062052 [debug] [Thread-8 (]: SQL status: SUCCESS 25 in 0.696 seconds
[0m20:10:48.062303 [debug] [Thread-6 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m20:10:48.062623 [debug] [Thread-9 (]: SQL status: SUCCESS 25 in 0.481 seconds
[0m20:10:48.062920 [debug] [Thread-7 (]: SQL status: SUCCESS 6 in 0.493 seconds
[0m20:10:48.063164 [debug] [Thread-8 (]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m20:10:48.063384 [debug] [Thread-6 (]: On seed.sequra_analytics.dim_shoppers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */
[0m20:10:48.063598 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m20:10:48.063797 [debug] [Thread-7 (]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m20:10:48.063977 [debug] [Thread-8 (]: On seed.sequra_analytics.orders_financial: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */
[0m20:10:48.064355 [debug] [Thread-9 (]: On seed.sequra_analytics.orders_merchant: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m20:10:48.064936 [debug] [Thread-7 (]: On seed.sequra_analytics.merchants: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m20:10:48.372853 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.308 seconds
[0m20:10:48.379668 [debug] [Thread-6 (]: Writing runtime SQL for node "seed.sequra_analytics.dim_shoppers"
[0m20:10:48.407824 [debug] [Thread-6 (]: On seed.sequra_analytics.dim_shoppers: Close
[0m20:10:48.408670 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.343 seconds
[0m20:10:48.409292 [debug] [Thread-9 (]: Writing runtime SQL for node "seed.sequra_analytics.orders_merchant"
[0m20:10:48.412146 [debug] [Thread-9 (]: On seed.sequra_analytics.orders_merchant: Close
[0m20:10:48.414259 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.348 seconds
[0m20:10:48.414881 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.sequra_analytics.merchants"
[0m20:10:48.415622 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.350 seconds
[0m20:10:48.416167 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.sequra_analytics.orders_financial"
[0m20:10:48.418078 [debug] [Thread-8 (]: On seed.sequra_analytics.orders_financial: Close
[0m20:10:48.419357 [debug] [Thread-7 (]: On seed.sequra_analytics.merchants: Close
[0m20:10:48.500563 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f37d1520-4336-49fc-91ec-2a6ad90b50cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102674710>]}
[0m20:10:48.501148 [info ] [Thread-6 (]: 1 of 4 OK loaded seed file dbt_maximerosa_raw_data.dim_shoppers ................ [[32mINSERT 9[0m in 4.32s]
[0m20:10:48.501700 [debug] [Thread-6 (]: Finished running node seed.sequra_analytics.dim_shoppers
[0m20:10:48.507622 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f37d1520-4336-49fc-91ec-2a6ad90b50cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9c4e30>]}
[0m20:10:48.508331 [info ] [Thread-8 (]: 3 of 4 OK loaded seed file dbt_maximerosa_raw_data.orders_financial ............ [[32mINSERT 25[0m in 4.33s]
[0m20:10:48.508887 [debug] [Thread-8 (]: Finished running node seed.sequra_analytics.orders_financial
[0m20:10:48.529910 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f37d1520-4336-49fc-91ec-2a6ad90b50cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8c0b30>]}
[0m20:10:48.530436 [info ] [Thread-7 (]: 2 of 4 OK loaded seed file dbt_maximerosa_raw_data.merchants ................... [[32mINSERT 6[0m in 4.36s]
[0m20:10:48.530832 [debug] [Thread-7 (]: Finished running node seed.sequra_analytics.merchants
[0m20:10:48.539015 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f37d1520-4336-49fc-91ec-2a6ad90b50cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8c21b0>]}
[0m20:10:48.539494 [info ] [Thread-9 (]: 4 of 4 OK loaded seed file dbt_maximerosa_raw_data.orders_merchant ............. [[32mINSERT 25[0m in 4.36s]
[0m20:10:48.539928 [debug] [Thread-9 (]: Finished running node seed.sequra_analytics.orders_merchant
[0m20:10:48.541102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:48.541386 [debug] [MainThread]: Connection 'seed.sequra_analytics.dim_shoppers' was properly closed.
[0m20:10:48.541713 [debug] [MainThread]: Connection 'seed.sequra_analytics.merchants' was properly closed.
[0m20:10:48.541906 [debug] [MainThread]: Connection 'seed.sequra_analytics.orders_financial' was properly closed.
[0m20:10:48.542065 [debug] [MainThread]: Connection 'list_SEQURA_DEV_dbt_maximerosa_intermediate' was properly closed.
[0m20:10:48.542217 [debug] [MainThread]: Connection 'seed.sequra_analytics.orders_merchant' was properly closed.
[0m20:10:48.542413 [info ] [MainThread]: 
[0m20:10:48.542616 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 10.54 seconds (10.54s).
[0m20:10:48.543305 [debug] [MainThread]: Command end result
[0m20:10:48.563574 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m20:10:48.566202 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m20:10:48.570646 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/run_results.json
[0m20:10:48.570908 [info ] [MainThread]: 
[0m20:10:48.571147 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:48.571322 [info ] [MainThread]: 
[0m20:10:48.571501 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:10:48.575430 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 11.347358, "process_in_blocks": "0", "process_kernel_time": 0.380841, "process_mem_max_rss": "168361984", "process_out_blocks": "0", "process_user_time": 1.891727}
[0m20:10:48.575809 [debug] [MainThread]: Command `dbt seed` succeeded at 20:10:48.575749 after 11.35 seconds
[0m20:10:48.576046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f23800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f9b20>]}
[0m20:10:48.576265 [debug] [MainThread]: Flushing usage events
[0m20:10:49.060253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:11:02.656237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191cd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c11b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c11820>]}


============================== 20:11:02.662020 | 98537b59-d099-42df-8662-f1c7b2604133 ==============================
[0m20:11:02.662020 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:11:02.662345 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'empty': 'False', 'target_path': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'static_parser': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics'}
[0m20:11:03.026280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c40080>]}
[0m20:11:03.058470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a931a0>]}
[0m20:11:03.061714 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:11:03.150385 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:11:03.295968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:11:03.296238 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:11:03.299495 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- seeds.sequra_analytics.orders_financial.column_types
- seeds.sequra_analytics.dim_shoppers.column_types
- seeds.sequra_analytics.orders_merchant.merchants.column_types
- seeds.sequra_analytics.orders_merchant.column_types
[0m20:11:03.321707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aafa9c0>]}
[0m20:11:03.367237 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m20:11:03.369119 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m20:11:03.387209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a987aa0>]}
[0m20:11:03.387511 [info ] [MainThread]: Found 9 models, 4 seeds, 11 data tests, 479 macros
[0m20:11:03.387691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119bfcb00>]}
[0m20:11:03.388770 [info ] [MainThread]: 
[0m20:11:03.388952 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:11:03.389090 [info ] [MainThread]: 
[0m20:11:03.389336 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:11:03.392138 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m20:11:03.393426 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m20:11:03.393717 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m20:11:03.471168 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m20:11:03.471505 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m20:11:03.471735 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m20:11:03.471895 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m20:11:03.472058 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m20:11:03.472215 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m20:11:03.472361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:03.472496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:03.472620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:06.272875 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.800 seconds
[0m20:11:06.275357 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m20:11:06.277938 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.806 seconds
[0m20:11:06.279433 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m20:11:06.305737 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.833 seconds
[0m20:11:06.307259 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m20:11:06.457669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_marts)
[0m20:11:06.460108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_intermediate)
[0m20:11:06.460595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_raw_data)
[0m20:11:06.472897 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m20:11:06.475201 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m20:11:06.475842 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV_dbt_maximerosa_staging'
[0m20:11:06.477667 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m20:11:06.478023 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m20:11:06.478408 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m20:11:06.480289 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m20:11:06.480590 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m20:11:06.480885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:06.481132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:06.481415 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m20:11:06.481733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:06.483041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:08.819496 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.338 seconds
[0m20:11:08.821763 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: Close
[0m20:11:08.837752 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.356 seconds
[0m20:11:08.839847 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: Close
[0m20:11:08.854423 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.374 seconds
[0m20:11:08.855984 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m20:11:09.034994 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.552 seconds
[0m20:11:09.037136 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: Close
[0m20:11:09.122791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ced8e0>]}
[0m20:11:09.131889 [debug] [Thread-8 (]: Began running node model.sequra_analytics.stg_dim_shoppers
[0m20:11:09.132470 [debug] [Thread-9 (]: Began running node model.sequra_analytics.stg_merchants
[0m20:11:09.132791 [debug] [Thread-10 ]: Began running node model.sequra_analytics.stg_orders
[0m20:11:09.133262 [info ] [Thread-8 (]: 1 of 9 START sql view model dbt_maximerosa_staging.stg_dim_shoppers ............ [RUN]
[0m20:11:09.133743 [debug] [Thread-11 ]: Began running node model.sequra_analytics.stg_orders_financial
[0m20:11:09.134213 [info ] [Thread-9 (]: 2 of 9 START sql view model dbt_maximerosa_staging.stg_merchants ............... [RUN]
[0m20:11:09.134646 [info ] [Thread-10 ]: 3 of 9 START sql view model dbt_maximerosa_staging.stg_orders .................. [RUN]
[0m20:11:09.135319 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now model.sequra_analytics.stg_dim_shoppers)
[0m20:11:09.135744 [info ] [Thread-11 ]: 4 of 9 START sql view model dbt_maximerosa_staging.stg_orders_financial ........ [RUN]
[0m20:11:09.136151 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_intermediate, now model.sequra_analytics.stg_merchants)
[0m20:11:09.136447 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_raw_data, now model.sequra_analytics.stg_orders)
[0m20:11:09.136743 [debug] [Thread-8 (]: Began compiling node model.sequra_analytics.stg_dim_shoppers
[0m20:11:09.137025 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now model.sequra_analytics.stg_orders_financial)
[0m20:11:09.137304 [debug] [Thread-9 (]: Began compiling node model.sequra_analytics.stg_merchants
[0m20:11:09.137699 [debug] [Thread-10 ]: Began compiling node model.sequra_analytics.stg_orders
[0m20:11:09.147055 [debug] [Thread-8 (]: Writing injected SQL for node "model.sequra_analytics.stg_dim_shoppers"
[0m20:11:09.147498 [debug] [Thread-11 ]: Began compiling node model.sequra_analytics.stg_orders_financial
[0m20:11:09.150446 [debug] [Thread-9 (]: Writing injected SQL for node "model.sequra_analytics.stg_merchants"
[0m20:11:09.152705 [debug] [Thread-10 ]: Writing injected SQL for node "model.sequra_analytics.stg_orders"
[0m20:11:09.155150 [debug] [Thread-11 ]: Writing injected SQL for node "model.sequra_analytics.stg_orders_financial"
[0m20:11:09.155918 [debug] [Thread-8 (]: Began executing node model.sequra_analytics.stg_dim_shoppers
[0m20:11:09.170069 [debug] [Thread-10 ]: Began executing node model.sequra_analytics.stg_orders
[0m20:11:09.170465 [debug] [Thread-9 (]: Began executing node model.sequra_analytics.stg_merchants
[0m20:11:09.170680 [debug] [Thread-11 ]: Began executing node model.sequra_analytics.stg_orders_financial
[0m20:11:09.182609 [debug] [Thread-8 (]: Writing runtime sql for node "model.sequra_analytics.stg_dim_shoppers"
[0m20:11:09.184447 [debug] [Thread-10 ]: Writing runtime sql for node "model.sequra_analytics.stg_orders"
[0m20:11:09.185951 [debug] [Thread-9 (]: Writing runtime sql for node "model.sequra_analytics.stg_merchants"
[0m20:11:09.187307 [debug] [Thread-11 ]: Writing runtime sql for node "model.sequra_analytics.stg_orders_financial"
[0m20:11:09.188950 [debug] [Thread-11 ]: Using snowflake connection "model.sequra_analytics.stg_orders_financial"
[0m20:11:09.189393 [debug] [Thread-8 (]: Using snowflake connection "model.sequra_analytics.stg_dim_shoppers"
[0m20:11:09.189741 [debug] [Thread-9 (]: Using snowflake connection "model.sequra_analytics.stg_merchants"
[0m20:11:09.190578 [debug] [Thread-10 ]: Using snowflake connection "model.sequra_analytics.stg_orders"
[0m20:11:09.190822 [debug] [Thread-11 ]: On model.sequra_analytics.stg_orders_financial: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders_financial
  
  
  
  
  as (
    

select
    order_id,
    shopper_id,
    to_date(order_date) as order_date,
    date_trunc('month', to_date(order_date)) as order_month,
    to_char(to_date(order_date), 'YYYY-MM') as month_year_order,
    product_id,
    case product_id
        when 1 then 'FlexPay'
        when 2 then 'PayLater'
        when 3 then 'DirectPay'
        else 'Product_' || product_id::varchar
    end as product,
    merchant_id,
    is_in_default,
    days_unbalanced,
    current_order_value,
    overdue_principal,
    overdue_fees,
    overdue_principal + overdue_fees as total_overdue
from SEQURA_DEV.dbt_maximerosa_raw_data.orders_financial
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders_financial"} */;
[0m20:11:09.191150 [debug] [Thread-8 (]: On model.sequra_analytics.stg_dim_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_dim_shoppers
  
  
  
  
  as (
    

select
    shopper_id,
    age as shopper_age
from SEQURA_DEV.dbt_maximerosa_raw_data.dim_shoppers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_dim_shoppers"} */;
[0m20:11:09.191426 [debug] [Thread-9 (]: On model.sequra_analytics.stg_merchants: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
  
  
  
  
  as (
    

select
    merchant_id,
    merchant_name
from SEQURA_DEV.dbt_maximerosa_raw_data.merchants
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_merchants"} */;
[0m20:11:09.191688 [debug] [Thread-10 ]: On model.sequra_analytics.stg_orders: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders
  
  
  
  
  as (
    

with source_data as (
    select
        order_id,
        shopper_id,
        merchant_id,
        order_date as order_date_raw,
        -- Parse the date format (d/m/yy or dd/mm/yy)
        case 
            when split_part(order_date, '/', 3) = '22' then '2022'
            when split_part(order_date, '/', 3) = '23' then '2023'
            else '20' || split_part(order_date, '/', 3)
        end || '-' ||
        lpad(split_part(order_date, '/', 2), 2, '0') || '-' ||
        lpad(split_part(order_date, '/', 1), 2, '0') as order_date_formatted
    from SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant
)

select
    order_id,
    shopper_id,
    merchant_id,
    order_date_raw,
    to_date(order_date_formatted, 'YYYY-MM-DD') as order_date,
    date_trunc('month', to_date(order_date_formatted, 'YYYY-MM-DD')) as order_month,
    to_char(to_date(order_date_formatted, 'YYYY-MM-DD'), 'YYYY-MM') as month_year
from source_data
where order_date_raw is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders"} */;
[0m20:11:09.191904 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m20:11:09.192081 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m20:11:09.192262 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m20:11:09.192426 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m20:11:11.733510 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.541 seconds
[0m20:11:11.759323 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.567 seconds
[0m20:11:11.760913 [debug] [Thread-9 (]: On model.sequra_analytics.stg_merchants: Close
[0m20:11:11.762421 [debug] [Thread-11 ]: On model.sequra_analytics.stg_orders_financial: Close
[0m20:11:11.825674 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.633 seconds
[0m20:11:11.827597 [debug] [Thread-8 (]: On model.sequra_analytics.stg_dim_shoppers: Close
[0m20:11:11.838199 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f960c50>]}
[0m20:11:11.839112 [info ] [Thread-9 (]: 2 of 9 OK created sql view model dbt_maximerosa_staging.stg_merchants .......... [[32mSUCCESS 1[0m in 2.70s]
[0m20:11:11.840080 [debug] [Thread-9 (]: Finished running node model.sequra_analytics.stg_merchants
[0m20:11:11.842218 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f975340>]}
[0m20:11:11.842678 [info ] [Thread-11 ]: 4 of 9 OK created sql view model dbt_maximerosa_staging.stg_orders_financial ... [[32mSUCCESS 1[0m in 2.71s]
[0m20:11:11.843103 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.stg_orders_financial
[0m20:11:11.848451 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.656 seconds
[0m20:11:11.850395 [debug] [Thread-10 ]: On model.sequra_analytics.stg_orders: Close
[0m20:11:11.900635 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9202f0>]}
[0m20:11:11.901769 [info ] [Thread-8 (]: 1 of 9 OK created sql view model dbt_maximerosa_staging.stg_dim_shoppers ....... [[32mSUCCESS 1[0m in 2.77s]
[0m20:11:11.902241 [debug] [Thread-8 (]: Finished running node model.sequra_analytics.stg_dim_shoppers
[0m20:11:11.902656 [debug] [Thread-9 (]: Began running node model.sequra_analytics.int_orders_with_defaults
[0m20:11:11.902981 [info ] [Thread-9 (]: 5 of 9 START sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [RUN]
[0m20:11:11.903313 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_merchants, now model.sequra_analytics.int_orders_with_defaults)
[0m20:11:11.903565 [debug] [Thread-9 (]: Began compiling node model.sequra_analytics.int_orders_with_defaults
[0m20:11:11.906401 [debug] [Thread-9 (]: Writing injected SQL for node "model.sequra_analytics.int_orders_with_defaults"
[0m20:11:11.907468 [debug] [Thread-9 (]: Began executing node model.sequra_analytics.int_orders_with_defaults
[0m20:11:11.909719 [debug] [Thread-9 (]: Writing runtime sql for node "model.sequra_analytics.int_orders_with_defaults"
[0m20:11:11.911580 [debug] [Thread-9 (]: Using snowflake connection "model.sequra_analytics.int_orders_with_defaults"
[0m20:11:11.911945 [debug] [Thread-9 (]: On model.sequra_analytics.int_orders_with_defaults: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
  
  
  
  
  as (
    

with orders_enriched as (
    select
        -- Order information
        o.order_id,
        o.order_date,
        o.order_month,
        o.month_year_order,
        
        -- Product and merchant
        o.product_id,
        o.product,
        o.merchant_id,
        m.merchant_name as merchant,
        
        -- Shopper information
        o.shopper_id,
        s.shopper_age,
        
        -- Financial metrics
        o.is_in_default,
        o.days_unbalanced,
        o.current_order_value,
        o.overdue_principal,
        o.overdue_fees,
        o.total_overdue,
        
        -- Calculated delayed period (for filtering, not cumulative)
        case
            when o.days_unbalanced > 90 then '90'
            when o.days_unbalanced > 60 then '60'
            when o.days_unbalanced > 30 then '30'
            when o.days_unbalanced > 17 then '17'
            else null
        end as max_delayed_period
        
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders_financial o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_dim_shoppers s
        on o.shopper_id = s.shopper_id
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
)

select * from orders_enriched
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_orders_with_defaults"} */;
[0m20:11:11.912239 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m20:11:11.946956 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f138bc0>]}
[0m20:11:11.947576 [info ] [Thread-10 ]: 3 of 9 OK created sql view model dbt_maximerosa_staging.stg_orders ............. [[32mSUCCESS 1[0m in 2.81s]
[0m20:11:11.947984 [debug] [Thread-10 ]: Finished running node model.sequra_analytics.stg_orders
[0m20:11:11.948502 [debug] [Thread-8 (]: Began running node model.sequra_analytics.int_monthly_shoppers
[0m20:11:11.948856 [info ] [Thread-8 (]: 6 of 9 START sql view model dbt_maximerosa_intermediate.int_monthly_shoppers ... [RUN]
[0m20:11:11.949166 [debug] [Thread-11 ]: Began running node model.sequra_analytics.int_recurrent_shoppers
[0m20:11:11.949522 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_dim_shoppers, now model.sequra_analytics.int_monthly_shoppers)
[0m20:11:11.949920 [info ] [Thread-11 ]: 7 of 9 START sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers . [RUN]
[0m20:11:11.950256 [debug] [Thread-8 (]: Began compiling node model.sequra_analytics.int_monthly_shoppers
[0m20:11:11.950522 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders_financial, now model.sequra_analytics.int_recurrent_shoppers)
[0m20:11:11.953155 [debug] [Thread-8 (]: Writing injected SQL for node "model.sequra_analytics.int_monthly_shoppers"
[0m20:11:11.953482 [debug] [Thread-11 ]: Began compiling node model.sequra_analytics.int_recurrent_shoppers
[0m20:11:11.955892 [debug] [Thread-11 ]: Writing injected SQL for node "model.sequra_analytics.int_recurrent_shoppers"
[0m20:11:11.956392 [debug] [Thread-8 (]: Began executing node model.sequra_analytics.int_monthly_shoppers
[0m20:11:11.958209 [debug] [Thread-8 (]: Writing runtime sql for node "model.sequra_analytics.int_monthly_shoppers"
[0m20:11:11.958579 [debug] [Thread-11 ]: Began executing node model.sequra_analytics.int_recurrent_shoppers
[0m20:11:11.960355 [debug] [Thread-11 ]: Writing runtime sql for node "model.sequra_analytics.int_recurrent_shoppers"
[0m20:11:11.961108 [debug] [Thread-8 (]: Using snowflake connection "model.sequra_analytics.int_monthly_shoppers"
[0m20:11:11.961429 [debug] [Thread-8 (]: On model.sequra_analytics.int_monthly_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers
  
  
  
  
  as (
    

with monthly_orders as (
    select distinct
        order_month,
        month_year,
        merchant_id,
        shopper_id
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
)

select
    order_month,
    month_year,
    merchant_id,
    shopper_id
from monthly_orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_monthly_shoppers"} */;
[0m20:11:11.961672 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m20:11:11.962584 [debug] [Thread-11 ]: Using snowflake connection "model.sequra_analytics.int_recurrent_shoppers"
[0m20:11:11.963145 [debug] [Thread-11 ]: On model.sequra_analytics.int_recurrent_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers
  
  
  
  
  as (
    

with order_history as (
    select
        o1.order_month as current_month,
        o1.month_year as current_month_year,
        o1.merchant_id,
        o1.shopper_id,
        count(distinct o2.order_month) as months_with_purchases
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o1
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_orders o2
        on o1.merchant_id = o2.merchant_id
        and o1.shopper_id = o2.shopper_id
        and o2.order_date between dateadd(month, -11, o1.order_month) and last_day(o1.order_month)
        and o2.order_month <= o1.order_month
    group by 1, 2, 3, 4
)

select
    current_month,
    current_month_year,
    merchant_id,
    shopper_id,
    months_with_purchases,
    -- A shopper is recurrent if they have made purchases in at least 2 different months
    -- within the 12-month window including the current month
    case 
        when months_with_purchases >= 2 then 1 
        else 0 
    end as is_recurrent
from order_history
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_recurrent_shoppers"} */;
[0m20:11:11.963429 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m20:11:14.686709 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.723 seconds
[0m20:11:14.688608 [debug] [Thread-11 ]: On model.sequra_analytics.int_recurrent_shoppers: Close
[0m20:11:14.775565 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9aafc0>]}
[0m20:11:14.776337 [info ] [Thread-11 ]: 7 of 9 OK created sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers  [[32mSUCCESS 1[0m in 2.82s]
[0m20:11:14.776857 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.int_recurrent_shoppers
[0m20:11:14.958118 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.996 seconds
[0m20:11:14.960685 [debug] [Thread-8 (]: On model.sequra_analytics.int_monthly_shoppers: Close
[0m20:11:15.094859 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f139370>]}
[0m20:11:15.095796 [info ] [Thread-8 (]: 6 of 9 OK created sql view model dbt_maximerosa_intermediate.int_monthly_shoppers  [[32mSUCCESS 1[0m in 3.15s]
[0m20:11:15.096242 [debug] [Thread-8 (]: Finished running node model.sequra_analytics.int_monthly_shoppers
[0m20:11:15.096785 [debug] [Thread-10 ]: Began running node model.sequra_analytics.shopper_recurrence_rate
[0m20:11:15.097322 [info ] [Thread-10 ]: 8 of 9 START sql table model dbt_maximerosa_marts.shopper_recurrence_rate ...... [RUN]
[0m20:11:15.097811 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders, now model.sequra_analytics.shopper_recurrence_rate)
[0m20:11:15.098154 [debug] [Thread-10 ]: Began compiling node model.sequra_analytics.shopper_recurrence_rate
[0m20:11:15.104668 [debug] [Thread-10 ]: Writing injected SQL for node "model.sequra_analytics.shopper_recurrence_rate"
[0m20:11:15.106863 [debug] [Thread-10 ]: Began executing node model.sequra_analytics.shopper_recurrence_rate
[0m20:11:15.131549 [debug] [Thread-10 ]: Writing runtime sql for node "model.sequra_analytics.shopper_recurrence_rate"
[0m20:11:15.133810 [debug] [Thread-10 ]: Using snowflake connection "model.sequra_analytics.shopper_recurrence_rate"
[0m20:11:15.134255 [debug] [Thread-10 ]: On model.sequra_analytics.shopper_recurrence_rate: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
    
    
    
    as (

with monthly_metrics as (
    select
        ms.order_month,
        ms.month_year,
        ms.merchant_id,
        m.merchant_name,
        count(distinct ms.shopper_id) as total_shoppers,
        sum(rs.is_recurrent) as recurrent_shoppers
    from SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers ms
    left join SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers rs
        on ms.order_month = rs.current_month
        and ms.merchant_id = rs.merchant_id
        and ms.shopper_id = rs.shopper_id
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on ms.merchant_id = m.merchant_id
    group by 1, 2, 3, 4
)

select
    merchant_name,
    month_year as month,
    round(
        case 
            when total_shoppers > 0 
            then (recurrent_shoppers::decimal / total_shoppers) * 100
            else 0 
        end, 2
    ) as recurrence_rate
from monthly_metrics
order by merchant_name, month
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.shopper_recurrence_rate"} */;
[0m20:11:15.134542 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m20:11:15.438293 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 3.526 seconds
[0m20:11:15.440626 [debug] [Thread-9 (]: On model.sequra_analytics.int_orders_with_defaults: Close
[0m20:11:15.532112 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8331a0>]}
[0m20:11:15.532892 [info ] [Thread-9 (]: 5 of 9 OK created sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [[32mSUCCESS 1[0m in 3.63s]
[0m20:11:15.533740 [debug] [Thread-9 (]: Finished running node model.sequra_analytics.int_orders_with_defaults
[0m20:11:15.534373 [debug] [Thread-8 (]: Began running node model.sequra_analytics.default_ratio_analysis
[0m20:11:15.534989 [info ] [Thread-8 (]: 9 of 9 START sql table model dbt_maximerosa_marts.default_ratio_analysis ....... [RUN]
[0m20:11:15.535535 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_monthly_shoppers, now model.sequra_analytics.default_ratio_analysis)
[0m20:11:15.536002 [debug] [Thread-8 (]: Began compiling node model.sequra_analytics.default_ratio_analysis
[0m20:11:15.540300 [debug] [Thread-8 (]: Writing injected SQL for node "model.sequra_analytics.default_ratio_analysis"
[0m20:11:15.541925 [debug] [Thread-8 (]: Began executing node model.sequra_analytics.default_ratio_analysis
[0m20:11:15.545452 [debug] [Thread-8 (]: Writing runtime sql for node "model.sequra_analytics.default_ratio_analysis"
[0m20:11:15.561274 [debug] [Thread-8 (]: Using snowflake connection "model.sequra_analytics.default_ratio_analysis"
[0m20:11:15.561818 [debug] [Thread-8 (]: On model.sequra_analytics.default_ratio_analysis: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.default_ratio_analysis
    
    
    
    as (

-- Now we properly use the intermediate model!
with base_data as (
    select * from SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
    where is_in_default = true  -- Only defaults for this analysis
),

-- Generate records for each applicable delayed period using UNION ALL
-- This implements the cumulative logic: 35 days appears in both 17 and 30
expanded_periods as (
    -- Period 17: All orders with days_unbalanced > 17
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '17' as delayed_period
    from base_data
    where days_unbalanced > 17
    
    union all
    
    -- Period 30: All orders with days_unbalanced > 30
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '30' as delayed_period
    from base_data
    where days_unbalanced > 30
    
    union all
    
    -- Period 60: All orders with days_unbalanced > 60
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '60' as delayed_period
    from base_data
    where days_unbalanced > 60
    
    union all
    
    -- Period 90: All orders with days_unbalanced > 90
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '90' as delayed_period
    from base_data
    where days_unbalanced > 90
)

-- Final output with exact columns requested
select distinct
    shopper_age,
    month_year_order,
    product,
    merchant,
    default_type,
    delayed_period
from expanded_periods
where merchant is not null  -- Exclude records without merchant mapping
order by 
    month_year_order,
    merchant,
    cast(delayed_period as integer)
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.default_ratio_analysis"} */;
[0m20:11:15.562300 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m20:11:19.500147 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 3.937 seconds
[0m20:11:19.504750 [debug] [Thread-8 (]: On model.sequra_analytics.default_ratio_analysis: Close
[0m20:11:19.629626 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9200b0>]}
[0m20:11:19.630895 [info ] [Thread-8 (]: 9 of 9 OK created sql table model dbt_maximerosa_marts.default_ratio_analysis .. [[32mSUCCESS 1[0m in 4.09s]
[0m20:11:19.631721 [debug] [Thread-8 (]: Finished running node model.sequra_analytics.default_ratio_analysis
[0m20:11:20.728947 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 5.594 seconds
[0m20:11:20.731468 [debug] [Thread-10 ]: On model.sequra_analytics.shopper_recurrence_rate: Close
[0m20:11:20.832565 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98537b59-d099-42df-8662-f1c7b2604133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e8b5ca0>]}
[0m20:11:20.833669 [info ] [Thread-10 ]: 8 of 9 OK created sql table model dbt_maximerosa_marts.shopper_recurrence_rate . [[32mSUCCESS 1[0m in 5.73s]
[0m20:11:20.834281 [debug] [Thread-10 ]: Finished running node model.sequra_analytics.shopper_recurrence_rate
[0m20:11:20.835929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:20.836316 [debug] [MainThread]: Connection 'model.sequra_analytics.default_ratio_analysis' was properly closed.
[0m20:11:20.836571 [debug] [MainThread]: Connection 'model.sequra_analytics.int_orders_with_defaults' was properly closed.
[0m20:11:20.836827 [debug] [MainThread]: Connection 'model.sequra_analytics.shopper_recurrence_rate' was properly closed.
[0m20:11:20.837036 [debug] [MainThread]: Connection 'model.sequra_analytics.int_recurrent_shoppers' was properly closed.
[0m20:11:20.837427 [info ] [MainThread]: 
[0m20:11:20.837724 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 17.45 seconds (17.45s).
[0m20:11:20.839176 [debug] [MainThread]: Command end result
[0m20:11:20.865999 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m20:11:20.868214 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m20:11:20.877891 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/run_results.json
[0m20:11:20.878219 [info ] [MainThread]: 
[0m20:11:20.878493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:11:20.878704 [info ] [MainThread]: 
[0m20:11:20.878932 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m20:11:20.881010 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.271889, "process_in_blocks": "0", "process_kernel_time": 0.488164, "process_mem_max_rss": "183009280", "process_out_blocks": "0", "process_user_time": 2.400009}
[0m20:11:20.881450 [debug] [MainThread]: Command `dbt run` succeeded at 20:11:20.881373 after 18.27 seconds
[0m20:11:20.881750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191cd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b5f0b0>]}
[0m20:11:20.882069 [debug] [MainThread]: Flushing usage events
[0m20:11:21.446297 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:42.926191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b51670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107415bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107415880>]}


============================== 20:12:42.930117 | b7697d68-e2fc-4951-946a-bc34699ca54a ==============================
[0m20:12:42.930117 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:12:42.930443 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'static_parser': 'True', 'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build', 'write_json': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'no_print': 'None', 'debug': 'False', 'empty': 'False', 'use_colors': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80'}
[0m20:12:43.238539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10824d1f0>]}
[0m20:12:43.269273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834d0a0>]}
[0m20:12:43.270188 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:12:43.342895 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:12:43.461953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:12:43.462372 [debug] [MainThread]: Partial parsing: updated file: sequra_analytics://tests/generic/test_recurrence_rate_bounds.sql
[0m20:12:43.501728 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- seeds.sequra_analytics.orders_merchant.column_types
- seeds.sequra_analytics.orders_financial.column_types
- seeds.sequra_analytics.dim_shoppers.column_types
- seeds.sequra_analytics.orders_merchant.merchants.column_types
[0m20:12:43.505360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10824e5a0>]}
[0m20:12:43.553769 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m20:12:43.561370 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m20:12:43.605477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109566810>]}
[0m20:12:43.605838 [info ] [MainThread]: Found 9 models, 4 seeds, 11 data tests, 479 macros
[0m20:12:43.607629 [info ] [MainThread]: 
[0m20:12:43.607871 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:12:43.608022 [info ] [MainThread]: 
[0m20:12:43.608294 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:12:43.610825 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m20:12:43.611977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m20:12:43.623203 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m20:12:43.623573 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m20:12:43.691105 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m20:12:43.691443 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m20:12:43.691661 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m20:12:43.691877 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m20:12:43.692039 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m20:12:43.692220 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m20:12:43.692359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:43.692495 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m20:12:43.692620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:43.692746 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m20:12:43.693391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:43.693809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:46.727371 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3.034 seconds
[0m20:12:46.729490 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m20:12:46.736315 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3.042 seconds
[0m20:12:46.737127 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3.045 seconds
[0m20:12:46.738642 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m20:12:46.740163 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m20:12:46.753768 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3.061 seconds
[0m20:12:46.755141 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m20:12:46.831342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_raw_data)
[0m20:12:46.831907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_intermediate)
[0m20:12:46.833382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_marts)
[0m20:12:46.840197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_staging)
[0m20:12:46.843140 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m20:12:46.844619 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m20:12:46.846051 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m20:12:46.847545 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m20:12:46.847836 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m20:12:46.848046 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m20:12:46.848218 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m20:12:46.848377 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m20:12:46.848540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:46.848721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:46.848874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:46.849102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:49.180080 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.331 seconds
[0m20:12:49.182753 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: Close
[0m20:12:49.246255 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.397 seconds
[0m20:12:49.249226 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: Close
[0m20:12:49.330138 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.481 seconds
[0m20:12:49.332010 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: Close
[0m20:12:49.342981 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.494 seconds
[0m20:12:49.344640 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m20:12:49.432687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086220f0>]}
[0m20:12:49.435920 [debug] [Thread-9 (]: Began running node seed.sequra_analytics.dim_shoppers
[0m20:12:49.436353 [debug] [Thread-10 ]: Began running node seed.sequra_analytics.merchants
[0m20:12:49.436848 [debug] [Thread-11 ]: Began running node seed.sequra_analytics.orders_financial
[0m20:12:49.437674 [debug] [Thread-12 ]: Began running node seed.sequra_analytics.orders_merchant
[0m20:12:49.437346 [info ] [Thread-9 (]: 1 of 24 START seed file dbt_maximerosa_raw_data.dim_shoppers ................... [RUN]
[0m20:12:49.438288 [info ] [Thread-10 ]: 2 of 24 START seed file dbt_maximerosa_raw_data.merchants ...................... [RUN]
[0m20:12:49.438837 [info ] [Thread-11 ]: 3 of 24 START seed file dbt_maximerosa_raw_data.orders_financial ............... [RUN]
[0m20:12:49.439409 [info ] [Thread-12 ]: 4 of 24 START seed file dbt_maximerosa_raw_data.orders_merchant ................ [RUN]
[0m20:12:49.439863 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_raw_data, now seed.sequra_analytics.dim_shoppers)
[0m20:12:49.440178 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_intermediate, now seed.sequra_analytics.merchants)
[0m20:12:49.440560 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now seed.sequra_analytics.orders_financial)
[0m20:12:49.440927 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now seed.sequra_analytics.orders_merchant)
[0m20:12:49.441285 [debug] [Thread-9 (]: Began compiling node seed.sequra_analytics.dim_shoppers
[0m20:12:49.441542 [debug] [Thread-10 ]: Began compiling node seed.sequra_analytics.merchants
[0m20:12:49.441786 [debug] [Thread-11 ]: Began compiling node seed.sequra_analytics.orders_financial
[0m20:12:49.442022 [debug] [Thread-12 ]: Began compiling node seed.sequra_analytics.orders_merchant
[0m20:12:49.442276 [debug] [Thread-9 (]: Began executing node seed.sequra_analytics.dim_shoppers
[0m20:12:49.442514 [debug] [Thread-10 ]: Began executing node seed.sequra_analytics.merchants
[0m20:12:49.442755 [debug] [Thread-11 ]: Began executing node seed.sequra_analytics.orders_financial
[0m20:12:49.443115 [debug] [Thread-12 ]: Began executing node seed.sequra_analytics.orders_merchant
[0m20:12:49.485854 [debug] [Thread-12 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m20:12:49.486948 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m20:12:49.487251 [debug] [Thread-12 ]: On seed.sequra_analytics.orders_merchant: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m20:12:49.489573 [debug] [Thread-11 ]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m20:12:49.489845 [debug] [Thread-9 (]: On seed.sequra_analytics.dim_shoppers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */
[0m20:12:49.491191 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m20:12:49.491433 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m20:12:49.491619 [debug] [Thread-11 ]: On seed.sequra_analytics.orders_financial: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */
[0m20:12:49.491787 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m20:12:49.491950 [debug] [Thread-10 ]: On seed.sequra_analytics.merchants: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m20:12:49.492195 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m20:12:49.494729 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m20:12:51.828930 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.337 seconds
[0m20:12:51.829977 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.338 seconds
[0m20:12:51.830755 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 2.339 seconds
[0m20:12:51.831209 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m20:12:51.831615 [debug] [Thread-11 ]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m20:12:51.831975 [debug] [Thread-12 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m20:12:51.832329 [debug] [Thread-9 (]: On seed.sequra_analytics.dim_shoppers: truncate table "SEQURA_DEV"."DBT_MAXIMEROSA_RAW_DATA"."DIM_SHOPPERS"
  
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */;
[0m20:12:51.832676 [debug] [Thread-11 ]: On seed.sequra_analytics.orders_financial: truncate table "SEQURA_DEV"."DBT_MAXIMEROSA_RAW_DATA"."ORDERS_FINANCIAL"
  
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */;
[0m20:12:51.833011 [debug] [Thread-12 ]: On seed.sequra_analytics.orders_merchant: truncate table "SEQURA_DEV"."DBT_MAXIMEROSA_RAW_DATA"."ORDERS_MERCHANT"
  
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */;
[0m20:12:52.022934 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.528 seconds
[0m20:12:52.024082 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m20:12:52.024832 [debug] [Thread-10 ]: On seed.sequra_analytics.merchants: truncate table "SEQURA_DEV"."DBT_MAXIMEROSA_RAW_DATA"."MERCHANTS"
  
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */;
[0m20:12:52.045496 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 0.212 seconds
[0m20:12:52.046227 [debug] [Thread-11 ]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m20:12:52.047044 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 0.213 seconds
[0m20:12:52.047466 [debug] [Thread-11 ]: On seed.sequra_analytics.orders_financial: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */
[0m20:12:52.048039 [debug] [Thread-12 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m20:12:52.048901 [debug] [Thread-12 ]: On seed.sequra_analytics.orders_merchant: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m20:12:52.061691 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m20:12:52.062367 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m20:12:52.062704 [debug] [Thread-9 (]: On seed.sequra_analytics.dim_shoppers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */
[0m20:12:52.383250 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 0.333 seconds
[0m20:12:52.398186 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.335 seconds
[0m20:12:52.404244 [debug] [Thread-11 ]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m20:12:52.405371 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m20:12:52.406017 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.381 seconds
[0m20:12:52.406542 [debug] [Thread-11 ]: On seed.sequra_analytics.orders_financial: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */
[0m20:12:52.406920 [debug] [Thread-9 (]: On seed.sequra_analytics.dim_shoppers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */
[0m20:12:52.407292 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m20:12:52.408045 [debug] [Thread-10 ]: On seed.sequra_analytics.merchants: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m20:12:52.485503 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 0.078 seconds
[0m20:12:52.487398 [debug] [Thread-11 ]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m20:12:52.487681 [debug] [Thread-11 ]: On seed.sequra_analytics.orders_financial: insert into SEQURA_DEV.dbt_maximerosa_raw_data.orders_financial (order_id, shopper_id, order_date, product_id, merchant_id, is_in_default, days_unbalanced, current_order_value, overdue_principal, overdue_fees) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m20:12:52.489623 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.082 seconds
[0m20:12:52.490529 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m20:12:52.490944 [debug] [Thread-9 (]: On seed.sequra_analytics.dim_shoppers: insert into SEQURA_DEV.dbt_maximerosa_raw_data.dim_shoppers (shopper_id, age) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */...
[0m20:12:52.689806 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.281 seconds
[0m20:12:52.692307 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m20:12:52.692848 [debug] [Thread-10 ]: On seed.sequra_analytics.merchants: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m20:12:52.784779 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.091 seconds
[0m20:12:52.789325 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m20:12:52.789790 [debug] [Thread-10 ]: On seed.sequra_analytics.merchants: insert into SEQURA_DEV.dbt_maximerosa_raw_data.merchants (merchant_id, merchant_name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */...
[0m20:12:52.790933 [debug] [Thread-9 (]: SQL status: SUCCESS 9 in 0.299 seconds
[0m20:12:52.791304 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m20:12:52.791551 [debug] [Thread-9 (]: On seed.sequra_analytics.dim_shoppers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */
[0m20:12:52.821164 [debug] [Thread-11 ]: SQL status: SUCCESS 25 in 0.333 seconds
[0m20:12:52.822916 [debug] [Thread-11 ]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m20:12:52.823221 [debug] [Thread-11 ]: On seed.sequra_analytics.orders_financial: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */
[0m20:12:52.872994 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 0.823 seconds
[0m20:12:52.875995 [debug] [Thread-12 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m20:12:52.876277 [debug] [Thread-12 ]: On seed.sequra_analytics.orders_merchant: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m20:12:52.981970 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 0.105 seconds
[0m20:12:52.983341 [debug] [Thread-12 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m20:12:52.983764 [debug] [Thread-12 ]: On seed.sequra_analytics.orders_merchant: insert into SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant (order_id, shopper_id, merchant_id, order_date) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version":...
[0m20:12:53.013061 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.221 seconds
[0m20:12:53.019460 [debug] [Thread-9 (]: Writing runtime SQL for node "seed.sequra_analytics.dim_shoppers"
[0m20:12:53.049429 [debug] [Thread-9 (]: On seed.sequra_analytics.dim_shoppers: Close
[0m20:12:53.064923 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 0.241 seconds
[0m20:12:53.065610 [debug] [Thread-11 ]: Writing runtime SQL for node "seed.sequra_analytics.orders_financial"
[0m20:12:53.067998 [debug] [Thread-11 ]: On seed.sequra_analytics.orders_financial: Close
[0m20:12:53.121640 [debug] [Thread-10 ]: SQL status: SUCCESS 6 in 0.331 seconds
[0m20:12:53.122409 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m20:12:53.122722 [debug] [Thread-10 ]: On seed.sequra_analytics.merchants: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m20:12:53.143728 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d7bf0>]}
[0m20:12:53.144361 [info ] [Thread-11 ]: 3 of 24 OK loaded seed file dbt_maximerosa_raw_data.orders_financial ........... [[32mINSERT 25[0m in 3.70s]
[0m20:12:53.145313 [debug] [Thread-11 ]: Finished running node seed.sequra_analytics.orders_financial
[0m20:12:53.146460 [debug] [Thread-11 ]: Began running node model.sequra_analytics.stg_orders_financial
[0m20:12:53.147006 [info ] [Thread-11 ]: 5 of 24 START sql view model dbt_maximerosa_staging.stg_orders_financial ....... [RUN]
[0m20:12:53.147644 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a39e2d0>]}
[0m20:12:53.147965 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly seed.sequra_analytics.orders_financial, now model.sequra_analytics.stg_orders_financial)
[0m20:12:53.148536 [info ] [Thread-9 (]: 1 of 24 OK loaded seed file dbt_maximerosa_raw_data.dim_shoppers ............... [[32mINSERT 9[0m in 3.71s]
[0m20:12:53.148906 [debug] [Thread-11 ]: Began compiling node model.sequra_analytics.stg_orders_financial
[0m20:12:53.149297 [debug] [Thread-9 (]: Finished running node seed.sequra_analytics.dim_shoppers
[0m20:12:53.155560 [debug] [Thread-11 ]: Writing injected SQL for node "model.sequra_analytics.stg_orders_financial"
[0m20:12:53.156572 [debug] [Thread-9 (]: Began running node model.sequra_analytics.stg_dim_shoppers
[0m20:12:53.157136 [info ] [Thread-9 (]: 6 of 24 START sql view model dbt_maximerosa_staging.stg_dim_shoppers ........... [RUN]
[0m20:12:53.157637 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly seed.sequra_analytics.dim_shoppers, now model.sequra_analytics.stg_dim_shoppers)
[0m20:12:53.157915 [debug] [Thread-9 (]: Began compiling node model.sequra_analytics.stg_dim_shoppers
[0m20:12:53.160479 [debug] [Thread-9 (]: Writing injected SQL for node "model.sequra_analytics.stg_dim_shoppers"
[0m20:12:53.161277 [debug] [Thread-11 ]: Began executing node model.sequra_analytics.stg_orders_financial
[0m20:12:53.177418 [debug] [Thread-11 ]: Writing runtime sql for node "model.sequra_analytics.stg_orders_financial"
[0m20:12:53.177933 [debug] [Thread-9 (]: Began executing node model.sequra_analytics.stg_dim_shoppers
[0m20:12:53.179864 [debug] [Thread-9 (]: Writing runtime sql for node "model.sequra_analytics.stg_dim_shoppers"
[0m20:12:53.180738 [debug] [Thread-11 ]: Using snowflake connection "model.sequra_analytics.stg_orders_financial"
[0m20:12:53.180997 [debug] [Thread-11 ]: On model.sequra_analytics.stg_orders_financial: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders_financial
  
  
  
  
  as (
    

select
    order_id,
    shopper_id,
    to_date(order_date) as order_date,
    date_trunc('month', to_date(order_date)) as order_month,
    to_char(to_date(order_date), 'YYYY-MM') as month_year_order,
    product_id,
    case product_id
        when 1 then 'FlexPay'
        when 2 then 'PayLater'
        when 3 then 'DirectPay'
        else 'Product_' || product_id::varchar
    end as product,
    merchant_id,
    is_in_default,
    days_unbalanced,
    current_order_value,
    overdue_principal,
    overdue_fees,
    overdue_principal + overdue_fees as total_overdue
from SEQURA_DEV.dbt_maximerosa_raw_data.orders_financial
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders_financial"} */;
[0m20:12:53.181214 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m20:12:53.184136 [debug] [Thread-9 (]: Using snowflake connection "model.sequra_analytics.stg_dim_shoppers"
[0m20:12:53.184815 [debug] [Thread-9 (]: On model.sequra_analytics.stg_dim_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_dim_shoppers
  
  
  
  
  as (
    

select
    shopper_id,
    age as shopper_age
from SEQURA_DEV.dbt_maximerosa_raw_data.dim_shoppers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_dim_shoppers"} */;
[0m20:12:53.185652 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m20:12:53.504223 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.380 seconds
[0m20:12:53.505559 [debug] [Thread-10 ]: Writing runtime SQL for node "seed.sequra_analytics.merchants"
[0m20:12:53.511249 [debug] [Thread-10 ]: On seed.sequra_analytics.merchants: Close
[0m20:12:53.591090 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db6af00>]}
[0m20:12:53.591849 [info ] [Thread-10 ]: 2 of 24 OK loaded seed file dbt_maximerosa_raw_data.merchants .................. [[32mINSERT 6[0m in 4.15s]
[0m20:12:53.592364 [debug] [Thread-10 ]: Finished running node seed.sequra_analytics.merchants
[0m20:12:53.592969 [debug] [Thread-10 ]: Began running node model.sequra_analytics.stg_merchants
[0m20:12:53.593506 [info ] [Thread-10 ]: 7 of 24 START sql view model dbt_maximerosa_staging.stg_merchants .............. [RUN]
[0m20:12:53.593967 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly seed.sequra_analytics.merchants, now model.sequra_analytics.stg_merchants)
[0m20:12:53.594288 [debug] [Thread-10 ]: Began compiling node model.sequra_analytics.stg_merchants
[0m20:12:53.598225 [debug] [Thread-10 ]: Writing injected SQL for node "model.sequra_analytics.stg_merchants"
[0m20:12:53.599878 [debug] [Thread-10 ]: Began executing node model.sequra_analytics.stg_merchants
[0m20:12:53.603025 [debug] [Thread-10 ]: Writing runtime sql for node "model.sequra_analytics.stg_merchants"
[0m20:12:53.605044 [debug] [Thread-10 ]: Using snowflake connection "model.sequra_analytics.stg_merchants"
[0m20:12:53.605605 [debug] [Thread-10 ]: On model.sequra_analytics.stg_merchants: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
  
  
  
  
  as (
    

select
    merchant_id,
    merchant_name
from SEQURA_DEV.dbt_maximerosa_raw_data.merchants
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_merchants"} */;
[0m20:12:53.605957 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m20:12:53.810208 [debug] [Thread-12 ]: SQL status: SUCCESS 25 in 0.826 seconds
[0m20:12:53.811985 [debug] [Thread-12 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m20:12:53.812910 [debug] [Thread-12 ]: On seed.sequra_analytics.orders_merchant: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m20:12:54.124132 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 0.307 seconds
[0m20:12:54.127452 [debug] [Thread-12 ]: Writing runtime SQL for node "seed.sequra_analytics.orders_merchant"
[0m20:12:54.130411 [debug] [Thread-12 ]: On seed.sequra_analytics.orders_merchant: Close
[0m20:12:54.225892 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d922690>]}
[0m20:12:54.226705 [info ] [Thread-12 ]: 4 of 24 OK loaded seed file dbt_maximerosa_raw_data.orders_merchant ............ [[32mINSERT 25[0m in 4.78s]
[0m20:12:54.227322 [debug] [Thread-12 ]: Finished running node seed.sequra_analytics.orders_merchant
[0m20:12:54.228191 [debug] [Thread-12 ]: Began running node model.sequra_analytics.stg_orders
[0m20:12:54.229032 [info ] [Thread-12 ]: 8 of 24 START sql view model dbt_maximerosa_staging.stg_orders ................. [RUN]
[0m20:12:54.229645 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly seed.sequra_analytics.orders_merchant, now model.sequra_analytics.stg_orders)
[0m20:12:54.230089 [debug] [Thread-12 ]: Began compiling node model.sequra_analytics.stg_orders
[0m20:12:54.234422 [debug] [Thread-12 ]: Writing injected SQL for node "model.sequra_analytics.stg_orders"
[0m20:12:54.236097 [debug] [Thread-12 ]: Began executing node model.sequra_analytics.stg_orders
[0m20:12:54.239372 [debug] [Thread-12 ]: Writing runtime sql for node "model.sequra_analytics.stg_orders"
[0m20:12:54.244472 [debug] [Thread-12 ]: Using snowflake connection "model.sequra_analytics.stg_orders"
[0m20:12:54.245023 [debug] [Thread-12 ]: On model.sequra_analytics.stg_orders: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders
  
  
  
  
  as (
    

with source_data as (
    select
        order_id,
        shopper_id,
        merchant_id,
        order_date as order_date_raw,
        -- Parse the date format (d/m/yy or dd/mm/yy)
        case 
            when split_part(order_date, '/', 3) = '22' then '2022'
            when split_part(order_date, '/', 3) = '23' then '2023'
            else '20' || split_part(order_date, '/', 3)
        end || '-' ||
        lpad(split_part(order_date, '/', 2), 2, '0') || '-' ||
        lpad(split_part(order_date, '/', 1), 2, '0') as order_date_formatted
    from SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant
)

select
    order_id,
    shopper_id,
    merchant_id,
    order_date_raw,
    to_date(order_date_formatted, 'YYYY-MM-DD') as order_date,
    date_trunc('month', to_date(order_date_formatted, 'YYYY-MM-DD')) as order_month,
    to_char(to_date(order_date_formatted, 'YYYY-MM-DD'), 'YYYY-MM') as month_year
from source_data
where order_date_raw is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders"} */;
[0m20:12:54.245383 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m20:12:55.644568 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.459 seconds
[0m20:12:55.647984 [debug] [Thread-9 (]: On model.sequra_analytics.stg_dim_shoppers: Close
[0m20:12:55.728025 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbf2c90>]}
[0m20:12:55.728545 [info ] [Thread-9 (]: 6 of 24 OK created sql view model dbt_maximerosa_staging.stg_dim_shoppers ...... [[32mSUCCESS 1[0m in 2.57s]
[0m20:12:55.728962 [debug] [Thread-9 (]: Finished running node model.sequra_analytics.stg_dim_shoppers
[0m20:12:55.764476 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.583 seconds
[0m20:12:55.766133 [debug] [Thread-11 ]: On model.sequra_analytics.stg_orders_financial: Close
[0m20:12:55.843835 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ab290>]}
[0m20:12:55.844633 [info ] [Thread-11 ]: 5 of 24 OK created sql view model dbt_maximerosa_staging.stg_orders_financial .. [[32mSUCCESS 1[0m in 2.70s]
[0m20:12:55.845139 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.stg_orders_financial
[0m20:12:56.001236 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.395 seconds
[0m20:12:56.003753 [debug] [Thread-10 ]: On model.sequra_analytics.stg_merchants: Close
[0m20:12:56.104185 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbf1910>]}
[0m20:12:56.105653 [info ] [Thread-10 ]: 7 of 24 OK created sql view model dbt_maximerosa_staging.stg_merchants ......... [[32mSUCCESS 1[0m in 2.51s]
[0m20:12:56.106639 [debug] [Thread-10 ]: Finished running node model.sequra_analytics.stg_merchants
[0m20:12:56.107585 [debug] [Thread-9 (]: Began running node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m20:12:56.107979 [debug] [Thread-11 ]: Began running node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m20:12:56.108283 [debug] [Thread-10 ]: Began running node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m20:12:56.108578 [info ] [Thread-9 (]: 9 of 24 START test not_null_stg_merchants_merchant_id .......................... [RUN]
[0m20:12:56.108903 [info ] [Thread-11 ]: 10 of 24 START test not_null_stg_merchants_merchant_name ....................... [RUN]
[0m20:12:56.109198 [info ] [Thread-10 ]: 11 of 24 START test unique_stg_merchants_merchant_id ........................... [RUN]
[0m20:12:56.109666 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_dim_shoppers, now test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d)
[0m20:12:56.110010 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders_financial, now test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b)
[0m20:12:56.110290 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_merchants, now test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1)
[0m20:12:56.110595 [debug] [Thread-9 (]: Began compiling node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m20:12:56.110864 [debug] [Thread-11 ]: Began compiling node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m20:12:56.111120 [debug] [Thread-10 ]: Began compiling node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m20:12:56.129099 [debug] [Thread-9 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d"
[0m20:12:56.130200 [debug] [Thread-11 ]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b"
[0m20:12:56.135339 [debug] [Thread-10 ]: Writing injected SQL for node "test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1"
[0m20:12:56.136437 [debug] [Thread-9 (]: Began executing node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m20:12:56.136735 [debug] [Thread-11 ]: Began executing node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m20:12:56.143068 [debug] [Thread-10 ]: Began executing node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m20:12:56.153088 [debug] [Thread-11 ]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b"
[0m20:12:56.153427 [debug] [Thread-9 (]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d"
[0m20:12:56.155693 [debug] [Thread-10 ]: Writing runtime sql for node "test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1"
[0m20:12:56.159302 [debug] [Thread-11 ]: Using snowflake connection "test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b"
[0m20:12:56.159800 [debug] [Thread-10 ]: Using snowflake connection "test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1"
[0m20:12:56.160040 [debug] [Thread-11 ]: On test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select merchant_name
from SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
where merchant_name is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b"} */
[0m20:12:56.160432 [debug] [Thread-9 (]: Using snowflake connection "test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d"
[0m20:12:56.160640 [debug] [Thread-10 ]: On test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    merchant_id as unique_field,
    count(*) as n_records

from SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
where merchant_id is not null
group by merchant_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1"} */
[0m20:12:56.160847 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m20:12:56.161087 [debug] [Thread-9 (]: On test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select merchant_id
from SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
where merchant_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d"} */
[0m20:12:56.161279 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m20:12:56.161505 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m20:12:56.664872 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 2.419 seconds
[0m20:12:56.668196 [debug] [Thread-12 ]: On model.sequra_analytics.stg_orders: Close
[0m20:12:56.774919 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d95d730>]}
[0m20:12:56.775806 [info ] [Thread-12 ]: 8 of 24 OK created sql view model dbt_maximerosa_staging.stg_orders ............ [[32mSUCCESS 1[0m in 2.55s]
[0m20:12:56.776216 [debug] [Thread-12 ]: Finished running node model.sequra_analytics.stg_orders
[0m20:12:56.776784 [debug] [Thread-12 ]: Began running node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m20:12:56.777169 [info ] [Thread-12 ]: 12 of 24 START test not_null_stg_orders_merchant_id ............................ [RUN]
[0m20:12:56.777625 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders, now test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2)
[0m20:12:56.777942 [debug] [Thread-12 ]: Began compiling node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m20:12:56.784080 [debug] [Thread-12 ]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2"
[0m20:12:56.785608 [debug] [Thread-12 ]: Began executing node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m20:12:56.788915 [debug] [Thread-12 ]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2"
[0m20:12:56.793556 [debug] [Thread-12 ]: Using snowflake connection "test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2"
[0m20:12:56.794083 [debug] [Thread-12 ]: On test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select merchant_id
from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where merchant_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2"} */
[0m20:12:56.794424 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m20:12:58.646303 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.484 seconds
[0m20:12:58.653159 [debug] [Thread-9 (]: On test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d: Close
[0m20:12:58.698259 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.537 seconds
[0m20:12:58.700020 [debug] [Thread-11 ]: On test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b: Close
[0m20:12:58.736926 [info ] [Thread-9 (]: 9 of 24 PASS not_null_stg_merchants_merchant_id ................................ [[32mPASS[0m in 2.63s]
[0m20:12:58.737953 [debug] [Thread-9 (]: Finished running node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m20:12:58.738537 [debug] [Thread-9 (]: Began running node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m20:12:58.739162 [info ] [Thread-9 (]: 13 of 24 START test not_null_stg_orders_order_date ............................. [RUN]
[0m20:12:58.739888 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d, now test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb)
[0m20:12:58.740337 [debug] [Thread-9 (]: Began compiling node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m20:12:58.745271 [debug] [Thread-9 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb"
[0m20:12:58.746822 [debug] [Thread-9 (]: Began executing node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m20:12:58.749511 [debug] [Thread-9 (]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb"
[0m20:12:58.751073 [debug] [Thread-9 (]: Using snowflake connection "test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb"
[0m20:12:58.751536 [debug] [Thread-9 (]: On test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where order_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb"} */
[0m20:12:58.751871 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m20:12:58.761951 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.601 seconds
[0m20:12:58.763565 [debug] [Thread-10 ]: On test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1: Close
[0m20:12:58.778431 [info ] [Thread-11 ]: 10 of 24 PASS not_null_stg_merchants_merchant_name ............................. [[32mPASS[0m in 2.67s]
[0m20:12:58.778985 [debug] [Thread-11 ]: Finished running node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m20:12:58.779270 [debug] [Thread-11 ]: Began running node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m20:12:58.779507 [info ] [Thread-11 ]: 14 of 24 START test not_null_stg_orders_order_id ............................... [RUN]
[0m20:12:58.779955 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b, now test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:12:58.780254 [debug] [Thread-11 ]: Began compiling node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m20:12:58.783596 [debug] [Thread-11 ]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:12:58.786612 [debug] [Thread-11 ]: Began executing node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m20:12:58.788368 [debug] [Thread-11 ]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:12:58.793108 [debug] [Thread-11 ]: Using snowflake connection "test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:12:58.793485 [debug] [Thread-11 ]: On test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64"} */
[0m20:12:58.793766 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m20:12:58.841574 [info ] [Thread-10 ]: 11 of 24 PASS unique_stg_merchants_merchant_id ................................. [[32mPASS[0m in 2.73s]
[0m20:12:58.841980 [debug] [Thread-10 ]: Finished running node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m20:12:58.842213 [debug] [Thread-10 ]: Began running node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m20:12:58.842420 [info ] [Thread-10 ]: 15 of 24 START test not_null_stg_orders_shopper_id ............................. [RUN]
[0m20:12:58.842791 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1, now test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112)
[0m20:12:58.843178 [debug] [Thread-10 ]: Began compiling node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m20:12:58.846001 [debug] [Thread-10 ]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112"
[0m20:12:58.848301 [debug] [Thread-10 ]: Began executing node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m20:12:58.850963 [debug] [Thread-10 ]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112"
[0m20:12:58.852287 [debug] [Thread-10 ]: Using snowflake connection "test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112"
[0m20:12:58.852623 [debug] [Thread-10 ]: On test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shopper_id
from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where shopper_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112"} */
[0m20:12:58.852839 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m20:12:59.236133 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 2.441 seconds
[0m20:12:59.240120 [debug] [Thread-12 ]: On test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2: Close
[0m20:12:59.325403 [info ] [Thread-12 ]: 12 of 24 PASS not_null_stg_orders_merchant_id .................................. [[32mPASS[0m in 2.55s]
[0m20:12:59.326458 [debug] [Thread-12 ]: Finished running node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m20:12:59.327073 [debug] [Thread-12 ]: Began running node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m20:12:59.327770 [info ] [Thread-12 ]: 16 of 24 START test unique_stg_orders_order_id ................................. [RUN]
[0m20:12:59.328600 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2, now test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a)
[0m20:12:59.329185 [debug] [Thread-12 ]: Began compiling node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m20:12:59.334658 [debug] [Thread-12 ]: Writing injected SQL for node "test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m20:12:59.336731 [debug] [Thread-12 ]: Began executing node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m20:12:59.339848 [debug] [Thread-12 ]: Writing runtime sql for node "test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m20:12:59.343993 [debug] [Thread-12 ]: Using snowflake connection "test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m20:12:59.344395 [debug] [Thread-12 ]: On test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a"} */
[0m20:12:59.344704 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m20:13:01.166799 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.373 seconds
[0m20:13:01.169946 [debug] [Thread-11 ]: On test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m20:13:01.270300 [info ] [Thread-11 ]: 14 of 24 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 2.49s]
[0m20:13:01.271367 [debug] [Thread-11 ]: Finished running node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m20:13:01.271718 [debug] [Thread-11 ]: Began running node model.sequra_analytics.int_orders_with_defaults
[0m20:13:01.272195 [info ] [Thread-11 ]: 17 of 24 START sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [RUN]
[0m20:13:01.272620 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64, now model.sequra_analytics.int_orders_with_defaults)
[0m20:13:01.272939 [debug] [Thread-11 ]: Began compiling node model.sequra_analytics.int_orders_with_defaults
[0m20:13:01.277330 [debug] [Thread-11 ]: Writing injected SQL for node "model.sequra_analytics.int_orders_with_defaults"
[0m20:13:01.279521 [debug] [Thread-11 ]: Began executing node model.sequra_analytics.int_orders_with_defaults
[0m20:13:01.282975 [debug] [Thread-11 ]: Writing runtime sql for node "model.sequra_analytics.int_orders_with_defaults"
[0m20:13:01.283963 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.532 seconds
[0m20:13:01.286529 [debug] [Thread-9 (]: On test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb: Close
[0m20:13:01.288749 [debug] [Thread-11 ]: Using snowflake connection "model.sequra_analytics.int_orders_with_defaults"
[0m20:13:01.289088 [debug] [Thread-11 ]: On model.sequra_analytics.int_orders_with_defaults: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
  
  
  
  
  as (
    

with orders_enriched as (
    select
        -- Order information
        o.order_id,
        o.order_date,
        o.order_month,
        o.month_year_order,
        
        -- Product and merchant
        o.product_id,
        o.product,
        o.merchant_id,
        m.merchant_name as merchant,
        
        -- Shopper information
        o.shopper_id,
        s.shopper_age,
        
        -- Financial metrics
        o.is_in_default,
        o.days_unbalanced,
        o.current_order_value,
        o.overdue_principal,
        o.overdue_fees,
        o.total_overdue,
        
        -- Calculated delayed period (for filtering, not cumulative)
        case
            when o.days_unbalanced > 90 then '90'
            when o.days_unbalanced > 60 then '60'
            when o.days_unbalanced > 30 then '30'
            when o.days_unbalanced > 17 then '17'
            else null
        end as max_delayed_period
        
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders_financial o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_dim_shoppers s
        on o.shopper_id = s.shopper_id
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
)

select * from orders_enriched
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_orders_with_defaults"} */;
[0m20:13:01.289320 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m20:13:01.303215 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.450 seconds
[0m20:13:01.305017 [debug] [Thread-10 ]: On test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112: Close
[0m20:13:01.360291 [info ] [Thread-9 (]: 13 of 24 PASS not_null_stg_orders_order_date ................................... [[32mPASS[0m in 2.62s]
[0m20:13:01.360710 [debug] [Thread-9 (]: Finished running node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m20:13:01.385791 [info ] [Thread-10 ]: 15 of 24 PASS not_null_stg_orders_shopper_id ................................... [[32mPASS[0m in 2.54s]
[0m20:13:01.386230 [debug] [Thread-10 ]: Finished running node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m20:13:01.677689 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 2.333 seconds
[0m20:13:01.680301 [debug] [Thread-12 ]: On test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a: Close
[0m20:13:01.773718 [info ] [Thread-12 ]: 16 of 24 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 2.45s]
[0m20:13:01.774562 [debug] [Thread-12 ]: Finished running node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m20:13:01.775251 [debug] [Thread-9 (]: Began running node model.sequra_analytics.int_monthly_shoppers
[0m20:13:01.775598 [debug] [Thread-10 ]: Began running node model.sequra_analytics.int_recurrent_shoppers
[0m20:13:01.776102 [info ] [Thread-9 (]: 18 of 24 START sql view model dbt_maximerosa_intermediate.int_monthly_shoppers . [RUN]
[0m20:13:01.776580 [info ] [Thread-10 ]: 19 of 24 START sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers  [RUN]
[0m20:13:01.777006 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb, now model.sequra_analytics.int_monthly_shoppers)
[0m20:13:01.777401 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112, now model.sequra_analytics.int_recurrent_shoppers)
[0m20:13:01.777749 [debug] [Thread-9 (]: Began compiling node model.sequra_analytics.int_monthly_shoppers
[0m20:13:01.778051 [debug] [Thread-10 ]: Began compiling node model.sequra_analytics.int_recurrent_shoppers
[0m20:13:01.783274 [debug] [Thread-10 ]: Writing injected SQL for node "model.sequra_analytics.int_recurrent_shoppers"
[0m20:13:01.785874 [debug] [Thread-9 (]: Writing injected SQL for node "model.sequra_analytics.int_monthly_shoppers"
[0m20:13:01.787316 [debug] [Thread-10 ]: Began executing node model.sequra_analytics.int_recurrent_shoppers
[0m20:13:01.787832 [debug] [Thread-9 (]: Began executing node model.sequra_analytics.int_monthly_shoppers
[0m20:13:01.791034 [debug] [Thread-10 ]: Writing runtime sql for node "model.sequra_analytics.int_recurrent_shoppers"
[0m20:13:01.793591 [debug] [Thread-9 (]: Writing runtime sql for node "model.sequra_analytics.int_monthly_shoppers"
[0m20:13:01.796637 [debug] [Thread-10 ]: Using snowflake connection "model.sequra_analytics.int_recurrent_shoppers"
[0m20:13:01.797648 [debug] [Thread-9 (]: Using snowflake connection "model.sequra_analytics.int_monthly_shoppers"
[0m20:13:01.798196 [debug] [Thread-10 ]: On model.sequra_analytics.int_recurrent_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers
  
  
  
  
  as (
    

with order_history as (
    select
        o1.order_month as current_month,
        o1.month_year as current_month_year,
        o1.merchant_id,
        o1.shopper_id,
        count(distinct o2.order_month) as months_with_purchases
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o1
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_orders o2
        on o1.merchant_id = o2.merchant_id
        and o1.shopper_id = o2.shopper_id
        and o2.order_date between dateadd(month, -11, o1.order_month) and last_day(o1.order_month)
        and o2.order_month <= o1.order_month
    group by 1, 2, 3, 4
)

select
    current_month,
    current_month_year,
    merchant_id,
    shopper_id,
    months_with_purchases,
    -- A shopper is recurrent if they have made purchases in at least 2 different months
    -- within the 12-month window including the current month
    case 
        when months_with_purchases >= 2 then 1 
        else 0 
    end as is_recurrent
from order_history
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_recurrent_shoppers"} */;
[0m20:13:01.798729 [debug] [Thread-9 (]: On model.sequra_analytics.int_monthly_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers
  
  
  
  
  as (
    

with monthly_orders as (
    select distinct
        order_month,
        month_year,
        merchant_id,
        shopper_id
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
)

select
    order_month,
    month_year,
    merchant_id,
    shopper_id
from monthly_orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_monthly_shoppers"} */;
[0m20:13:01.799118 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m20:13:01.799455 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m20:13:03.855445 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.566 seconds
[0m20:13:03.857859 [debug] [Thread-11 ]: On model.sequra_analytics.int_orders_with_defaults: Close
[0m20:13:03.928170 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d932870>]}
[0m20:13:03.928884 [info ] [Thread-11 ]: 17 of 24 OK created sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [[32mSUCCESS 1[0m in 2.66s]
[0m20:13:03.929343 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.int_orders_with_defaults
[0m20:13:03.929808 [debug] [Thread-12 ]: Began running node model.sequra_analytics.default_ratio_analysis
[0m20:13:03.930217 [info ] [Thread-12 ]: 20 of 24 START sql table model dbt_maximerosa_marts.default_ratio_analysis ..... [RUN]
[0m20:13:03.930592 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a, now model.sequra_analytics.default_ratio_analysis)
[0m20:13:03.930874 [debug] [Thread-12 ]: Began compiling node model.sequra_analytics.default_ratio_analysis
[0m20:13:03.933698 [debug] [Thread-12 ]: Writing injected SQL for node "model.sequra_analytics.default_ratio_analysis"
[0m20:13:03.934626 [debug] [Thread-12 ]: Began executing node model.sequra_analytics.default_ratio_analysis
[0m20:13:03.952006 [debug] [Thread-12 ]: Writing runtime sql for node "model.sequra_analytics.default_ratio_analysis"
[0m20:13:03.961261 [debug] [Thread-12 ]: Using snowflake connection "model.sequra_analytics.default_ratio_analysis"
[0m20:13:03.961674 [debug] [Thread-12 ]: On model.sequra_analytics.default_ratio_analysis: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.default_ratio_analysis
    
    
    
    as (

-- Now we properly use the intermediate model!
with base_data as (
    select * from SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
    where is_in_default = true  -- Only defaults for this analysis
),

-- Generate records for each applicable delayed period using UNION ALL
-- This implements the cumulative logic: 35 days appears in both 17 and 30
expanded_periods as (
    -- Period 17: All orders with days_unbalanced > 17
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '17' as delayed_period
    from base_data
    where days_unbalanced > 17
    
    union all
    
    -- Period 30: All orders with days_unbalanced > 30
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '30' as delayed_period
    from base_data
    where days_unbalanced > 30
    
    union all
    
    -- Period 60: All orders with days_unbalanced > 60
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '60' as delayed_period
    from base_data
    where days_unbalanced > 60
    
    union all
    
    -- Period 90: All orders with days_unbalanced > 90
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '90' as delayed_period
    from base_data
    where days_unbalanced > 90
)

-- Final output with exact columns requested
select distinct
    shopper_age,
    month_year_order,
    product,
    merchant,
    default_type,
    delayed_period
from expanded_periods
where merchant is not null  -- Exclude records without merchant mapping
order by 
    month_year_order,
    merchant,
    cast(delayed_period as integer)
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.default_ratio_analysis"} */;
[0m20:13:03.961993 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m20:13:04.364191 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.565 seconds
[0m20:13:04.365085 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.566 seconds
[0m20:13:04.367239 [debug] [Thread-9 (]: On model.sequra_analytics.int_monthly_shoppers: Close
[0m20:13:04.368820 [debug] [Thread-10 ]: On model.sequra_analytics.int_recurrent_shoppers: Close
[0m20:13:04.456404 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9316d0>]}
[0m20:13:04.458627 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960c470>]}
[0m20:13:04.457677 [info ] [Thread-9 (]: 18 of 24 OK created sql view model dbt_maximerosa_intermediate.int_monthly_shoppers  [[32mSUCCESS 1[0m in 2.68s]
[0m20:13:04.459694 [info ] [Thread-10 ]: 19 of 24 OK created sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers  [[32mSUCCESS 1[0m in 2.68s]
[0m20:13:04.460649 [debug] [Thread-9 (]: Finished running node model.sequra_analytics.int_monthly_shoppers
[0m20:13:04.461343 [debug] [Thread-10 ]: Finished running node model.sequra_analytics.int_recurrent_shoppers
[0m20:13:04.462352 [debug] [Thread-11 ]: Began running node model.sequra_analytics.shopper_recurrence_rate
[0m20:13:04.462978 [info ] [Thread-11 ]: 21 of 24 START sql table model dbt_maximerosa_marts.shopper_recurrence_rate .... [RUN]
[0m20:13:04.463492 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_orders_with_defaults, now model.sequra_analytics.shopper_recurrence_rate)
[0m20:13:04.463940 [debug] [Thread-11 ]: Began compiling node model.sequra_analytics.shopper_recurrence_rate
[0m20:13:04.468763 [debug] [Thread-11 ]: Writing injected SQL for node "model.sequra_analytics.shopper_recurrence_rate"
[0m20:13:04.470718 [debug] [Thread-11 ]: Began executing node model.sequra_analytics.shopper_recurrence_rate
[0m20:13:04.473898 [debug] [Thread-11 ]: Writing runtime sql for node "model.sequra_analytics.shopper_recurrence_rate"
[0m20:13:04.477473 [debug] [Thread-11 ]: Using snowflake connection "model.sequra_analytics.shopper_recurrence_rate"
[0m20:13:04.477901 [debug] [Thread-11 ]: On model.sequra_analytics.shopper_recurrence_rate: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
    
    
    
    as (

with monthly_metrics as (
    select
        ms.order_month,
        ms.month_year,
        ms.merchant_id,
        m.merchant_name,
        count(distinct ms.shopper_id) as total_shoppers,
        sum(rs.is_recurrent) as recurrent_shoppers
    from SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers ms
    left join SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers rs
        on ms.order_month = rs.current_month
        and ms.merchant_id = rs.merchant_id
        and ms.shopper_id = rs.shopper_id
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on ms.merchant_id = m.merchant_id
    group by 1, 2, 3, 4
)

select
    merchant_name,
    month_year as month,
    round(
        case 
            when total_shoppers > 0 
            then (recurrent_shoppers::decimal / total_shoppers) * 100
            else 0 
        end, 2
    ) as recurrence_rate
from monthly_metrics
order by merchant_name, month
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.shopper_recurrence_rate"} */;
[0m20:13:04.478247 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m20:13:07.429429 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 3.466 seconds
[0m20:13:07.433959 [debug] [Thread-12 ]: On model.sequra_analytics.default_ratio_analysis: Close
[0m20:13:07.522088 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da64410>]}
[0m20:13:07.522897 [info ] [Thread-12 ]: 20 of 24 OK created sql table model dbt_maximerosa_marts.default_ratio_analysis  [[32mSUCCESS 1[0m in 3.59s]
[0m20:13:07.523686 [debug] [Thread-12 ]: Finished running node model.sequra_analytics.default_ratio_analysis
[0m20:13:07.847719 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 3.369 seconds
[0m20:13:07.849409 [debug] [Thread-11 ]: On model.sequra_analytics.shopper_recurrence_rate: Close
[0m20:13:07.946230 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7697d68-e2fc-4951-946a-bc34699ca54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109603140>]}
[0m20:13:07.947431 [info ] [Thread-11 ]: 21 of 24 OK created sql table model dbt_maximerosa_marts.shopper_recurrence_rate  [[32mSUCCESS 1[0m in 3.48s]
[0m20:13:07.948125 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.shopper_recurrence_rate
[0m20:13:07.949057 [debug] [Thread-10 ]: Began running node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m20:13:07.949462 [debug] [Thread-9 (]: Began running node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m20:13:07.949943 [info ] [Thread-10 ]: 22 of 24 START test not_null_shopper_recurrence_rate_merchant_name ............. [RUN]
[0m20:13:07.950372 [debug] [Thread-12 ]: Began running node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m20:13:07.950836 [info ] [Thread-9 (]: 23 of 24 START test not_null_shopper_recurrence_rate_month ..................... [RUN]
[0m20:13:07.951479 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_recurrent_shoppers, now test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8)
[0m20:13:07.951963 [info ] [Thread-12 ]: 24 of 24 START test not_null_shopper_recurrence_rate_recurrence_rate ........... [RUN]
[0m20:13:07.952516 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_monthly_shoppers, now test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817)
[0m20:13:07.952969 [debug] [Thread-10 ]: Began compiling node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m20:13:07.953298 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.default_ratio_analysis, now test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1)
[0m20:13:07.953617 [debug] [Thread-9 (]: Began compiling node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m20:13:07.957695 [debug] [Thread-10 ]: Writing injected SQL for node "test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8"
[0m20:13:07.957978 [debug] [Thread-12 ]: Began compiling node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m20:13:07.963295 [debug] [Thread-9 (]: Writing injected SQL for node "test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817"
[0m20:13:07.967338 [debug] [Thread-12 ]: Writing injected SQL for node "test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1"
[0m20:13:07.968080 [debug] [Thread-10 ]: Began executing node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m20:13:07.970133 [debug] [Thread-10 ]: Writing runtime sql for node "test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8"
[0m20:13:07.970573 [debug] [Thread-9 (]: Began executing node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m20:13:07.972687 [debug] [Thread-9 (]: Writing runtime sql for node "test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817"
[0m20:13:07.972993 [debug] [Thread-12 ]: Began executing node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m20:13:07.975102 [debug] [Thread-12 ]: Writing runtime sql for node "test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1"
[0m20:13:07.976011 [debug] [Thread-10 ]: Using snowflake connection "test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8"
[0m20:13:07.976576 [debug] [Thread-9 (]: Using snowflake connection "test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817"
[0m20:13:07.976869 [debug] [Thread-10 ]: On test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select merchant_name
from SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
where merchant_name is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8"} */
[0m20:13:07.977160 [debug] [Thread-9 (]: On test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
where month is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817"} */
[0m20:13:07.977655 [debug] [Thread-12 ]: Using snowflake connection "test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1"
[0m20:13:07.977871 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m20:13:07.978100 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m20:13:07.978380 [debug] [Thread-12 ]: On test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recurrence_rate
from SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
where recurrence_rate is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1"} */
[0m20:13:07.979034 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m20:13:10.366443 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.388 seconds
[0m20:13:10.369160 [debug] [Thread-10 ]: On test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8: Close
[0m20:13:10.475374 [info ] [Thread-10 ]: 22 of 24 PASS not_null_shopper_recurrence_rate_merchant_name ................... [[32mPASS[0m in 2.52s]
[0m20:13:10.476240 [debug] [Thread-10 ]: Finished running node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m20:13:10.507914 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 2.529 seconds
[0m20:13:10.511092 [debug] [Thread-12 ]: On test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1: Close
[0m20:13:10.542650 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.564 seconds
[0m20:13:10.545302 [debug] [Thread-9 (]: On test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817: Close
[0m20:13:10.588837 [info ] [Thread-12 ]: 24 of 24 PASS not_null_shopper_recurrence_rate_recurrence_rate ................. [[32mPASS[0m in 2.64s]
[0m20:13:10.589875 [debug] [Thread-12 ]: Finished running node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m20:13:10.617494 [info ] [Thread-9 (]: 23 of 24 PASS not_null_shopper_recurrence_rate_month ........................... [[32mPASS[0m in 2.66s]
[0m20:13:10.618331 [debug] [Thread-9 (]: Finished running node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m20:13:10.619961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:10.620337 [debug] [MainThread]: Connection 'test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817' was properly closed.
[0m20:13:10.620578 [debug] [MainThread]: Connection 'test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8' was properly closed.
[0m20:13:10.620799 [debug] [MainThread]: Connection 'model.sequra_analytics.shopper_recurrence_rate' was properly closed.
[0m20:13:10.621006 [debug] [MainThread]: Connection 'test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1' was properly closed.
[0m20:13:10.621355 [info ] [MainThread]: 
[0m20:13:10.621646 [info ] [MainThread]: Finished running 4 seeds, 2 table models, 11 data tests, 7 view models in 0 hours 0 minutes and 27.01 seconds (27.01s).
[0m20:13:10.624810 [debug] [MainThread]: Command end result
[0m20:13:10.646859 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m20:13:10.651047 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m20:13:10.657211 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/run_results.json
[0m20:13:10.657493 [info ] [MainThread]: 
[0m20:13:10.657719 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:13:10.657900 [info ] [MainThread]: 
[0m20:13:10.658089 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m20:13:10.662802 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 27.786743, "process_in_blocks": "0", "process_kernel_time": 0.684964, "process_mem_max_rss": "191234048", "process_out_blocks": "0", "process_user_time": 3.790334}
[0m20:13:10.663160 [debug] [MainThread]: Command `dbt build` succeeded at 20:13:10.663098 after 27.79 seconds
[0m20:13:10.663427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bbc8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f1e330>]}
[0m20:13:10.663675 [debug] [MainThread]: Flushing usage events
[0m20:13:11.290214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:51.504891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037c4f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073195b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073192b0>]}


============================== 10:16:51.509596 | 353854ff-d808-441e-a311-bc4a3ead9489 ==============================
[0m10:16:51.509596 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:16:51.509961 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'printer_width': '80', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error': 'None', 'quiet': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'None', 'introspect': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics', 'log_format': 'default'}
[0m10:16:51.526279 [info ] [MainThread]: dbt version: 1.10.9
[0m10:16:51.526557 [info ] [MainThread]: python version: 3.12.7
[0m10:16:51.526700 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
[0m10:16:51.526829 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m10:16:52.107790 [info ] [MainThread]: Using profiles dir at /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics
[0m10:16:52.108091 [info ] [MainThread]: Using profiles.yml file at /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/profiles.yml
[0m10:16:52.108241 [info ] [MainThread]: Using dbt_project.yml file at /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/dbt_project.yml
[0m10:16:52.109115 [info ] [MainThread]: adapter type: snowflake
[0m10:16:52.109298 [info ] [MainThread]: adapter version: 1.10.0
[0m10:16:52.161652 [info ] [MainThread]: Configuration:
[0m10:16:52.161922 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:16:52.162066 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:16:52.162194 [info ] [MainThread]: Required dependencies:
[0m10:16:52.164776 [debug] [MainThread]: Executing "git --help"
[0m10:16:52.291312 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:16:52.291886 [debug] [MainThread]: STDERR: "b''"
[0m10:16:52.292077 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:16:52.292247 [info ] [MainThread]: Connection:
[0m10:16:52.292409 [info ] [MainThread]:   account: lqgtqud-rv87386
[0m10:16:52.292543 [info ] [MainThread]:   user: maximerosa
[0m10:16:52.292660 [info ] [MainThread]:   database: SEQURA_DEV
[0m10:16:52.292776 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m10:16:52.292892 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m10:16:52.293010 [info ] [MainThread]:   schema: dbt_maximerosa
[0m10:16:52.293125 [info ] [MainThread]:   authenticator: None
[0m10:16:52.293252 [info ] [MainThread]:   oauth_client_id: None
[0m10:16:52.293375 [info ] [MainThread]:   query_tag: None
[0m10:16:52.293489 [info ] [MainThread]:   client_session_keep_alive: True
[0m10:16:52.293601 [info ] [MainThread]:   host: None
[0m10:16:52.293722 [info ] [MainThread]:   port: None
[0m10:16:52.293831 [info ] [MainThread]:   proxy_host: None
[0m10:16:52.293941 [info ] [MainThread]:   proxy_port: None
[0m10:16:52.294064 [info ] [MainThread]:   protocol: None
[0m10:16:52.294171 [info ] [MainThread]:   connect_retries: 1
[0m10:16:52.294433 [info ] [MainThread]:   connect_timeout: None
[0m10:16:52.294595 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:16:52.294723 [info ] [MainThread]:   retry_all: False
[0m10:16:52.294839 [info ] [MainThread]:   insecure_mode: False
[0m10:16:52.294956 [info ] [MainThread]:   reuse_connections: None
[0m10:16:52.295067 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m10:16:52.295403 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:16:52.377323 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:16:52.449432 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:16:52.449794 [debug] [MainThread]: On debug: select 1 as id
[0m10:16:52.449940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:55.208138 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.758 seconds
[0m10:16:55.210134 [debug] [MainThread]: On debug: Close
[0m10:16:55.293944 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:16:55.294618 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:16:55.333442 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.8739173, "process_in_blocks": "0", "process_kernel_time": 0.319955, "process_mem_max_rss": "155435008", "process_out_blocks": "0", "process_user_time": 1.091781}
[0m10:16:55.334415 [debug] [MainThread]: Command `dbt debug` succeeded at 10:16:55.334316 after 3.88 seconds
[0m10:16:55.334751 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:16:55.335096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107030320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f958b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128e74d0>]}
[0m10:16:55.335461 [debug] [MainThread]: Flushing usage events
[0m10:16:55.751430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:17:15.917094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e0edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054cdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054cd9d0>]}


============================== 10:17:15.921309 | 3edd8b34-f368-4ca5-915d-956468717db7 ==============================
[0m10:17:15.921309 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:17:15.921621 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'target_path': 'None', 'fail_fast': 'False', 'introspect': 'True', 'printer_width': '80', 'version_check': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_format': 'default', 'log_path': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics', 'invocation_command': 'dbt build', 'no_print': 'None'}
[0m10:17:16.246425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa90d0>]}
[0m10:17:16.275730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe2cc0>]}
[0m10:17:16.277047 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:17:16.350242 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:17:16.488313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:16.488563 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:16.491524 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- seeds.sequra_analytics.orders_financial.column_types
- seeds.sequra_analytics.orders_merchant.column_types
- seeds.sequra_analytics.orders_merchant.merchants.column_types
- seeds.sequra_analytics.dim_shoppers.column_types
[0m10:17:16.513541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ef500>]}
[0m10:17:16.555305 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m10:17:16.557496 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m10:17:16.588346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603ffe0>]}
[0m10:17:16.588635 [info ] [MainThread]: Found 9 models, 4 seeds, 11 data tests, 479 macros
[0m10:17:16.590202 [info ] [MainThread]: 
[0m10:17:16.590385 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:17:16.590521 [info ] [MainThread]: 
[0m10:17:16.590763 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:17:16.593333 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m10:17:16.601034 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m10:17:16.601499 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m10:17:16.601804 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SEQURA_DEV'
[0m10:17:16.669336 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m10:17:16.669654 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m10:17:16.669861 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m10:17:16.670059 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m10:17:16.670251 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV"
[0m10:17:16.670388 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m10:17:16.670537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:16.670676 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m10:17:16.670835 [debug] [ThreadPool]: On list_SEQURA_DEV: show terse schemas in database SEQURA_DEV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV"} */
[0m10:17:16.670969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:16.671159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:16.671682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:19.500121 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.829 seconds
[0m10:17:19.500998 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.830 seconds
[0m10:17:19.503301 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m10:17:19.504210 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.834 seconds
[0m10:17:19.505738 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m10:17:19.508841 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m10:17:19.515864 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.844 seconds
[0m10:17:19.517089 [debug] [ThreadPool]: On list_SEQURA_DEV: Close
[0m10:17:19.624397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_staging)
[0m10:17:19.625075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_marts)
[0m10:17:19.626964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_raw_data)
[0m10:17:19.627472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SEQURA_DEV, now list_SEQURA_DEV_dbt_maximerosa_intermediate)
[0m10:17:19.638749 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_marts"
[0m10:17:19.640692 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_raw_data"
[0m10:17:19.642437 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_staging"
[0m10:17:19.644094 [debug] [ThreadPool]: Using snowflake connection "list_SEQURA_DEV_dbt_maximerosa_intermediate"
[0m10:17:19.644323 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: show objects in SEQURA_DEV.dbt_maximerosa_marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_marts"} */;
[0m10:17:19.644516 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: show objects in SEQURA_DEV.dbt_maximerosa_raw_data
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_raw_data"} */;
[0m10:17:19.644691 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: show objects in SEQURA_DEV.dbt_maximerosa_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_staging"} */;
[0m10:17:19.644883 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: show objects in SEQURA_DEV.dbt_maximerosa_intermediate
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "connection_name": "list_SEQURA_DEV_dbt_maximerosa_intermediate"} */;
[0m10:17:19.645046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:19.645196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:19.645343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:19.645507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:21.969171 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.324 seconds
[0m10:17:21.971354 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_marts: Close
[0m10:17:21.989231 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.344 seconds
[0m10:17:21.991548 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_raw_data: Close
[0m10:17:21.994322 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.349 seconds
[0m10:17:21.995987 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_staging: Close
[0m10:17:22.153583 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.508 seconds
[0m10:17:22.155676 [debug] [ThreadPool]: On list_SEQURA_DEV_dbt_maximerosa_intermediate: Close
[0m10:17:22.220640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1194584d0>]}
[0m10:17:22.223634 [debug] [Thread-9 (]: Began running node seed.sequra_analytics.dim_shoppers
[0m10:17:22.223907 [info ] [Thread-9 (]: 1 of 24 START seed file dbt_maximerosa_raw_data.dim_shoppers ................... [RUN]
[0m10:17:22.224120 [debug] [Thread-10 ]: Began running node seed.sequra_analytics.merchants
[0m10:17:22.224328 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_staging, now seed.sequra_analytics.dim_shoppers)
[0m10:17:22.224497 [debug] [Thread-11 ]: Began running node seed.sequra_analytics.orders_financial
[0m10:17:22.224709 [debug] [Thread-12 ]: Began running node seed.sequra_analytics.orders_merchant
[0m10:17:22.224950 [info ] [Thread-10 ]: 2 of 24 START seed file dbt_maximerosa_raw_data.merchants ...................... [RUN]
[0m10:17:22.225168 [debug] [Thread-9 (]: Began compiling node seed.sequra_analytics.dim_shoppers
[0m10:17:22.225372 [info ] [Thread-11 ]: 3 of 24 START seed file dbt_maximerosa_raw_data.orders_financial ............... [RUN]
[0m10:17:22.225581 [info ] [Thread-12 ]: 4 of 24 START seed file dbt_maximerosa_raw_data.orders_merchant ................ [RUN]
[0m10:17:22.225776 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_marts, now seed.sequra_analytics.merchants)
[0m10:17:22.225971 [debug] [Thread-9 (]: Began executing node seed.sequra_analytics.dim_shoppers
[0m10:17:22.226140 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_raw_data, now seed.sequra_analytics.orders_financial)
[0m10:17:22.226299 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly list_SEQURA_DEV_dbt_maximerosa_intermediate, now seed.sequra_analytics.orders_merchant)
[0m10:17:22.226456 [debug] [Thread-10 ]: Began compiling node seed.sequra_analytics.merchants
[0m10:17:22.232872 [debug] [Thread-11 ]: Began compiling node seed.sequra_analytics.orders_financial
[0m10:17:22.239850 [debug] [Thread-12 ]: Began compiling node seed.sequra_analytics.orders_merchant
[0m10:17:22.240139 [debug] [Thread-10 ]: Began executing node seed.sequra_analytics.merchants
[0m10:17:22.250298 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m10:17:22.250680 [debug] [Thread-11 ]: Began executing node seed.sequra_analytics.orders_financial
[0m10:17:22.251029 [debug] [Thread-12 ]: Began executing node seed.sequra_analytics.orders_merchant
[0m10:17:22.253489 [debug] [Thread-9 (]: On seed.sequra_analytics.dim_shoppers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */
[0m10:17:22.257056 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m10:17:22.258856 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m10:17:22.261263 [debug] [Thread-11 ]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m10:17:22.262698 [debug] [Thread-12 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m10:17:22.262935 [debug] [Thread-10 ]: On seed.sequra_analytics.merchants: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m10:17:22.264036 [debug] [Thread-11 ]: On seed.sequra_analytics.orders_financial: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */
[0m10:17:22.264328 [debug] [Thread-12 ]: On seed.sequra_analytics.orders_merchant: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m10:17:22.264805 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m10:17:22.265064 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m10:17:22.265246 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m10:17:24.603910 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.339 seconds
[0m10:17:24.604802 [debug] [Thread-11 ]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m10:17:24.605262 [debug] [Thread-11 ]: On seed.sequra_analytics.orders_financial: truncate table "SEQURA_DEV"."DBT_MAXIMEROSA_RAW_DATA"."ORDERS_FINANCIAL"
  
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */;
[0m10:17:24.615125 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 2.350 seconds
[0m10:17:24.615640 [debug] [Thread-12 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m10:17:24.616158 [debug] [Thread-12 ]: On seed.sequra_analytics.orders_merchant: truncate table "SEQURA_DEV"."DBT_MAXIMEROSA_RAW_DATA"."ORDERS_MERCHANT"
  
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */;
[0m10:17:24.630954 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.366 seconds
[0m10:17:24.631697 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m10:17:24.632179 [debug] [Thread-10 ]: On seed.sequra_analytics.merchants: truncate table "SEQURA_DEV"."DBT_MAXIMEROSA_RAW_DATA"."MERCHANTS"
  
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */;
[0m10:17:24.635887 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.377 seconds
[0m10:17:24.636315 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m10:17:24.636620 [debug] [Thread-9 (]: On seed.sequra_analytics.dim_shoppers: truncate table "SEQURA_DEV"."DBT_MAXIMEROSA_RAW_DATA"."DIM_SHOPPERS"
  
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */;
[0m10:17:24.928084 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.291 seconds
[0m10:17:24.930017 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m10:17:24.931198 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 0.314 seconds
[0m10:17:24.932338 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 0.327 seconds
[0m10:17:24.932895 [debug] [Thread-9 (]: On seed.sequra_analytics.dim_shoppers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */
[0m10:17:24.933519 [debug] [Thread-12 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m10:17:24.934079 [debug] [Thread-11 ]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m10:17:24.934872 [debug] [Thread-12 ]: On seed.sequra_analytics.orders_merchant: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m10:17:24.935725 [debug] [Thread-11 ]: On seed.sequra_analytics.orders_financial: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */
[0m10:17:25.054452 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.422 seconds
[0m10:17:25.055226 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m10:17:25.055676 [debug] [Thread-10 ]: On seed.sequra_analytics.merchants: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m10:17:25.233356 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 0.296 seconds
[0m10:17:25.234348 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 0.298 seconds
[0m10:17:25.250186 [debug] [Thread-11 ]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m10:17:25.252511 [debug] [Thread-12 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m10:17:25.253579 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.319 seconds
[0m10:17:25.254008 [debug] [Thread-11 ]: On seed.sequra_analytics.orders_financial: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */
[0m10:17:25.254268 [debug] [Thread-12 ]: On seed.sequra_analytics.orders_merchant: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m10:17:25.255164 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m10:17:25.255846 [debug] [Thread-9 (]: On seed.sequra_analytics.dim_shoppers: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */
[0m10:17:25.307202 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.251 seconds
[0m10:17:25.308314 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m10:17:25.308563 [debug] [Thread-10 ]: On seed.sequra_analytics.merchants: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m10:17:25.333445 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m10:17:25.334555 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m10:17:25.334938 [debug] [Thread-9 (]: On seed.sequra_analytics.dim_shoppers: insert into SEQURA_DEV.dbt_maximerosa_raw_data.dim_shoppers (shopper_id, age) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */...
[0m10:17:25.335738 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 0.080 seconds
[0m10:17:25.337279 [debug] [Thread-12 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m10:17:25.337955 [debug] [Thread-12 ]: On seed.sequra_analytics.orders_merchant: insert into SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant (order_id, shopper_id, merchant_id, order_date) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version":...
[0m10:17:25.339866 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 0.084 seconds
[0m10:17:25.341623 [debug] [Thread-11 ]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m10:17:25.342036 [debug] [Thread-11 ]: On seed.sequra_analytics.orders_financial: insert into SEQURA_DEV.dbt_maximerosa_raw_data.orders_financial (order_id, shopper_id, order_date, product_id, merchant_id, is_in_default, days_unbalanced, current_order_value, overdue_principal, overdue_fees) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m10:17:25.373253 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.064 seconds
[0m10:17:25.373970 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m10:17:25.374301 [debug] [Thread-10 ]: On seed.sequra_analytics.merchants: insert into SEQURA_DEV.dbt_maximerosa_raw_data.merchants (merchant_id, merchant_name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */...
[0m10:17:26.043807 [debug] [Thread-9 (]: SQL status: SUCCESS 9 in 0.708 seconds
[0m10:17:26.044642 [debug] [Thread-12 ]: SQL status: SUCCESS 25 in 0.706 seconds
[0m10:17:26.045191 [debug] [Thread-9 (]: Using snowflake connection "seed.sequra_analytics.dim_shoppers"
[0m10:17:26.045628 [debug] [Thread-12 ]: Using snowflake connection "seed.sequra_analytics.orders_merchant"
[0m10:17:26.046005 [debug] [Thread-9 (]: On seed.sequra_analytics.dim_shoppers: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.dim_shoppers"} */
[0m10:17:26.046693 [debug] [Thread-12 ]: On seed.sequra_analytics.orders_merchant: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_merchant"} */
[0m10:17:26.060687 [debug] [Thread-11 ]: SQL status: SUCCESS 25 in 0.718 seconds
[0m10:17:26.061603 [debug] [Thread-11 ]: Using snowflake connection "seed.sequra_analytics.orders_financial"
[0m10:17:26.062121 [debug] [Thread-11 ]: On seed.sequra_analytics.orders_financial: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.orders_financial"} */
[0m10:17:26.087273 [debug] [Thread-10 ]: SQL status: SUCCESS 6 in 0.713 seconds
[0m10:17:26.088017 [debug] [Thread-10 ]: Using snowflake connection "seed.sequra_analytics.merchants"
[0m10:17:26.088342 [debug] [Thread-10 ]: On seed.sequra_analytics.merchants: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "seed.sequra_analytics.merchants"} */
[0m10:17:26.277844 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 0.230 seconds
[0m10:17:26.282794 [debug] [Thread-12 ]: Writing runtime SQL for node "seed.sequra_analytics.orders_merchant"
[0m10:17:26.284055 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m10:17:26.284868 [debug] [Thread-9 (]: Writing runtime SQL for node "seed.sequra_analytics.dim_shoppers"
[0m10:17:26.285516 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 0.223 seconds
[0m10:17:26.286009 [debug] [Thread-11 ]: Writing runtime SQL for node "seed.sequra_analytics.orders_financial"
[0m10:17:26.309690 [debug] [Thread-9 (]: On seed.sequra_analytics.dim_shoppers: Close
[0m10:17:26.312394 [debug] [Thread-12 ]: On seed.sequra_analytics.orders_merchant: Close
[0m10:17:26.315304 [debug] [Thread-11 ]: On seed.sequra_analytics.orders_financial: Close
[0m10:17:26.315957 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.227 seconds
[0m10:17:26.317377 [debug] [Thread-10 ]: Writing runtime SQL for node "seed.sequra_analytics.merchants"
[0m10:17:26.321065 [debug] [Thread-10 ]: On seed.sequra_analytics.merchants: Close
[0m10:17:26.388690 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e531d0>]}
[0m10:17:26.389220 [info ] [Thread-9 (]: 1 of 24 OK loaded seed file dbt_maximerosa_raw_data.dim_shoppers ............... [[32mINSERT 9[0m in 4.16s]
[0m10:17:26.390731 [debug] [Thread-9 (]: Finished running node seed.sequra_analytics.dim_shoppers
[0m10:17:26.391413 [debug] [Thread-9 (]: Began running node model.sequra_analytics.stg_dim_shoppers
[0m10:17:26.391934 [info ] [Thread-9 (]: 5 of 24 START sql view model dbt_maximerosa_staging.stg_dim_shoppers ........... [RUN]
[0m10:17:26.392299 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly seed.sequra_analytics.dim_shoppers, now model.sequra_analytics.stg_dim_shoppers)
[0m10:17:26.392605 [debug] [Thread-9 (]: Began compiling node model.sequra_analytics.stg_dim_shoppers
[0m10:17:26.393061 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195b0770>]}
[0m10:17:26.393444 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195c2990>]}
[0m10:17:26.399507 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195da2a0>]}
[0m10:17:26.399992 [debug] [Thread-9 (]: Writing injected SQL for node "model.sequra_analytics.stg_dim_shoppers"
[0m10:17:26.400382 [info ] [Thread-11 ]: 3 of 24 OK loaded seed file dbt_maximerosa_raw_data.orders_financial ........... [[32mINSERT 25[0m in 4.17s]
[0m10:17:26.400784 [info ] [Thread-12 ]: 4 of 24 OK loaded seed file dbt_maximerosa_raw_data.orders_merchant ............ [[32mINSERT 25[0m in 4.17s]
[0m10:17:26.401152 [info ] [Thread-10 ]: 2 of 24 OK loaded seed file dbt_maximerosa_raw_data.merchants .................. [[32mINSERT 6[0m in 4.17s]
[0m10:17:26.401590 [debug] [Thread-11 ]: Finished running node seed.sequra_analytics.orders_financial
[0m10:17:26.401922 [debug] [Thread-12 ]: Finished running node seed.sequra_analytics.orders_merchant
[0m10:17:26.402218 [debug] [Thread-10 ]: Finished running node seed.sequra_analytics.merchants
[0m10:17:26.402775 [debug] [Thread-11 ]: Began running node model.sequra_analytics.stg_orders_financial
[0m10:17:26.403177 [debug] [Thread-12 ]: Began running node model.sequra_analytics.stg_orders
[0m10:17:26.403418 [debug] [Thread-9 (]: Began executing node model.sequra_analytics.stg_dim_shoppers
[0m10:17:26.403786 [info ] [Thread-11 ]: 6 of 24 START sql view model dbt_maximerosa_staging.stg_orders_financial ....... [RUN]
[0m10:17:26.404146 [info ] [Thread-12 ]: 7 of 24 START sql view model dbt_maximerosa_staging.stg_orders ................. [RUN]
[0m10:17:26.419797 [debug] [Thread-9 (]: Writing runtime sql for node "model.sequra_analytics.stg_dim_shoppers"
[0m10:17:26.420104 [debug] [Thread-10 ]: Began running node model.sequra_analytics.stg_merchants
[0m10:17:26.420355 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly seed.sequra_analytics.orders_financial, now model.sequra_analytics.stg_orders_financial)
[0m10:17:26.420606 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly seed.sequra_analytics.orders_merchant, now model.sequra_analytics.stg_orders)
[0m10:17:26.420999 [info ] [Thread-10 ]: 8 of 24 START sql view model dbt_maximerosa_staging.stg_merchants .............. [RUN]
[0m10:17:26.421275 [debug] [Thread-11 ]: Began compiling node model.sequra_analytics.stg_orders_financial
[0m10:17:26.421512 [debug] [Thread-12 ]: Began compiling node model.sequra_analytics.stg_orders
[0m10:17:26.421740 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly seed.sequra_analytics.merchants, now model.sequra_analytics.stg_merchants)
[0m10:17:26.423650 [debug] [Thread-11 ]: Writing injected SQL for node "model.sequra_analytics.stg_orders_financial"
[0m10:17:26.425295 [debug] [Thread-12 ]: Writing injected SQL for node "model.sequra_analytics.stg_orders"
[0m10:17:26.425513 [debug] [Thread-10 ]: Began compiling node model.sequra_analytics.stg_merchants
[0m10:17:26.426032 [debug] [Thread-9 (]: Using snowflake connection "model.sequra_analytics.stg_dim_shoppers"
[0m10:17:26.427652 [debug] [Thread-10 ]: Writing injected SQL for node "model.sequra_analytics.stg_merchants"
[0m10:17:26.428050 [debug] [Thread-9 (]: On model.sequra_analytics.stg_dim_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_dim_shoppers
  
  
  
  
  as (
    

select
    shopper_id,
    age as shopper_age
from SEQURA_DEV.dbt_maximerosa_raw_data.dim_shoppers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_dim_shoppers"} */;
[0m10:17:26.428404 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m10:17:26.428678 [debug] [Thread-11 ]: Began executing node model.sequra_analytics.stg_orders_financial
[0m10:17:26.428937 [debug] [Thread-12 ]: Began executing node model.sequra_analytics.stg_orders
[0m10:17:26.430631 [debug] [Thread-11 ]: Writing runtime sql for node "model.sequra_analytics.stg_orders_financial"
[0m10:17:26.432230 [debug] [Thread-12 ]: Writing runtime sql for node "model.sequra_analytics.stg_orders"
[0m10:17:26.432517 [debug] [Thread-10 ]: Began executing node model.sequra_analytics.stg_merchants
[0m10:17:26.434895 [debug] [Thread-10 ]: Writing runtime sql for node "model.sequra_analytics.stg_merchants"
[0m10:17:26.436012 [debug] [Thread-12 ]: Using snowflake connection "model.sequra_analytics.stg_orders"
[0m10:17:26.436281 [debug] [Thread-12 ]: On model.sequra_analytics.stg_orders: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders
  
  
  
  
  as (
    

with source_data as (
    select
        order_id,
        shopper_id,
        merchant_id,
        order_date as order_date_raw,
        -- Parse the date format (d/m/yy or dd/mm/yy) -> handles both "9/9/22" and "09/09/22" formats
        case 
            when split_part(order_date, '/', 3) = '22' then '2022'
            when split_part(order_date, '/', 3) = '23' then '2023'
            else '20' || split_part(order_date, '/', 3)
        end || '-' ||
        lpad(split_part(order_date, '/', 2), 2, '0') || '-' ||
        lpad(split_part(order_date, '/', 1), 2, '0') as order_date_formatted
    from SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant
)

select
    order_id,
    shopper_id,
    merchant_id,
    order_date_raw,
    to_date(order_date_formatted, 'YYYY-MM-DD') as order_date,
    date_trunc('month', to_date(order_date_formatted, 'YYYY-MM-DD')) as order_month,
    to_char(to_date(order_date_formatted, 'YYYY-MM-DD'), 'YYYY-MM') as month_year
from source_data
where order_date_raw is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders"} */;
[0m10:17:26.436891 [debug] [Thread-11 ]: Using snowflake connection "model.sequra_analytics.stg_orders_financial"
[0m10:17:26.437126 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m10:17:26.437487 [debug] [Thread-10 ]: Using snowflake connection "model.sequra_analytics.stg_merchants"
[0m10:17:26.437683 [debug] [Thread-11 ]: On model.sequra_analytics.stg_orders_financial: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_orders_financial
  
  
  
  
  as (
    

select
    order_id,
    shopper_id,
    to_date(order_date) as order_date,
    date_trunc('month', to_date(order_date)) as order_month,
    to_char(to_date(order_date), 'YYYY-MM') as month_year_order,
    product_id,
    case product_id
        when 1 then 'FlexPay'
        when 2 then 'PayLater'
        when 3 then 'DirectPay'
        else 'Product_' || product_id::varchar
    end as product,
    merchant_id,
    is_in_default,
    days_unbalanced,
    current_order_value,
    overdue_principal,
    overdue_fees,
    overdue_principal + overdue_fees as total_overdue
from SEQURA_DEV.dbt_maximerosa_raw_data.orders_financial
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_orders_financial"} */;
[0m10:17:26.438104 [debug] [Thread-10 ]: On model.sequra_analytics.stg_merchants: create or replace   view SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
  
  
  
  
  as (
    

select
    merchant_id,
    merchant_name
from SEQURA_DEV.dbt_maximerosa_raw_data.merchants
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.stg_merchants"} */;
[0m10:17:26.439416 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m10:17:26.439720 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m10:17:28.821172 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.392 seconds
[0m10:17:28.828602 [debug] [Thread-9 (]: On model.sequra_analytics.stg_dim_shoppers: Close
[0m10:17:28.830120 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.391 seconds
[0m10:17:28.831109 [debug] [Thread-11 ]: On model.sequra_analytics.stg_orders_financial: Close
[0m10:17:28.840571 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.401 seconds
[0m10:17:28.845710 [debug] [Thread-10 ]: On model.sequra_analytics.stg_merchants: Close
[0m10:17:28.846523 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 2.409 seconds
[0m10:17:28.847442 [debug] [Thread-12 ]: On model.sequra_analytics.stg_orders: Close
[0m10:17:28.912567 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca85dc0>]}
[0m10:17:28.912909 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f1d610>]}
[0m10:17:28.913259 [info ] [Thread-11 ]: 6 of 24 OK created sql view model dbt_maximerosa_staging.stg_orders_financial .. [[32mSUCCESS 1[0m in 2.49s]
[0m10:17:28.913804 [info ] [Thread-9 (]: 5 of 24 OK created sql view model dbt_maximerosa_staging.stg_dim_shoppers ...... [[32mSUCCESS 1[0m in 2.52s]
[0m10:17:28.914269 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.stg_orders_financial
[0m10:17:28.914668 [debug] [Thread-9 (]: Finished running node model.sequra_analytics.stg_dim_shoppers
[0m10:17:28.936554 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107575700>]}
[0m10:17:28.937020 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cabdc40>]}
[0m10:17:28.937497 [info ] [Thread-12 ]: 7 of 24 OK created sql view model dbt_maximerosa_staging.stg_orders ............ [[32mSUCCESS 1[0m in 2.52s]
[0m10:17:28.938292 [debug] [Thread-12 ]: Finished running node model.sequra_analytics.stg_orders
[0m10:17:28.937996 [info ] [Thread-10 ]: 8 of 24 OK created sql view model dbt_maximerosa_staging.stg_merchants ......... [[32mSUCCESS 1[0m in 2.52s]
[0m10:17:28.938731 [debug] [Thread-10 ]: Finished running node model.sequra_analytics.stg_merchants
[0m10:17:28.939158 [debug] [Thread-11 ]: Began running node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m10:17:28.939391 [debug] [Thread-9 (]: Began running node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m10:17:28.939885 [debug] [Thread-12 ]: Began running node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m10:17:28.940073 [debug] [Thread-10 ]: Began running node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m10:17:28.939658 [info ] [Thread-11 ]: 9 of 24 START test not_null_stg_orders_merchant_id ............................. [RUN]
[0m10:17:28.940382 [info ] [Thread-9 (]: 10 of 24 START test not_null_stg_orders_order_date ............................. [RUN]
[0m10:17:28.940605 [info ] [Thread-12 ]: 11 of 24 START test not_null_stg_orders_order_id ............................... [RUN]
[0m10:17:28.940806 [info ] [Thread-10 ]: 12 of 24 START test not_null_stg_orders_shopper_id ............................. [RUN]
[0m10:17:28.941158 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders_financial, now test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2)
[0m10:17:28.941456 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_dim_shoppers, now test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb)
[0m10:17:28.941705 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_orders, now test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64)
[0m10:17:28.941925 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.stg_merchants, now test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112)
[0m10:17:28.942156 [debug] [Thread-11 ]: Began compiling node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m10:17:28.942375 [debug] [Thread-9 (]: Began compiling node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m10:17:28.942555 [debug] [Thread-12 ]: Began compiling node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m10:17:28.942774 [debug] [Thread-10 ]: Began compiling node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m10:17:28.948907 [debug] [Thread-11 ]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2"
[0m10:17:28.951793 [debug] [Thread-9 (]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb"
[0m10:17:28.954254 [debug] [Thread-12 ]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:17:28.956359 [debug] [Thread-10 ]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112"
[0m10:17:28.957302 [debug] [Thread-11 ]: Began executing node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m10:17:28.957602 [debug] [Thread-9 (]: Began executing node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m10:17:28.957833 [debug] [Thread-12 ]: Began executing node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m10:17:28.963598 [debug] [Thread-10 ]: Began executing node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m10:17:28.969342 [debug] [Thread-11 ]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2"
[0m10:17:29.021953 [debug] [Thread-9 (]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb"
[0m10:17:29.023194 [debug] [Thread-12 ]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:17:29.024323 [debug] [Thread-10 ]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112"
[0m10:17:29.025532 [debug] [Thread-11 ]: Using snowflake connection "test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2"
[0m10:17:29.025802 [debug] [Thread-11 ]: On test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select merchant_id
from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where merchant_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2"} */
[0m10:17:29.025990 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m10:17:29.026537 [debug] [Thread-12 ]: Using snowflake connection "test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:17:29.026758 [debug] [Thread-12 ]: On test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64"} */
[0m10:17:29.026929 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m10:17:29.028087 [debug] [Thread-9 (]: Using snowflake connection "test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb"
[0m10:17:29.028476 [debug] [Thread-10 ]: Using snowflake connection "test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112"
[0m10:17:29.028844 [debug] [Thread-9 (]: On test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where order_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb"} */
[0m10:17:29.029160 [debug] [Thread-10 ]: On test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shopper_id
from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where shopper_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112"} */
[0m10:17:29.029704 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m10:17:29.030073 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m10:17:31.691218 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.661 seconds
[0m10:17:31.698905 [debug] [Thread-10 ]: On test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112: Close
[0m10:17:31.818193 [info ] [Thread-10 ]: 12 of 24 PASS not_null_stg_orders_shopper_id ................................... [[32mPASS[0m in 2.88s]
[0m10:17:31.818748 [debug] [Thread-10 ]: Finished running node test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112
[0m10:17:31.819023 [debug] [Thread-10 ]: Began running node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m10:17:31.819295 [info ] [Thread-10 ]: 13 of 24 START test unique_stg_orders_order_id ................................. [RUN]
[0m10:17:31.819737 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112, now test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a)
[0m10:17:31.820023 [debug] [Thread-10 ]: Began compiling node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m10:17:31.826875 [debug] [Thread-10 ]: Writing injected SQL for node "test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m10:17:31.831889 [debug] [Thread-10 ]: Began executing node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m10:17:31.834237 [debug] [Thread-10 ]: Writing runtime sql for node "test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m10:17:31.838899 [debug] [Thread-10 ]: Using snowflake connection "test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m10:17:31.839410 [debug] [Thread-10 ]: On test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a"} */
[0m10:17:31.839789 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m10:17:32.008125 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 2.981 seconds
[0m10:17:32.012145 [debug] [Thread-12 ]: On test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m10:17:32.112244 [info ] [Thread-12 ]: 11 of 24 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 3.17s]
[0m10:17:32.113294 [debug] [Thread-12 ]: Finished running node test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m10:17:32.113696 [debug] [Thread-12 ]: Began running node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m10:17:32.114087 [info ] [Thread-12 ]: 14 of 24 START test not_null_stg_merchants_merchant_id ......................... [RUN]
[0m10:17:32.114522 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64, now test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d)
[0m10:17:32.114879 [debug] [Thread-12 ]: Began compiling node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m10:17:32.120123 [debug] [Thread-12 ]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d"
[0m10:17:32.122127 [debug] [Thread-12 ]: Began executing node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m10:17:32.125149 [debug] [Thread-12 ]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d"
[0m10:17:32.127174 [debug] [Thread-12 ]: Using snowflake connection "test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d"
[0m10:17:32.127759 [debug] [Thread-12 ]: On test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select merchant_id
from SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
where merchant_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d"} */
[0m10:17:32.128096 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m10:17:32.213278 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 3.187 seconds
[0m10:17:32.215309 [debug] [Thread-11 ]: On test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2: Close
[0m10:17:32.227208 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 3.197 seconds
[0m10:17:32.229399 [debug] [Thread-9 (]: On test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb: Close
[0m10:17:32.294067 [info ] [Thread-11 ]: 9 of 24 PASS not_null_stg_orders_merchant_id ................................... [[32mPASS[0m in 3.35s]
[0m10:17:32.294770 [debug] [Thread-11 ]: Finished running node test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2
[0m10:17:32.295081 [debug] [Thread-11 ]: Began running node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m10:17:32.295422 [info ] [Thread-11 ]: 15 of 24 START test not_null_stg_merchants_merchant_name ....................... [RUN]
[0m10:17:32.295824 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2, now test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b)
[0m10:17:32.296203 [debug] [Thread-11 ]: Began compiling node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m10:17:32.303287 [debug] [Thread-11 ]: Writing injected SQL for node "test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b"
[0m10:17:32.304965 [debug] [Thread-11 ]: Began executing node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m10:17:32.307698 [debug] [Thread-11 ]: Writing runtime sql for node "test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b"
[0m10:17:32.309422 [debug] [Thread-11 ]: Using snowflake connection "test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b"
[0m10:17:32.309781 [debug] [Thread-11 ]: On test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select merchant_name
from SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
where merchant_name is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b"} */
[0m10:17:32.310157 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m10:17:32.328023 [info ] [Thread-9 (]: 10 of 24 PASS not_null_stg_orders_order_date ................................... [[32mPASS[0m in 3.39s]
[0m10:17:32.328461 [debug] [Thread-9 (]: Finished running node test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb
[0m10:17:32.328746 [debug] [Thread-9 (]: Began running node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m10:17:32.329066 [info ] [Thread-9 (]: 16 of 24 START test unique_stg_merchants_merchant_id ........................... [RUN]
[0m10:17:32.329460 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb, now test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1)
[0m10:17:32.329735 [debug] [Thread-9 (]: Began compiling node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m10:17:32.332679 [debug] [Thread-9 (]: Writing injected SQL for node "test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1"
[0m10:17:32.334010 [debug] [Thread-9 (]: Began executing node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m10:17:32.335659 [debug] [Thread-9 (]: Writing runtime sql for node "test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1"
[0m10:17:32.336628 [debug] [Thread-9 (]: Using snowflake connection "test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1"
[0m10:17:32.336861 [debug] [Thread-9 (]: On test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    merchant_id as unique_field,
    count(*) as n_records

from SEQURA_DEV.dbt_maximerosa_staging.stg_merchants
where merchant_id is not null
group by merchant_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1"} */
[0m10:17:32.337067 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m10:17:34.189561 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.350 seconds
[0m10:17:34.192390 [debug] [Thread-10 ]: On test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a: Close
[0m10:17:34.266440 [info ] [Thread-10 ]: 13 of 24 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 2.45s]
[0m10:17:34.267009 [debug] [Thread-10 ]: Finished running node test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a
[0m10:17:34.267507 [debug] [Thread-10 ]: Began running node model.sequra_analytics.int_monthly_shoppers
[0m10:17:34.267951 [info ] [Thread-10 ]: 17 of 24 START sql view model dbt_maximerosa_intermediate.int_monthly_shoppers . [RUN]
[0m10:17:34.268293 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a, now model.sequra_analytics.int_monthly_shoppers)
[0m10:17:34.268567 [debug] [Thread-10 ]: Began compiling node model.sequra_analytics.int_monthly_shoppers
[0m10:17:34.271298 [debug] [Thread-10 ]: Writing injected SQL for node "model.sequra_analytics.int_monthly_shoppers"
[0m10:17:34.272381 [debug] [Thread-10 ]: Began executing node model.sequra_analytics.int_monthly_shoppers
[0m10:17:34.274536 [debug] [Thread-10 ]: Writing runtime sql for node "model.sequra_analytics.int_monthly_shoppers"
[0m10:17:34.280895 [debug] [Thread-10 ]: Using snowflake connection "model.sequra_analytics.int_monthly_shoppers"
[0m10:17:34.281238 [debug] [Thread-10 ]: On model.sequra_analytics.int_monthly_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers
  
  
  
  
  as (
    

with monthly_orders as (
    select distinct
        order_month,
        month_year,
        merchant_id,
        shopper_id
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders
)

select
    order_month,
    month_year,
    merchant_id,
    shopper_id
from monthly_orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_monthly_shoppers"} */;
[0m10:17:34.281485 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m10:17:34.539939 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 2.412 seconds
[0m10:17:34.542091 [debug] [Thread-12 ]: On test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d: Close
[0m10:17:34.615105 [info ] [Thread-12 ]: 14 of 24 PASS not_null_stg_merchants_merchant_id ............................... [[32mPASS[0m in 2.50s]
[0m10:17:34.615768 [debug] [Thread-12 ]: Finished running node test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d
[0m10:17:34.616236 [debug] [Thread-12 ]: Began running node model.sequra_analytics.int_recurrent_shoppers
[0m10:17:34.616889 [info ] [Thread-12 ]: 18 of 24 START sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers  [RUN]
[0m10:17:34.617472 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d, now model.sequra_analytics.int_recurrent_shoppers)
[0m10:17:34.617848 [debug] [Thread-12 ]: Began compiling node model.sequra_analytics.int_recurrent_shoppers
[0m10:17:34.622574 [debug] [Thread-12 ]: Writing injected SQL for node "model.sequra_analytics.int_recurrent_shoppers"
[0m10:17:34.624068 [debug] [Thread-12 ]: Began executing node model.sequra_analytics.int_recurrent_shoppers
[0m10:17:34.626855 [debug] [Thread-12 ]: Writing runtime sql for node "model.sequra_analytics.int_recurrent_shoppers"
[0m10:17:34.629172 [debug] [Thread-12 ]: Using snowflake connection "model.sequra_analytics.int_recurrent_shoppers"
[0m10:17:34.629709 [debug] [Thread-12 ]: On model.sequra_analytics.int_recurrent_shoppers: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers
  
  
  
  
  as (
    

with order_history as (
    select
        o1.order_month as current_month,
        o1.month_year as current_month_year,
        o1.merchant_id,
        o1.shopper_id,
        count(distinct o2.order_month) as months_with_purchases
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o1
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_orders o2
        on o1.merchant_id = o2.merchant_id
        and o1.shopper_id = o2.shopper_id
        and o2.order_date between dateadd(month, -11, o1.order_month) and last_day(o1.order_month)
        and o2.order_month <= o1.order_month
    group by 1, 2, 3, 4
)

select
    current_month,
    current_month_year,
    merchant_id,
    shopper_id,
    months_with_purchases,
    -- A shopper is recurrent if they have made purchases in at least 2 different months
    -- within the 12-month window including the current month
    case 
        when months_with_purchases >= 2 then 1 
        else 0 
    end as is_recurrent
from order_history
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_recurrent_shoppers"} */;
[0m10:17:34.630149 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m10:17:35.072394 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.762 seconds
[0m10:17:35.075628 [debug] [Thread-11 ]: On test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b: Close
[0m10:17:35.078492 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.741 seconds
[0m10:17:35.080189 [debug] [Thread-9 (]: On test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1: Close
[0m10:17:35.158926 [info ] [Thread-9 (]: 16 of 24 PASS unique_stg_merchants_merchant_id ................................. [[32mPASS[0m in 2.83s]
[0m10:17:35.159776 [info ] [Thread-11 ]: 15 of 24 PASS not_null_stg_merchants_merchant_name ............................. [[32mPASS[0m in 2.86s]
[0m10:17:35.160899 [debug] [Thread-9 (]: Finished running node test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1
[0m10:17:35.161587 [debug] [Thread-11 ]: Finished running node test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b
[0m10:17:35.162593 [debug] [Thread-9 (]: Began running node model.sequra_analytics.int_orders_with_defaults
[0m10:17:35.163397 [info ] [Thread-9 (]: 19 of 24 START sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [RUN]
[0m10:17:35.163895 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1, now model.sequra_analytics.int_orders_with_defaults)
[0m10:17:35.164254 [debug] [Thread-9 (]: Began compiling node model.sequra_analytics.int_orders_with_defaults
[0m10:17:35.169383 [debug] [Thread-9 (]: Writing injected SQL for node "model.sequra_analytics.int_orders_with_defaults"
[0m10:17:35.170614 [debug] [Thread-9 (]: Began executing node model.sequra_analytics.int_orders_with_defaults
[0m10:17:35.172836 [debug] [Thread-9 (]: Writing runtime sql for node "model.sequra_analytics.int_orders_with_defaults"
[0m10:17:35.174997 [debug] [Thread-9 (]: Using snowflake connection "model.sequra_analytics.int_orders_with_defaults"
[0m10:17:35.175478 [debug] [Thread-9 (]: On model.sequra_analytics.int_orders_with_defaults: create or replace   view SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
  
  
  
  
  as (
    

with orders_enriched as (
    select
        -- Order information
        o.order_id,
        o.order_date,
        o.order_month,
        o.month_year_order,
        
        -- Product and merchant
        o.product_id,
        o.product,
        o.merchant_id,
        m.merchant_name as merchant,
        
        -- Shopper information
        o.shopper_id,
        s.shopper_age,
        
        -- Financial metrics
        o.is_in_default,
        o.days_unbalanced,
        o.current_order_value,
        o.overdue_principal,
        o.overdue_fees,
        o.total_overdue,
        
        -- Calculated delayed period (for filtering, not cumulative)
        case
            when o.days_unbalanced > 90 then '90'
            when o.days_unbalanced > 60 then '60'
            when o.days_unbalanced > 30 then '30'
            when o.days_unbalanced > 17 then '17'
            else null
        end as max_delayed_period
        
    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders_financial o
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_dim_shoppers s
        on o.shopper_id = s.shopper_id
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on o.merchant_id = m.merchant_id
)

select * from orders_enriched
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.int_orders_with_defaults"} */;
[0m10:17:35.175860 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m10:17:36.771159 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.489 seconds
[0m10:17:36.773597 [debug] [Thread-10 ]: On model.sequra_analytics.int_monthly_shoppers: Close
[0m10:17:36.844868 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195d96a0>]}
[0m10:17:36.845780 [info ] [Thread-10 ]: 17 of 24 OK created sql view model dbt_maximerosa_intermediate.int_monthly_shoppers  [[32mSUCCESS 1[0m in 2.58s]
[0m10:17:36.846590 [debug] [Thread-10 ]: Finished running node model.sequra_analytics.int_monthly_shoppers
[0m10:17:37.112535 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 2.482 seconds
[0m10:17:37.116324 [debug] [Thread-12 ]: On model.sequra_analytics.int_recurrent_shoppers: Close
[0m10:17:37.204720 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdbcbc0>]}
[0m10:17:37.206017 [info ] [Thread-12 ]: 18 of 24 OK created sql view model dbt_maximerosa_intermediate.int_recurrent_shoppers  [[32mSUCCESS 1[0m in 2.59s]
[0m10:17:37.206825 [debug] [Thread-12 ]: Finished running node model.sequra_analytics.int_recurrent_shoppers
[0m10:17:37.207357 [debug] [Thread-11 ]: Began running node model.sequra_analytics.shopper_recurrence_rate
[0m10:17:37.207786 [info ] [Thread-11 ]: 20 of 24 START sql table model dbt_maximerosa_marts.shopper_recurrence_rate .... [RUN]
[0m10:17:37.208411 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b, now model.sequra_analytics.shopper_recurrence_rate)
[0m10:17:37.209520 [debug] [Thread-11 ]: Began compiling node model.sequra_analytics.shopper_recurrence_rate
[0m10:17:37.216455 [debug] [Thread-11 ]: Writing injected SQL for node "model.sequra_analytics.shopper_recurrence_rate"
[0m10:17:37.219956 [debug] [Thread-11 ]: Began executing node model.sequra_analytics.shopper_recurrence_rate
[0m10:17:37.241948 [debug] [Thread-11 ]: Writing runtime sql for node "model.sequra_analytics.shopper_recurrence_rate"
[0m10:17:37.244102 [debug] [Thread-11 ]: Using snowflake connection "model.sequra_analytics.shopper_recurrence_rate"
[0m10:17:37.244399 [debug] [Thread-11 ]: On model.sequra_analytics.shopper_recurrence_rate: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
    
    
    
    as (

with monthly_metrics as (
    select
        ms.order_month,
        ms.month_year,
        ms.merchant_id,
        m.merchant_name,
        count(distinct ms.shopper_id) as total_shoppers,
        sum(rs.is_recurrent) as recurrent_shoppers
    from SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers ms
    left join SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers rs
        on ms.order_month = rs.current_month
        and ms.merchant_id = rs.merchant_id
        and ms.shopper_id = rs.shopper_id
    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m
        on ms.merchant_id = m.merchant_id
    group by 1, 2, 3, 4
)

select
    merchant_name,
    month_year as month,
    round(
        case 
            when total_shoppers > 0 
            then (recurrent_shoppers::decimal / total_shoppers) * 100
            else 0 
        end, 2
    ) as recurrence_rate
from monthly_metrics
order by merchant_name, month
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.shopper_recurrence_rate"} */;
[0m10:17:37.244649 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m10:17:37.726189 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.550 seconds
[0m10:17:37.728900 [debug] [Thread-9 (]: On model.sequra_analytics.int_orders_with_defaults: Close
[0m10:17:37.805740 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11942ae40>]}
[0m10:17:37.806681 [info ] [Thread-9 (]: 19 of 24 OK created sql view model dbt_maximerosa_intermediate.int_orders_with_defaults  [[32mSUCCESS 1[0m in 2.64s]
[0m10:17:37.807229 [debug] [Thread-9 (]: Finished running node model.sequra_analytics.int_orders_with_defaults
[0m10:17:37.807806 [debug] [Thread-12 ]: Began running node model.sequra_analytics.default_ratio_analysis
[0m10:17:37.808231 [info ] [Thread-12 ]: 21 of 24 START sql table model dbt_maximerosa_marts.default_ratio_analysis ..... [RUN]
[0m10:17:37.808693 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_recurrent_shoppers, now model.sequra_analytics.default_ratio_analysis)
[0m10:17:37.809022 [debug] [Thread-12 ]: Began compiling node model.sequra_analytics.default_ratio_analysis
[0m10:17:37.812729 [debug] [Thread-12 ]: Writing injected SQL for node "model.sequra_analytics.default_ratio_analysis"
[0m10:17:37.814558 [debug] [Thread-12 ]: Began executing node model.sequra_analytics.default_ratio_analysis
[0m10:17:37.816954 [debug] [Thread-12 ]: Writing runtime sql for node "model.sequra_analytics.default_ratio_analysis"
[0m10:17:37.819307 [debug] [Thread-12 ]: Using snowflake connection "model.sequra_analytics.default_ratio_analysis"
[0m10:17:37.819677 [debug] [Thread-12 ]: On model.sequra_analytics.default_ratio_analysis: create or replace transient table SEQURA_DEV.dbt_maximerosa_marts.default_ratio_analysis
    
    
    
    as (

with base_data as (
    select * from SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults
    where is_in_default = true  -- Only defaults for this analysis
),

-- Generate records for each applicable delayed period using UNION ALL
-- This implements the cumulative logic: 35 days appears in both 17 and 30
expanded_periods as (
    -- Period 17: All orders with days_unbalanced > 17
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '17' as delayed_period
    from base_data
    where days_unbalanced > 17
    
    union all
    
    -- Period 30: All orders with days_unbalanced > 30
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '30' as delayed_period
    from base_data
    where days_unbalanced > 30
    
    union all
    
    -- Period 60: All orders with days_unbalanced > 60
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '60' as delayed_period
    from base_data
    where days_unbalanced > 60
    
    union all
    
    -- Period 90: All orders with days_unbalanced > 90
    select
        shopper_age,
        month_year_order,
        product,
        merchant,
        'in_default' as default_type,
        '90' as delayed_period
    from base_data
    where days_unbalanced > 90
)

select distinct
    shopper_age,
    month_year_order,
    product,
    merchant,
    default_type,
    delayed_period
from expanded_periods
where merchant is not null  -- Exclude records without merchant mapping
order by 
    month_year_order,
    merchant,
    cast(delayed_period as integer)
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "model.sequra_analytics.default_ratio_analysis"} */;
[0m10:17:37.820231 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m10:17:40.930504 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 3.685 seconds
[0m10:17:40.934361 [debug] [Thread-11 ]: On model.sequra_analytics.shopper_recurrence_rate: Close
[0m10:17:41.015953 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1194a93a0>]}
[0m10:17:41.017294 [info ] [Thread-11 ]: 20 of 24 OK created sql table model dbt_maximerosa_marts.shopper_recurrence_rate  [[32mSUCCESS 1[0m in 3.81s]
[0m10:17:41.018127 [debug] [Thread-11 ]: Finished running node model.sequra_analytics.shopper_recurrence_rate
[0m10:17:41.019080 [debug] [Thread-9 (]: Began running node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m10:17:41.019472 [debug] [Thread-10 ]: Began running node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m10:17:41.019865 [info ] [Thread-9 (]: 22 of 24 START test not_null_shopper_recurrence_rate_merchant_name ............. [RUN]
[0m10:17:41.020224 [debug] [Thread-11 ]: Began running node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m10:17:41.020493 [info ] [Thread-10 ]: 23 of 24 START test not_null_shopper_recurrence_rate_month ..................... [RUN]
[0m10:17:41.020868 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_orders_with_defaults, now test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8)
[0m10:17:41.021169 [info ] [Thread-11 ]: 24 of 24 START test not_null_shopper_recurrence_rate_recurrence_rate ........... [RUN]
[0m10:17:41.021546 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.int_monthly_shoppers, now test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817)
[0m10:17:41.021990 [debug] [Thread-9 (]: Began compiling node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m10:17:41.022331 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly model.sequra_analytics.shopper_recurrence_rate, now test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1)
[0m10:17:41.022676 [debug] [Thread-10 ]: Began compiling node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m10:17:41.028010 [debug] [Thread-9 (]: Writing injected SQL for node "test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8"
[0m10:17:41.028689 [debug] [Thread-11 ]: Began compiling node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m10:17:41.035348 [debug] [Thread-10 ]: Writing injected SQL for node "test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817"
[0m10:17:41.039740 [debug] [Thread-11 ]: Writing injected SQL for node "test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1"
[0m10:17:41.041237 [debug] [Thread-11 ]: Began executing node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m10:17:41.041596 [debug] [Thread-10 ]: Began executing node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m10:17:41.041909 [debug] [Thread-9 (]: Began executing node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m10:17:41.044276 [debug] [Thread-11 ]: Writing runtime sql for node "test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1"
[0m10:17:41.046359 [debug] [Thread-10 ]: Writing runtime sql for node "test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817"
[0m10:17:41.048246 [debug] [Thread-9 (]: Writing runtime sql for node "test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8"
[0m10:17:41.051208 [debug] [Thread-11 ]: Using snowflake connection "test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1"
[0m10:17:41.051871 [debug] [Thread-10 ]: Using snowflake connection "test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817"
[0m10:17:41.052404 [debug] [Thread-9 (]: Using snowflake connection "test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8"
[0m10:17:41.052689 [debug] [Thread-11 ]: On test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select recurrence_rate
from SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
where recurrence_rate is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1"} */
[0m10:17:41.053007 [debug] [Thread-10 ]: On test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
where month is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817"} */
[0m10:17:41.053274 [debug] [Thread-9 (]: On test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select merchant_name
from SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate
where merchant_name is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "sequra_analytics", "target_name": "dev", "node_id": "test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8"} */
[0m10:17:41.053518 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m10:17:41.053774 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m10:17:41.054002 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m10:17:41.126257 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 3.306 seconds
[0m10:17:41.127584 [debug] [Thread-12 ]: On model.sequra_analytics.default_ratio_analysis: Close
[0m10:17:41.194324 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edd8b34-f368-4ca5-915d-956468717db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10756ce00>]}
[0m10:17:41.194989 [info ] [Thread-12 ]: 21 of 24 OK created sql table model dbt_maximerosa_marts.default_ratio_analysis  [[32mSUCCESS 1[0m in 3.39s]
[0m10:17:41.195559 [debug] [Thread-12 ]: Finished running node model.sequra_analytics.default_ratio_analysis
[0m10:17:43.461965 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.407 seconds
[0m10:17:43.465938 [debug] [Thread-9 (]: On test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8: Close
[0m10:17:43.482298 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.428 seconds
[0m10:17:43.483991 [debug] [Thread-10 ]: On test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817: Close
[0m10:17:43.499697 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.446 seconds
[0m10:17:43.502742 [debug] [Thread-11 ]: On test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1: Close
[0m10:17:43.542530 [info ] [Thread-9 (]: 22 of 24 PASS not_null_shopper_recurrence_rate_merchant_name ................... [[32mPASS[0m in 2.52s]
[0m10:17:43.543188 [debug] [Thread-9 (]: Finished running node test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8
[0m10:17:43.556328 [info ] [Thread-10 ]: 23 of 24 PASS not_null_shopper_recurrence_rate_month ........................... [[32mPASS[0m in 2.53s]
[0m10:17:43.557061 [debug] [Thread-10 ]: Finished running node test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817
[0m10:17:43.574140 [info ] [Thread-11 ]: 24 of 24 PASS not_null_shopper_recurrence_rate_recurrence_rate ................. [[32mPASS[0m in 2.55s]
[0m10:17:43.574882 [debug] [Thread-11 ]: Finished running node test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1
[0m10:17:43.576392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:43.576828 [debug] [MainThread]: Connection 'test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8' was properly closed.
[0m10:17:43.577121 [debug] [MainThread]: Connection 'test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817' was properly closed.
[0m10:17:43.577365 [debug] [MainThread]: Connection 'test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1' was properly closed.
[0m10:17:43.577594 [debug] [MainThread]: Connection 'model.sequra_analytics.default_ratio_analysis' was properly closed.
[0m10:17:43.578020 [info ] [MainThread]: 
[0m10:17:43.578408 [info ] [MainThread]: Finished running 4 seeds, 2 table models, 11 data tests, 7 view models in 0 hours 0 minutes and 26.99 seconds (26.99s).
[0m10:17:43.581389 [debug] [MainThread]: Command end result
[0m10:17:43.603092 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/manifest.json
[0m10:17:43.605086 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/semantic_manifest.json
[0m10:17:43.610754 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/target/run_results.json
[0m10:17:43.610990 [info ] [MainThread]: 
[0m10:17:43.611308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:43.611519 [info ] [MainThread]: 
[0m10:17:43.611719 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m10:17:43.613729 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 27.73834, "process_in_blocks": "0", "process_kernel_time": 0.649913, "process_mem_max_rss": "192561152", "process_out_blocks": "0", "process_user_time": 3.540114}
[0m10:17:43.614049 [debug] [MainThread]: Command `dbt build` succeeded at 10:17:43.614002 after 27.74 seconds
[0m10:17:43.614256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cadcf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195665d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106656d50>]}
[0m10:17:43.614460 [debug] [MainThread]: Flushing usage events
[0m10:17:44.144210 [debug] [MainThread]: An error was encountered while trying to flush usage events
