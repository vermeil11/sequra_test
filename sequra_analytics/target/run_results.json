{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.9", "generated_at": "2025-08-26T18:13:10.621873Z", "invocation_id": "b7697d68-e2fc-4951-946a-bc34699ca54a", "invocation_started_at": "2025-08-26T18:12:42.903273Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:49.442683Z", "completed_at": "2025-08-26T18:12:49.442686Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:49.470688Z", "completed_at": "2025-08-26T18:12:53.067889Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 3.6987087726593018, "adapter_response": {"_message": "INSERT 25", "code": "INSERT", "rows_affected": 25}, "message": "INSERT 25", "failures": null, "unique_id": "seed.sequra_analytics.orders_financial", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:49.442193Z", "completed_at": "2025-08-26T18:12:49.442206Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:49.443366Z", "completed_at": "2025-08-26T18:12:53.049232Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 3.707751750946045, "adapter_response": {"_message": "INSERT 9", "code": "INSERT", "rows_affected": 9}, "message": "INSERT 9", "failures": null, "unique_id": "seed.sequra_analytics.dim_shoppers", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:49.442446Z", "completed_at": "2025-08-26T18:12:49.442449Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:49.455926Z", "completed_at": "2025-08-26T18:12:53.511073Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 4.150534152984619, "adapter_response": {"_message": "INSERT 6", "code": "INSERT", "rows_affected": 6}, "message": "INSERT 6", "failures": null, "unique_id": "seed.sequra_analytics.merchants", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:49.442977Z", "completed_at": "2025-08-26T18:12:49.442982Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:49.473147Z", "completed_at": "2025-08-26T18:12:54.130275Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 4.784787893295288, "adapter_response": {"_message": "INSERT 25", "code": "INSERT", "rows_affected": 25}, "message": "INSERT 25", "failures": null, "unique_id": "seed.sequra_analytics.orders_merchant", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:53.158089Z", "completed_at": "2025-08-26T18:12:53.177780Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:53.178190Z", "completed_at": "2025-08-26T18:12:55.647880Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 2.5703940391540527, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea204-0001-6742-0001-67de00017036"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.sequra_analytics.stg_dim_shoppers", "compiled": true, "compiled_code": "\n\nselect\n    shopper_id,\n    age as shopper_age\nfrom SEQURA_DEV.dbt_maximerosa_raw_data.dim_shoppers", "relation_name": "SEQURA_DEV.dbt_maximerosa_staging.stg_dim_shoppers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:53.149536Z", "completed_at": "2025-08-26T18:12:53.161181Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:53.161458Z", "completed_at": "2025-08-26T18:12:55.766032Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 2.695772171020508, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea204-0001-6720-0001-67de0001209e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.sequra_analytics.stg_orders_financial", "compiled": true, "compiled_code": "\n\nselect\n    order_id,\n    shopper_id,\n    to_date(order_date) as order_date,\n    date_trunc('month', to_date(order_date)) as order_month,\n    to_char(to_date(order_date), 'YYYY-MM') as month_year_order,\n    product_id,\n    case product_id\n        when 1 then 'FlexPay'\n        when 2 then 'PayLater'\n        when 3 then 'DirectPay'\n        else 'Product_' || product_id::varchar\n    end as product,\n    merchant_id,\n    is_in_default,\n    days_unbalanced,\n    current_order_value,\n    overdue_principal,\n    overdue_fees,\n    overdue_principal + overdue_fees as total_overdue\nfrom SEQURA_DEV.dbt_maximerosa_raw_data.orders_financial", "relation_name": "SEQURA_DEV.dbt_maximerosa_staging.stg_orders_financial", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:53.594486Z", "completed_at": "2025-08-26T18:12:53.599658Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:53.600280Z", "completed_at": "2025-08-26T18:12:56.003583Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 2.5099709033966064, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea204-0001-673a-0001-67de00014062"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.sequra_analytics.stg_merchants", "compiled": true, "compiled_code": "\n\nselect\n    merchant_id,\n    merchant_name\nfrom SEQURA_DEV.dbt_maximerosa_raw_data.merchants", "relation_name": "SEQURA_DEV.dbt_maximerosa_staging.stg_merchants", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:54.230332Z", "completed_at": "2025-08-26T18:12:54.235967Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:54.236385Z", "completed_at": "2025-08-26T18:12:56.667956Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 2.5451629161834717, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea204-0001-6742-0001-67de0001703a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.sequra_analytics.stg_orders", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        order_id,\n        shopper_id,\n        merchant_id,\n        order_date as order_date_raw,\n        -- Parse the date format (d/m/yy or dd/mm/yy)\n        case \n            when split_part(order_date, '/', 3) = '22' then '2022'\n            when split_part(order_date, '/', 3) = '23' then '2023'\n            else '20' || split_part(order_date, '/', 3)\n        end || '-' ||\n        lpad(split_part(order_date, '/', 2), 2, '0') || '-' ||\n        lpad(split_part(order_date, '/', 1), 2, '0') as order_date_formatted\n    from SEQURA_DEV.dbt_maximerosa_raw_data.orders_merchant\n)\n\nselect\n    order_id,\n    shopper_id,\n    merchant_id,\n    order_date_raw,\n    to_date(order_date_formatted, 'YYYY-MM-DD') as order_date,\n    date_trunc('month', to_date(order_date_formatted, 'YYYY-MM-DD')) as order_month,\n    to_char(to_date(order_date_formatted, 'YYYY-MM-DD'), 'YYYY-MM') as month_year\nfrom source_data\nwhere order_date_raw is not null", "relation_name": "SEQURA_DEV.dbt_maximerosa_staging.stg_orders", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:56.111306Z", "completed_at": "2025-08-26T18:12:56.136332Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:56.136934Z", "completed_at": "2025-08-26T18:12:58.652961Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 2.627081871032715, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea204-0001-6742-0001-67de0001703e"}, "message": null, "failures": 0, "unique_id": "test.sequra_analytics.not_null_stg_merchants_merchant_id.ac3297bd9d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect merchant_id\nfrom SEQURA_DEV.dbt_maximerosa_staging.stg_merchants\nwhere merchant_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:56.118691Z", "completed_at": "2025-08-26T18:12:56.136641Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:56.149636Z", "completed_at": "2025-08-26T18:12:58.699857Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 2.6683099269866943, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea204-0001-6720-0001-67de000120a2"}, "message": null, "failures": 0, "unique_id": "test.sequra_analytics.not_null_stg_merchants_merchant_name.de6dfb272b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect merchant_name\nfrom SEQURA_DEV.dbt_maximerosa_staging.stg_merchants\nwhere merchant_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:56.130454Z", "completed_at": "2025-08-26T18:12:56.142938Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:56.153617Z", "completed_at": "2025-08-26T18:12:58.763445Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 2.731213092803955, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea204-0001-6741-0001-67de0001504e"}, "message": null, "failures": 0, "unique_id": "test.sequra_analytics.unique_stg_merchants_merchant_id.76938432c1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    merchant_id as unique_field,\n    count(*) as n_records\n\nfrom SEQURA_DEV.dbt_maximerosa_staging.stg_merchants\nwhere merchant_id is not null\ngroup by merchant_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:56.778143Z", "completed_at": "2025-08-26T18:12:56.785438Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:56.786027Z", "completed_at": "2025-08-26T18:12:59.239903Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 2.547600030899048, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea204-0001-671e-0001-67de000164ee"}, "message": null, "failures": 0, "unique_id": "test.sequra_analytics.not_null_stg_orders_merchant_id.ff0a456ef2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect merchant_id\nfrom SEQURA_DEV.dbt_maximerosa_staging.stg_orders\nwhere merchant_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:58.780439Z", "completed_at": "2025-08-26T18:12:58.786510Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:58.786818Z", "completed_at": "2025-08-26T18:13:01.169755Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 2.4898428916931152, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea205-0001-671e-0001-67de000164f2"}, "message": null, "failures": 0, "unique_id": "test.sequra_analytics.not_null_stg_orders_order_id.81cfe2fe64", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom SEQURA_DEV.dbt_maximerosa_staging.stg_orders\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:58.740628Z", "completed_at": "2025-08-26T18:12:58.746670Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:58.747134Z", "completed_at": "2025-08-26T18:13:01.286287Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 2.6204280853271484, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea205-0001-673a-0001-67de00014066"}, "message": null, "failures": 0, "unique_id": "test.sequra_analytics.not_null_stg_orders_order_date.2177a3e8bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_date\nfrom SEQURA_DEV.dbt_maximerosa_staging.stg_orders\nwhere order_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:58.843378Z", "completed_at": "2025-08-26T18:12:58.848200Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:58.848494Z", "completed_at": "2025-08-26T18:13:01.304894Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 2.5429749488830566, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea205-0001-673a-0001-67de0001406a"}, "message": null, "failures": 0, "unique_id": "test.sequra_analytics.not_null_stg_orders_shopper_id.8672b8c112", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect shopper_id\nfrom SEQURA_DEV.dbt_maximerosa_staging.stg_orders\nwhere shopper_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T18:12:59.329428Z", "completed_at": "2025-08-26T18:12:59.336510Z"}, {"name": "execute", "started_at": "2025-08-26T18:12:59.337118Z", "completed_at": "2025-08-26T18:13:01.680102Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 2.4450159072875977, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea205-0001-673a-0001-67de0001406e"}, "message": null, "failures": 0, "unique_id": "test.sequra_analytics.unique_stg_orders_order_id.e3b841c71a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom SEQURA_DEV.dbt_maximerosa_staging.stg_orders\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T18:13:01.273171Z", "completed_at": "2025-08-26T18:13:01.279385Z"}, {"name": "execute", "started_at": "2025-08-26T18:13:01.279829Z", "completed_at": "2025-08-26T18:13:03.857698Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 2.6554880142211914, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea205-0001-6720-0001-67de000120a6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.sequra_analytics.int_orders_with_defaults", "compiled": true, "compiled_code": "\n\nwith orders_enriched as (\n    select\n        -- Order information\n        o.order_id,\n        o.order_date,\n        o.order_month,\n        o.month_year_order,\n        \n        -- Product and merchant\n        o.product_id,\n        o.product,\n        o.merchant_id,\n        m.merchant_name as merchant,\n        \n        -- Shopper information\n        o.shopper_id,\n        s.shopper_age,\n        \n        -- Financial metrics\n        o.is_in_default,\n        o.days_unbalanced,\n        o.current_order_value,\n        o.overdue_principal,\n        o.overdue_fees,\n        o.total_overdue,\n        \n        -- Calculated delayed period (for filtering, not cumulative)\n        case\n            when o.days_unbalanced > 90 then '90'\n            when o.days_unbalanced > 60 then '60'\n            when o.days_unbalanced > 30 then '30'\n            when o.days_unbalanced > 17 then '17'\n            else null\n        end as max_delayed_period\n        \n    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders_financial o\n    left join SEQURA_DEV.dbt_maximerosa_staging.stg_dim_shoppers s\n        on o.shopper_id = s.shopper_id\n    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m\n        on o.merchant_id = m.merchant_id\n)\n\nselect * from orders_enriched", "relation_name": "SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T18:13:01.778270Z", "completed_at": "2025-08-26T18:13:01.787642Z"}, {"name": "execute", "started_at": "2025-08-26T18:13:01.791404Z", "completed_at": "2025-08-26T18:13:04.367099Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 2.6792550086975098, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea205-0001-6741-0001-67de00015052"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.sequra_analytics.int_monthly_shoppers", "compiled": true, "compiled_code": "\n\nwith monthly_orders as (\n    select distinct\n        order_month,\n        month_year,\n        merchant_id,\n        shopper_id\n    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders\n)\n\nselect\n    order_month,\n    month_year,\n    merchant_id,\n    shopper_id\nfrom monthly_orders", "relation_name": "SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T18:13:01.779674Z", "completed_at": "2025-08-26T18:13:01.787055Z"}, {"name": "execute", "started_at": "2025-08-26T18:13:01.788122Z", "completed_at": "2025-08-26T18:13:04.368687Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 2.6811459064483643, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea205-0001-6720-0001-67de000120aa"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.sequra_analytics.int_recurrent_shoppers", "compiled": true, "compiled_code": "\n\nwith order_history as (\n    select\n        o1.order_month as current_month,\n        o1.month_year as current_month_year,\n        o1.merchant_id,\n        o1.shopper_id,\n        count(distinct o2.order_month) as months_with_purchases\n    from SEQURA_DEV.dbt_maximerosa_staging.stg_orders o1\n    left join SEQURA_DEV.dbt_maximerosa_staging.stg_orders o2\n        on o1.merchant_id = o2.merchant_id\n        and o1.shopper_id = o2.shopper_id\n        and o2.order_date between dateadd(month, -11, o1.order_month) and last_day(o1.order_month)\n        and o2.order_month <= o1.order_month\n    group by 1, 2, 3, 4\n)\n\nselect\n    current_month,\n    current_month_year,\n    merchant_id,\n    shopper_id,\n    months_with_purchases,\n    -- A shopper is recurrent if they have made purchases in at least 2 different months\n    -- within the 12-month window including the current month\n    case \n        when months_with_purchases >= 2 then 1 \n        else 0 \n    end as is_recurrent\nfrom order_history", "relation_name": "SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T18:13:03.931052Z", "completed_at": "2025-08-26T18:13:03.934516Z"}, {"name": "execute", "started_at": "2025-08-26T18:13:03.934841Z", "completed_at": "2025-08-26T18:13:07.433819Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 3.5913400650024414, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea205-0001-6741-0001-67de00015056"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.sequra_analytics.default_ratio_analysis", "compiled": true, "compiled_code": "\n\n-- Now we properly use the intermediate model!\nwith base_data as (\n    select * from SEQURA_DEV.dbt_maximerosa_intermediate.int_orders_with_defaults\n    where is_in_default = true  -- Only defaults for this analysis\n),\n\n-- Generate records for each applicable delayed period using UNION ALL\n-- This implements the cumulative logic: 35 days appears in both 17 and 30\nexpanded_periods as (\n    -- Period 17: All orders with days_unbalanced > 17\n    select\n        shopper_age,\n        month_year_order,\n        product,\n        merchant,\n        'in_default' as default_type,\n        '17' as delayed_period\n    from base_data\n    where days_unbalanced > 17\n    \n    union all\n    \n    -- Period 30: All orders with days_unbalanced > 30\n    select\n        shopper_age,\n        month_year_order,\n        product,\n        merchant,\n        'in_default' as default_type,\n        '30' as delayed_period\n    from base_data\n    where days_unbalanced > 30\n    \n    union all\n    \n    -- Period 60: All orders with days_unbalanced > 60\n    select\n        shopper_age,\n        month_year_order,\n        product,\n        merchant,\n        'in_default' as default_type,\n        '60' as delayed_period\n    from base_data\n    where days_unbalanced > 60\n    \n    union all\n    \n    -- Period 90: All orders with days_unbalanced > 90\n    select\n        shopper_age,\n        month_year_order,\n        product,\n        merchant,\n        'in_default' as default_type,\n        '90' as delayed_period\n    from base_data\n    where days_unbalanced > 90\n)\n\n-- Final output with exact columns requested\nselect distinct\n    shopper_age,\n    month_year_order,\n    product,\n    merchant,\n    default_type,\n    delayed_period\nfrom expanded_periods\nwhere merchant is not null  -- Exclude records without merchant mapping\norder by \n    month_year_order,\n    merchant,\n    cast(delayed_period as integer)", "relation_name": "SEQURA_DEV.dbt_maximerosa_marts.default_ratio_analysis", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-26T18:13:04.464162Z", "completed_at": "2025-08-26T18:13:04.470489Z"}, {"name": "execute", "started_at": "2025-08-26T18:13:04.471108Z", "completed_at": "2025-08-26T18:13:07.849303Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 3.4825961589813232, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea205-0001-673a-0001-67de00014072"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.sequra_analytics.shopper_recurrence_rate", "compiled": true, "compiled_code": "\n\nwith monthly_metrics as (\n    select\n        ms.order_month,\n        ms.month_year,\n        ms.merchant_id,\n        m.merchant_name,\n        count(distinct ms.shopper_id) as total_shoppers,\n        sum(rs.is_recurrent) as recurrent_shoppers\n    from SEQURA_DEV.dbt_maximerosa_intermediate.int_monthly_shoppers ms\n    left join SEQURA_DEV.dbt_maximerosa_intermediate.int_recurrent_shoppers rs\n        on ms.order_month = rs.current_month\n        and ms.merchant_id = rs.merchant_id\n        and ms.shopper_id = rs.shopper_id\n    left join SEQURA_DEV.dbt_maximerosa_staging.stg_merchants m\n        on ms.merchant_id = m.merchant_id\n    group by 1, 2, 3, 4\n)\n\nselect\n    merchant_name,\n    month_year as month,\n    round(\n        case \n            when total_shoppers > 0 \n            then (recurrent_shoppers::decimal / total_shoppers) * 100\n            else 0 \n        end, 2\n    ) as recurrence_rate\nfrom monthly_metrics\norder by merchant_name, month", "relation_name": "SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T18:13:07.954050Z", "completed_at": "2025-08-26T18:13:07.967961Z"}, {"name": "execute", "started_at": "2025-08-26T18:13:07.968350Z", "completed_at": "2025-08-26T18:13:10.368986Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 2.5235729217529297, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea205-0001-673a-0001-67de00014076"}, "message": null, "failures": 0, "unique_id": "test.sequra_analytics.not_null_shopper_recurrence_rate_merchant_name.d13dd26ce8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect merchant_name\nfrom SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate\nwhere merchant_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T18:13:07.963743Z", "completed_at": "2025-08-26T18:13:07.972891Z"}, {"name": "execute", "started_at": "2025-08-26T18:13:07.973401Z", "completed_at": "2025-08-26T18:13:10.510890Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 2.635258197784424, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea205-0001-6741-0001-67de0001505a"}, "message": null, "failures": 0, "unique_id": "test.sequra_analytics.not_null_shopper_recurrence_rate_recurrence_rate.2d83bf0eb1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recurrence_rate\nfrom SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate\nwhere recurrence_rate is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-08-26T18:13:07.958252Z", "completed_at": "2025-08-26T18:13:07.970469Z"}, {"name": "execute", "started_at": "2025-08-26T18:13:07.970804Z", "completed_at": "2025-08-26T18:13:10.545116Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 2.6648247241973877, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bea205-0001-6720-0001-67de000120ae"}, "message": null, "failures": 0, "unique_id": "test.sequra_analytics.not_null_shopper_recurrence_rate_month.e94d631817", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom SEQURA_DEV.dbt_maximerosa_marts.shopper_recurrence_rate\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 27.01306176185608, "args": {"exclude": [], "upload_to_artifacts_ingest_api": false, "state_modified_compare_more_unrendered_values": false, "use_colors_file": true, "write_json": true, "indirect_selection": "eager", "log_level_file": "debug", "select": [], "log_format_file": "debug", "populate_cache": true, "show_resource_report": false, "project_dir": "/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics", "resource_types": [], "favor_state": false, "use_fast_test_edges": false, "print": true, "export_saved_queries": false, "source_freshness_run_project_hooks": true, "which": "build", "introspect": true, "exclude_resource_types": [], "partial_parse": true, "static_parser": true, "use_colors": true, "profiles_dir": "/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics", "printer_width": 80, "empty": false, "cache_selected_only": false, "send_anonymous_usage_stats": true, "log_file_max_bytes": 10485760, "require_resource_names_without_spaces": true, "skip_nodes_if_on_run_start_fails": false, "log_format": "default", "quiet": false, "log_level": "info", "vars": {}, "defer": false, "strict_mode": false, "require_batched_execution_for_custom_microbatch_strategy": false, "version_check": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "state_modified_compare_vars": false, "require_nested_cumulative_type_params": false, "include_saved_query": false, "show_all_deprecations": false, "macro_debugging": false, "validate_macro_args": false, "invocation_command": "dbt build", "require_explicit_package_overrides_for_builtin_materializations": true, "require_yaml_configuration_for_mf_time_spines": false, "log_path": "/Users/maximerosa/Downloads/SeQura-Test-Analytics-Engineer/sequra_analytics/logs", "partial_parse_file_diff": true, "require_all_warnings_handled_by_warn_error": false, "require_generic_test_arguments_property": true, "show": false}}